{
    "url": "https://api.github.com/repos/spack/spack/issues/19369",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/19369/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/19369/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/19369/events",
    "html_url": "https://github.com/spack/spack/issues/19369",
    "id": 724771270,
    "node_id": "MDU6SXNzdWU3MjQ3NzEyNzA=",
    "number": 19369,
    "title": "Reduce test time",
    "user": {
        "login": "healther",
        "id": 4048699,
        "node_id": "MDQ6VXNlcjQwNDg2OTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4048699?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/healther",
        "html_url": "https://github.com/healther",
        "followers_url": "https://api.github.com/users/healther/followers",
        "following_url": "https://api.github.com/users/healther/following{/other_user}",
        "gists_url": "https://api.github.com/users/healther/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/healther/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/healther/subscriptions",
        "organizations_url": "https://api.github.com/users/healther/orgs",
        "repos_url": "https://api.github.com/users/healther/repos",
        "events_url": "https://api.github.com/users/healther/events{/privacy}",
        "received_events_url": "https://api.github.com/users/healther/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 1491155556,
            "node_id": "MDU6TGFiZWwxNDkxMTU1NTU2",
            "url": "https://api.github.com/repos/spack/spack/labels/ci",
            "name": "ci",
            "color": "9891e0",
            "default": false,
            "description": "Issues related to Continuous Integration"
        },
        {
            "id": 446615135,
            "node_id": "MDU6TGFiZWw0NDY2MTUxMzU=",
            "url": "https://api.github.com/repos/spack/spack/labels/configuration",
            "name": "configuration",
            "color": "bfd4f2",
            "default": false,
            "description": null
        },
        {
            "id": 527266935,
            "node_id": "MDU6TGFiZWw1MjcyNjY5MzU=",
            "url": "https://api.github.com/repos/spack/spack/labels/coverage",
            "name": "coverage",
            "color": "e99695",
            "default": false,
            "description": null
        },
        {
            "id": 456144565,
            "node_id": "MDU6TGFiZWw0NTYxNDQ1NjU=",
            "url": "https://api.github.com/repos/spack/spack/labels/defaults",
            "name": "defaults",
            "color": "bfd4f2",
            "default": false,
            "description": null
        },
        {
            "id": 1643340512,
            "node_id": "MDU6TGFiZWwxNjQzMzQwNTEy",
            "url": "https://api.github.com/repos/spack/spack/labels/expected%20behavior",
            "name": "expected behavior",
            "color": "8937b2",
            "default": false,
            "description": ""
        },
        {
            "id": 73908756,
            "node_id": "MDU6TGFiZWw3MzkwODc1Ng==",
            "url": "https://api.github.com/repos/spack/spack/labels/feature",
            "name": "feature",
            "color": "84b6eb",
            "default": false,
            "description": null
        },
        {
            "id": 1433532775,
            "node_id": "MDU6TGFiZWwxNDMzNTMyNzc1",
            "url": "https://api.github.com/repos/spack/spack/labels/triage",
            "name": "triage",
            "color": "ed9793",
            "default": false,
            "description": "The issue needs to be prioritized"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-10-19T16:16:19Z",
    "updated_at": "2020-10-20T13:44:44Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "While running the tests (to see if I broke anything for #19166) I noticed that they take quite a while...\r\n\r\n```\r\n======================================================================== slowest 20 test durations ========================================================================\r\n359.94s call     lib/spack/spack/test/cmd/license.py::test_list_files\r\n41.18s call     lib/spack/spack/test/cmd/url.py::test_url_list\r\n37.59s call     lib/spack/spack/test/cmd/clean.py::test_function_calls[-a-counters5]\r\n17.31s call     lib/spack/spack/test/directory_layout.py::test_yaml_directory_layout_parameters\r\n15.94s call     lib/spack/spack/test/bindist.py::test_default_rpaths_create_install_default_layout\r\n13.59s call     lib/spack/spack/test/cmd/env.py::test_stack_combinatorial_view[mock_archive0]\r\n13.29s call     lib/spack/spack/test/package_sanity.py::test_get_all_packages\r\n12.66s call     lib/spack/spack/test/cmd/list.py::test_list_format_html\r\n11.95s call     lib/spack/spack/test/bindist.py::test_default_rpaths_install_nondefault_layout\r\n11.28s call     lib/spack/spack/test/cmd/env.py::test_stack_view_multiple_views[mock_archive0]\r\n10.87s call     lib/spack/spack/test/cmd/env.py::test_stack_view_select_and_exclude[mock_archive0]\r\n10.78s call     lib/spack/spack/test/cmd/env.py::test_stack_view_activate_from_default[mock_archive0]\r\n10.43s call     lib/spack/spack/test/bindist.py::test_relative_rpaths_create_default_layout\r\n10.31s call     lib/spack/spack/test/cmd/env.py::test_view_link_roots[mock_archive0]\r\n10.12s call     lib/spack/spack/test/cmd/env.py::test_stack_view_exclude[mock_archive0]\r\n9.79s call     lib/spack/spack/test/cmd/env.py::test_stack_view_select[mock_archive0]\r\n9.68s call     lib/spack/spack/test/cmd/env.py::test_stack_view_no_activate_without_default[mock_archive0]\r\n9.07s call     lib/spack/spack/test/cmd/env.py::test_view_link_all[mock_archive0]\r\n9.02s call     lib/spack/spack/test/cmd/url.py::test_url_stats\r\n9.02s call     lib/spack/spack/test/cmd/url.py::test_url_summary\r\n```\r\nTo be fair this is on a somewhat old MacBook Air, but still... 6 minutes for checking the licenses is, let's call it ambitious^^. Has anyone taken a look at speeding things up?\r\n\r\nAnd I'm pretty sure the fail of\r\n```\r\nFAIL lib/spack/spack/test/bindist.py::test_push_and_fetch_keys\r\n```\r\nshould have been an XFAIL or SKIP right? (It skipped a bunch of other pgp-dependent stuff)\r\n\r\nThis is largely a copy from a comment in #19166, but @alalazo correctly pointed out it deserves its own issue. I don't think it is super urgent as upstream tests (aka Github checks) are fine as a replacement for me as a causal contributor, i.e. I can just _not_ run the tests at all and let github do it's stuff. But I wouldn't want to run these multiple times a day... We can probably disable a significant amount of tests by default (e.g. the license test really only needs to run on Github, no contributor will break `spack` with it), but some kind of \"only test what you changed wrt to `develop`\" intelligence would be ideal.\r\n\r\nIf you are here and want to work on this: From what I've seen most time got sunk into the regex application, so this should be the place to start.\r\n\r\nPinging various people who might know how to speed this up, feel free to ignore if you deem it low priority: @scheibelp @adamjstewart @becker33 ",
    "performed_via_github_app": null
}