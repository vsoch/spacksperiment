{
    "url": "https://api.github.com/repos/spack/spack/issues/15987",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/15987/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/15987/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/15987/events",
    "html_url": "https://github.com/spack/spack/issues/15987",
    "id": 597670689,
    "node_id": "MDU6SXNzdWU1OTc2NzA2ODk=",
    "number": 15987,
    "title": "Installation issue: UCX Compile Failed",
    "user": {
        "login": "darmac",
        "id": 29532367,
        "node_id": "MDQ6VXNlcjI5NTMyMzY3",
        "avatar_url": "https://avatars.githubusercontent.com/u/29532367?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/darmac",
        "html_url": "https://github.com/darmac",
        "followers_url": "https://api.github.com/users/darmac/followers",
        "following_url": "https://api.github.com/users/darmac/following{/other_user}",
        "gists_url": "https://api.github.com/users/darmac/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/darmac/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/darmac/subscriptions",
        "organizations_url": "https://api.github.com/users/darmac/orgs",
        "repos_url": "https://api.github.com/users/darmac/repos",
        "events_url": "https://api.github.com/users/darmac/events{/privacy}",
        "received_events_url": "https://api.github.com/users/darmac/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2020-04-10T03:16:37Z",
    "updated_at": "2020-04-25T17:39:34Z",
    "closed_at": "2020-04-25T17:39:34Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "There is a build error when I install ucx(almost all-versions)\r\nAnd it's installed sucessfully with a earlier spack `commid-id`, such as:\r\n```\r\ncommit e519bbadc3c55f6fafacadc4ae950fb02565fe27 (HEAD)\r\nAuthor: Howard Pritchard <howardp@lanl.gov>\r\nDate:   Fri Feb 28 10:22:37 2020 -0700\r\n\r\n    UCX: add 1.7.0 (#15266)\r\n\r\n    Signed-off-by: Howard Pritchard <howardp@lanl.gov>\r\n```\r\n\r\nspack `commid-id` now:\r\n```\r\ncommit 0d96e8a27d13166049bb9280e2e270a568fe9759 (HEAD -> develop, origin/develop, origin/HEAD)\r\nAuthor: tilne <55806862+tilne@users.noreply.github.com>\r\nDate:   Thu Apr 9 20:00:03 2020 -0700\r\n\r\n    update URL and sha256 for aws-parallelcluster 2.6.1 (#15980)\r\n\r\n    Signed-off-by: Tim Lane <tilne@amazon.com>\r\n```\r\n\r\nError log:\r\n```\r\n==> 22781: Installing ucx\r\n==> Finding buildcaches in /home/spack_mirror/build_cache\r\n==> Fetching file:///home/spack_mirror/build_cache/linux-centos8-aarch64-gcc-8.2.1-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs.spec.yaml\r\ncurl: (37) Couldn't open file /home/spack_mirror/build_cache/linux-centos8-aarch64-gcc-8.2.1-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs.spec.yaml\r\n==> Failed to fetch file from URL: file:///home/spack_mirror/build_cache/linux-centos8-aarch64-gcc-8.2.1-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs.spec.yaml\r\n    Curl failed with error 37\r\n==> Fetching from file:///home/spack_mirror/build_cache/linux-centos8-aarch64-gcc-8.2.1-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs.spec.yaml failed.\r\n==> Using cached archive: /home/xiaojun/spack/var/spack/cache/_source-cache/archive/6a/6ab81ee187bfd554fe7e549da93a11bfac420df87d99ee61ffab7bb19bdd3371.tar.gz\r\n==> Staging archive: /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/ucx-1.7.0.tar.gz\r\n==> Created stage in /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs\r\n==> No patches needed for ucx\r\n==> 22781: ucx: Building ucx [AutotoolsPackage]\r\n==> 22781: ucx: Executing phase: 'autoreconf'\r\n==> 22781: ucx: Executing phase: 'configure'\r\n==> 22781: ucx: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j4'\r\n\r\n2 errors found in build log:\r\n     587    /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm/util/reloc.h:66:(.text+0x1e00): dangerous relocation: unsupported relocation\r\n     588    /usr/local/bin/ld: malloc/.libs/libucm_la-malloc_hook.o: relocation R_AARCH64_ADR_PREL_PG_HI21 against symbol `ucm_global_opts' which may bind externally can not be used when making a shared\r\n            object; recompile with -fPIC\r\n     589    malloc/.libs/libucm_la-malloc_hook.o: in function `ucm_mmap_hook_mode':\r\n     590    /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm/mmap/mmap.h:45:(.text+0x1e7c): dangerous relocation: unsupported relocation\r\n     591    /usr/local/bin/ld: malloc/.libs/libucm_la-malloc_hook.o: relocation R_AARCH64_ADR_PREL_PG_HI21 against symbol `__free_hook@@GLIBC_2.17' which may bind externally can not be used when making a\r\n             shared object; recompile with -fPIC\r\n     592    /usr/local/bin/ld: malloc/.libs/libucm_la-malloc_hook.o(.text+0x1ed8): unresolvable R_AARCH64_ADR_PREL_PG_HI21 relocation against symbol `__free_hook@@GLIBC_2.17'\r\n  >> 593    /usr/local/bin/ld: final link failed: bad value\r\n  >> 594    collect2: error: ld returned 1 exit status\r\n     595    make[3]: *** [Makefile:696: libucm.la] Error 1\r\n     596    make[3]: Leaving directory '/tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm'\r\n     597    make[2]: *** [Makefile:886: all-recursive] Error 1\r\n     598    make[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm'\r\n     599    make[1]: *** [Makefile:719: all-recursive] Error 1\r\n     600    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src'\r\n\r\nSee build log for details:\r\n  /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-build-out.txt\r\n\r\n==> Error: Failed to install ucx due to ChildError: ProcessError: Command exited with status 2:\r\n    'make' '-j4'\r\n2 errors found in build log:\r\n     587    /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm/util/reloc.h:66:(.text+0x1e00): dangerous relocation: unsupported relocation\r\n     588    /usr/local/bin/ld: malloc/.libs/libucm_la-malloc_hook.o: relocation R_AARCH64_ADR_PREL_PG_HI21 against symbol `ucm_global_opts' which may bind externally can not be used when making a shared\r\n            object; recompile with -fPIC\r\n     589    malloc/.libs/libucm_la-malloc_hook.o: in function `ucm_mmap_hook_mode':\r\n     590    /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm/mmap/mmap.h:45:(.text+0x1e7c): dangerous relocation: unsupported relocation\r\n     591    /usr/local/bin/ld: malloc/.libs/libucm_la-malloc_hook.o: relocation R_AARCH64_ADR_PREL_PG_HI21 against symbol `__free_hook@@GLIBC_2.17' which may bind externally can not be used when making a\r\n             shared object; recompile with -fPIC\r\n     592    /usr/local/bin/ld: malloc/.libs/libucm_la-malloc_hook.o(.text+0x1ed8): unresolvable R_AARCH64_ADR_PREL_PG_HI21 relocation against symbol `__free_hook@@GLIBC_2.17'\r\n  >> 593    /usr/local/bin/ld: final link failed: bad value\r\n  >> 594    collect2: error: ld returned 1 exit status\r\n     595    make[3]: *** [Makefile:696: libucm.la] Error 1\r\n     596    make[3]: Leaving directory '/tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm'\r\n     597    make[2]: *** [Makefile:886: all-recursive] Error 1\r\n     598    make[2]: Leaving directory '/tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src/src/ucm'\r\n     599    make[1]: *** [Makefile:719: all-recursive] Error 1\r\n     600    make[1]: Leaving directory '/tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-src'\r\n\r\nSee build log for details:\r\n  /tmp/root/spack-stage/spack-stage-ucx-1.7.0-fau66yhl4uxmq2575ltffgom7dqxd5gs/spack-build-out.txt\r\nTraceback (most recent call last):\r\n  File \"/home/xiaojun/spack/lib/spack/spack/build_environment.py\", line 801, in child_process\r\n    return_value = function()\r\n  File \"/home/xiaojun/spack/lib/spack/spack/installer.py\", line 1113, in build_process\r\n    phase(pkg.spec, pkg.prefix)\r\n  File \"/home/xiaojun/spack/lib/spack/spack/package.py\", line 108, in phase_wrapper\r\n    phase(spec, prefix)\r\n  File \"/home/xiaojun/spack/lib/spack/spack/build_systems/autotools.py\", line 290, in build\r\n    inspect.getmodule(self).make(*self.build_targets)\r\n  File \"/home/xiaojun/spack/lib/spack/spack/build_environment.py\", line 131, in __call__\r\n    return super(MakeExecutable, self).__call__(*args, **kwargs)\r\n  File \"/home/xiaojun/spack/lib/spack/spack/util/executable.py\", line 189, in __call__\r\n    proc.returncode, long_msg)\r\nspack.util.executable.ProcessError: Command exited with status 2:\r\n    'make' '-j4'\r\n```",
    "performed_via_github_app": null
}