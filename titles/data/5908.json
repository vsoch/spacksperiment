{
    "url": "https://api.github.com/repos/spack/spack/issues/5908",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/5908/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/5908/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/5908/events",
    "html_url": "https://github.com/spack/spack/issues/5908",
    "id": 268116851,
    "node_id": "MDU6SXNzdWUyNjgxMTY4NTE=",
    "number": 5908,
    "title": "The 'backports.functools_lru_cache' distribution was not found and is required by pylint",
    "user": {
        "login": "grondo",
        "id": 741970,
        "node_id": "MDQ6VXNlcjc0MTk3MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/741970?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/grondo",
        "html_url": "https://github.com/grondo",
        "followers_url": "https://api.github.com/users/grondo/followers",
        "following_url": "https://api.github.com/users/grondo/following{/other_user}",
        "gists_url": "https://api.github.com/users/grondo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/grondo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/grondo/subscriptions",
        "organizations_url": "https://api.github.com/users/grondo/orgs",
        "repos_url": "https://api.github.com/users/grondo/repos",
        "events_url": "https://api.github.com/users/grondo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/grondo/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2017-10-24T17:18:57Z",
    "updated_at": "2021-03-10T15:36:20Z",
    "closed_at": "2021-03-10T15:36:20Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I'm trying to get `make check` working with `spack install --test=all` for the flux package in spack and have run into multiple problems with `pylint`. I do not know much about pylint, but it appears the py-pylint package may have some missing dependency in spack, as it is failing with a missing distribution of `backports.functools_lru_cache` when run under `make check` in the flux build.\r\n\r\nI can reproduce also by installing `py-pylint` in a fresh spack repo:\r\n\r\n```\r\ngrondo@peep:/tmp/spack$ export PATH=$PATH:$(pwd)/bin\r\ngrondo@peep:/tmp/spack$ spack bootstrap\r\n==> Installing environment-modules@3.2.10%gcc@6.2.0~X arch=linux-ubuntu16.10-x86_64 ^tcl@8.6.6%gcc@6.2.0 arch=linux-ubuntu16.10-x86_64 ^zlib@1.2.11%gcc@6.2.0+pic+shared arch=linux-ubuntu16.10-x86_64 to satisfy requirement for environment-modules\r\n[snip]\r\n\r\ngrondo@peep:/tmp/spack$ . $(spack location --install-dir environment-modules)/Modules/init/bash\r\ngrondo@peep:/tmp/spack$ . share/spack/setup-env.sh\r\ngrondo@peep:/tmp/spack$ spack install py-pylint\r\n==> Installing bzip2\r\n[snip]\r\n\r\n\r\ngrondo@peep:/tmp/spack$ spack load py-pylint\r\ngrondo@peep:/tmp/spack$ pylint\r\nTraceback (most recent call last):\r\n  File \"/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-pylint-1.7.2-fnffkswnxk4mzwn5jhkrqj6ldgclonwm/bin/pylint\", line 7, in <module>\r\n    from pkg_resources import load_entry_point\r\n  File \"/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-setuptools-35.0.2-od3pp6dt6wbeisrdxbfoi3k6ulsov2sq/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 3036, in <module>\r\n    @_call_aside\r\n  File \"/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-setuptools-35.0.2-od3pp6dt6wbeisrdxbfoi3k6ulsov2sq/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 3020, in _call_aside\r\n    f(*args, **kwargs)\r\n  File \"/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-setuptools-35.0.2-od3pp6dt6wbeisrdxbfoi3k6ulsov2sq/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 3049, in _initialize_master_working_set\r\n    working_set = WorkingSet._build_master()\r\n  File \"/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-setuptools-35.0.2-od3pp6dt6wbeisrdxbfoi3k6ulsov2sq/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 654, in _build_master\r\n    ws.require(__requires__)\r\n  File \"/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-setuptools-35.0.2-od3pp6dt6wbeisrdxbfoi3k6ulsov2sq/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 968, in require\r\n    needed = self.resolve(parse_requirements(requirements))\r\n  File \"/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-setuptools-35.0.2-od3pp6dt6wbeisrdxbfoi3k6ulsov2sq/lib/python2.7/site-packages/pkg_resources/__init__.py\", line 854, in resolve\r\n    raise DistributionNotFound(req, requirers)\r\npkg_resources.DistributionNotFound: The 'backports.functools_lru_cache' distribution was not found and is required by pylint\r\ngrondo@peep:/tmp/spack$ which pylint\r\n/home/grondo/git/s.git/opt/spack/linux-ubuntu16.10-x86_64/gcc-6.2.0/py-pylint-1.7.2-fnffkswnxk4mzwn5jhkrqj6ldgclonwm/bin/pylint\r\n```\r\n\r\nI get this same or similar error during a build of the flux package when I  add `py-pylint` as a build requirement and run with `--tests=all` to get our `make check` to run. I'm somewhat new to spack so I apologize if I've made some basic mistake.\r\n\r\nBTW, is there a way to set dependencies that are only needed during `make check`?",
    "performed_via_github_app": null
}