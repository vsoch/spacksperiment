{
    "url": "https://api.github.com/repos/spack/spack/issues/20672",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/20672/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/20672/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/20672/events",
    "html_url": "https://github.com/spack/spack/issues/20672",
    "id": 778556583,
    "node_id": "MDU6SXNzdWU3Nzg1NTY1ODM=",
    "number": 20672,
    "title": "Build of hpctoolkit fails on Fedora 33",
    "user": {
        "login": "dnystrom1",
        "id": 17130217,
        "node_id": "MDQ6VXNlcjE3MTMwMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/17130217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/dnystrom1",
        "html_url": "https://github.com/dnystrom1",
        "followers_url": "https://api.github.com/users/dnystrom1/followers",
        "following_url": "https://api.github.com/users/dnystrom1/following{/other_user}",
        "gists_url": "https://api.github.com/users/dnystrom1/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/dnystrom1/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/dnystrom1/subscriptions",
        "organizations_url": "https://api.github.com/users/dnystrom1/orgs",
        "repos_url": "https://api.github.com/users/dnystrom1/repos",
        "events_url": "https://api.github.com/users/dnystrom1/events{/privacy}",
        "received_events_url": "https://api.github.com/users/dnystrom1/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 1433532775,
            "node_id": "MDU6TGFiZWwxNDMzNTMyNzc1",
            "url": "https://api.github.com/repos/spack/spack/labels/triage",
            "name": "triage",
            "color": "ed9793",
            "default": false,
            "description": "The issue needs to be prioritized"
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2021-01-05T03:54:28Z",
    "updated_at": "2021-01-06T01:20:04Z",
    "closed_at": "2021-01-06T01:20:04Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "Trying a build of hpctoolkit from fresh clone of spack fails on Fedora 33.  No special customizations done.\r\n\r\n### Steps to reproduce the issue\r\n\r\n#!/bin/bash\r\ngit clone https://github.com/spack/spack.git\r\nsource spack/share/spack/setup-env.sh\r\nspack install -j 4 hpctoolkit +mpi ^openmpi\r\n\r\n### Error Message\r\n\r\n==> Installing hpctoolkit-2020.08.03-dfrulxfvokpyet3afosqm3su3rpqkcty\r\n==> No binary for hpctoolkit-2020.08.03-dfrulxfvokpyet3afosqm3su3rpqkcty found: installing from source\r\n==> hpctoolkit: Executing phase: 'autoreconf'\r\n==> hpctoolkit: Executing phase: 'configure'\r\n==> hpctoolkit: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j4'\r\n\r\n1 error found in build log:\r\n     2396    make[5]: *** Waiting for unfinished jobs....\r\n     2397    \r\n     2398    *** Warning: Linking the shared library libhpcrun.la against the\r\n     2399    *** static library /home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/mbedtls-2.16.9-m4yi2faqh7kj3er6synhxtzo25evhjfg/lib/libmbedcrypto.a is not portabl\r\n             e!\r\n     2400    libtool: link: /home/wdn/Packages/spack/spack/lib/spack/env/gcc/gcc -shared  -fPIC -DPIC  utilities/.libs/libhpcrun_la-first_func.o .libs/libhpcrun_la-main.o .libs/libhpcrun_la\r\n             -disabled.o .libs/libhpcrun_la-closure-registry.o .libs/libhpcrun_la-cct_insert_backtrace.o .libs/libhpcrun_la-cct_backtrace_finalize.o .libs/libhpcrun_la-env.o .libs/libhpcrun\r\n             _la-epoch.o .libs/libhpcrun_la-files.o .libs/libhpcrun_la-handling_sample.o .libs/libhpcrun_la-hpcrun-initializers.o .libs/libhpcrun_la-hpcrun_options.o .libs/libhpcrun_la-hpcr\r\n             un_stats.o .libs/libhpcrun_la-loadmap.o .libs/libhpcrun_la-metrics.o .libs/libhpcrun_la-name.o .libs/libhpcrun_la-rank.o .libs/libhpcrun_la-sample_event.o .libs/libhpcrun_la-sa\r\n             mple_prob.o .libs/libhpcrun_la-sample_sources_all.o sample-sources/blame-shift/.libs/libhpcrun_la-blame-shift.o sample-sources/blame-shift/.libs/libhpcrun_la-blame-map.o sample\r\n             -sources/blame-shift/.libs/libhpcrun_la-directed.o sample-sources/blame-shift/.libs/libhpcrun_la-undirected.o sample-sources/.libs/libhpcrun_la-omp-mutex.o sample-sources/.libs\r\n             /libhpcrun_la-omp-idle.o sample-sources/.libs/libhpcrun_la-common.o sample-sources/.libs/libhpcrun_la-display.o sample-sources/.libs/libhpcrun_la-ga.o sample-sources/.libs/libh\r\n             pcrun_la-io.o sample-sources/.libs/libhpcrun_la-itimer.o sample-sources/.libs/libhpcrun_la-idle.o sample-sources/.libs/libhpcrun_la-memleak.o sample-sources/.libs/libhpcrun_la-\r\n             pthread-blame.o sample-sources/.libs/libhpcrun_la-none.o sample-sources/.libs/libhpcrun_la-retcnt.o sample-sources/.libs/libhpcrun_la-sync.o .libs/libhpcrun_la-sample_sources_r\r\n             egistered.o sample-sources/.libs/libhpcrun_la-sample-filters.o .libs/libhpcrun_la-segv_handler.o .libs/libhpcrun_la-start-stop.o .libs/libhpcrun_la-term_handler.o .libs/libhpcr\r\n             un_la-thread_data.o .libs/libhpcrun_la-thread_use.o .libs/libhpcrun_la-thread_finalize.o .libs/libhpcrun_la-control-knob.o .libs/libhpcrun_la-device-finalizers.o .libs/libhpcru\r\n             n_la-device-initializers.o .libs/libhpcrun_la-module-ignore-map.o .libs/libhpcrun_la-threadmgr.o .libs/libhpcrun_la-trace.o .libs/libhpcrun_la-weak.o .libs/libhpcrun_la-write_d\r\n             ata.o cct/.libs/libhpcrun_la-cct_bundle.o cct/.libs/libhpcrun_la-cct_ctxt.o cct/.libs/libhpcrun_la-cct.o cct/.libs/libhpcrun_la-cct-node-vector.o .libs/libhpcrun_la-cct2metrics\r\n             .o lush/.libs/libhpcrun_la-lush-backtrace.o lush/.libs/libhpcrun_la-lush.o lush/.libs/libhpcrun_la-lush-pthread.o lush/.libs/libhpcrun_la-lush-support-rt.o lush/.libs/libhpcrun\r\n             _la-lushi-cb.o fnbounds/.libs/libhpcrun_la-fnbounds_common.o memory/.libs/libhpcrun_la-mem.o memory/.libs/libhpcrun_la-mmap.o messages/.libs/libhpcrun_la-debug-flag.o messages/\r\n             .libs/libhpcrun_la-messages-sync.o messages/.libs/libhpcrun_la-messages-async.o messages/.libs/libhpcrun_la-fmt.o .libs/libhpcrun_la-hpcrun-placeholders.o gpu/.libs/libhpcrun_l\r\n             a-gpu-activity.o gpu/.libs/libhpcrun_la-gpu-activity-channel.o gpu/.libs/libhpcrun_la-gpu-activity-process.o gpu/.libs/libhpcrun_la-gpu-application-thread-api.o gpu/.libs/libhp\r\n             crun_la-gpu-channel-item-allocator.o gpu/.libs/libhpcrun_la-gpu-context-id-map.o gpu/.libs/libhpcrun_la-gpu-correlation.o gpu/.libs/libhpcrun_la-gpu-correlation-channel.o gpu/.\r\n             libs/libhpcrun_la-gpu-correlation-channel-set.o gpu/.libs/libhpcrun_la-gpu-correlation-id.o gpu/.libs/libhpcrun_la-gpu-correlation-id-map.o gpu/.libs/libhpcrun_la-gpu-event-id-\r\n             map.o gpu/.libs/libhpcrun_la-gpu-function-id-map.o gpu/.libs/libhpcrun_la-gpu-host-correlation-map.o gpu/.libs/libhpcrun_la-gpu-metrics.o gpu/.libs/libhpcrun_la-gpu-monitoring.\r\n             o gpu/.libs/libhpcrun_la-gpu-monitoring-thread-api.o gpu/.libs/libhpcrun_la-gpu-op-placeholders.o gpu/.libs/libhpcrun_la-gpu-splay-allocator.o gpu/.libs/libhpcrun_la-gpu-stream\r\n             -id-map.o gpu/.libs/libhpcrun_la-gpu-trace.o gpu/.libs/libhpcrun_la-gpu-trace-channel.o gpu/.libs/libhpcrun_la-gpu-trace-item.o ompt/.libs/libhpcrun_la-ompt-callstack.o ompt/.l\r\n             ibs/libhpcrun_la-ompt-defer.o ompt/.libs/libhpcrun_la-ompt-device.o ompt/.libs/libhpcrun_la-ompt-defer-write.o ompt/.libs/libhpcrun_la-ompt-interface.o ompt/.libs/libhpcrun_la-\r\n             ompt-queues.o ompt/.libs/libhpcrun_la-ompt-region.o ompt/.libs/libhpcrun_la-ompt-region-debug.o ompt/.libs/libhpcrun_la-ompt-placeholders.o ompt/.libs/libhpcrun_la-ompt-device-\r\n             map.o ompt/.libs/libhpcrun_la-ompt-task.o ompt/.libs/libhpcrun_la-ompt-thread.o syscalls/.libs/libhpcrun_la-poll.o syscalls/.libs/libhpcrun_la-ppoll.o syscalls/.libs/libhpcrun_\r\n             la-select.o utilities/.libs/libhpcrun_la-executable-path.o utilities/.libs/libhpcrun_la-hpcrun-nanotime.o utilities/.libs/libhpcrun_la-ip-normalized.o utilities/.libs/libhpcrun\r\n             _la-line_wrapping.o utilities/.libs/libhpcrun_la-timer.o utilities/.libs/libhpcrun_la-tokenize.o utilities/.libs/libhpcrun_la-unlink.o trampoline/common/.libs/libhpcrun_la-tram\r\n             poline_lazy.o sample-sources/perf/.libs/libhpcrun_la-event_custom.o sample-sources/perf/.libs/libhpcrun_la-linux_perf.o sample-sources/perf/.libs/libhpcrun_la-perf_event_open.o\r\n              sample-sources/perf/.libs/libhpcrun_la-perf-util.o sample-sources/perf/.libs/libhpcrun_la-perf_mmap.o sample-sources/perf/.libs/libhpcrun_la-perf_skid.o sample-sources/perf/.l\r\n             ibs/libhpcrun_la-perfmon-util.o sample-sources/perf/.libs/libhpcrun_la-kernel_blocking.o fnbounds/.libs/libhpcrun_la-fnbounds_client.o fnbounds/.libs/libhpcrun_la-fnbounds_dyna\r\n             mic.o monitor-exts/.libs/libhpcrun_la-openmp.o .libs/libhpcrun_la-hpcrun_dlfns.o .libs/libhpcrun_la-custom-init-dynamic.o os/linux/.libs/libhpcrun_la-dylib.o trampoline/x86-fam\r\n             ily/.libs/libhpcrun_la-x86-tramp.o utilities/arch/x86-family/.libs/libhpcrun_la-x86-context-pc.o sample-sources/.libs/libhpcrun_la-papi-c.o sample-sources/.libs/libhpcrun_la-pa\r\n             pi-c-extended-info.o unwind/common/.libs/libhpcrun_la-backtrace.o unwind/common/.libs/libhpcrun_la-unw-throw.o unwind/common/.libs/libhpcrun_la-binarytree_uwi.o unwind/common/.\r\n             libs/libhpcrun_la-interval_t.o unwind/common/.libs/libhpcrun_la-libunw_intervals.o unwind/common/.libs/libhpcrun_la-stack_troll.o unwind/common/.libs/libhpcrun_la-uw_hash.o unw\r\n             ind/common/.libs/libhpcrun_la-uw_recipe_map.o unwind/x86-family/.libs/libhpcrun_la-x86-all.o unwind/x86-family/.libs/libhpcrun_la-amd-xop.o unwind/x86-family/.libs/libhpcrun_la\r\n             -x86-cold-path.o unwind/x86-family/.libs/libhpcrun_la-x86-validate-retn-addr.o unwind/x86-family/.libs/libhpcrun_la-x86-unwind-interval.o unwind/x86-family/.libs/libhpcrun_la-x\r\n             86-unwind-interval-fixup.o unwind/x86-family/.libs/libhpcrun_la-x86-unwind.o unwind/x86-family/.libs/libhpcrun_la-x86-unwind-support.o unwind/x86-family/manual-intervals/.libs/\r\n             libhpcrun_la-x86-gcc-adjust.o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-gcc-main64.o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-linux-dlresolver.\r\n             o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-intel11-f90main.o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-intel-align32.o unwind/x86-family/manual\r\n             -intervals/.libs/libhpcrun_la-x86-intel-align64.o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-intel-composer2013-mic.o unwind/x86-family/manual-intervals/.libs/li\r\n             bhpcrun_la-x86-32bit-main.o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-32bit-icc-variant.o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-fail-interva\r\n             ls.o unwind/x86-family/manual-intervals/.libs/libhpcrun_la-x86-pgi-mp_pexit.o utilities/.libs/libhpcrun_la-last_func.o  -Wl,--whole-archive ../../../src/lib/prof-lean/.libs/lib\r\n             HPCprof-lean.a ../../../src/lib/support-lean/.libs/libHPCsupport-lean.a -Wl,--no-whole-archive  -L/home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/lib\r\n             monitor-2020.10.15-jnmmwudcdapwrhrkdcdz2ggk6txe4b7d/lib -lmonitor -lpthread -lrt -lelf -L/home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/elfutils-0.1\r\n             82-lfnivshxzstkmwfqrd54mmhwa5p5fmer/lib -L/home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/libunwind-1.5.0-som5mkz3qiil66uqvxuhze36ldefbx4s/lib -lunwi\r\n             nd -L/home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/xz-5.2.5-t67ym52gmkgsjx3izsux633b2u3ke2qs/lib -llzma -L/home/wdn/Packages/spack/spack/opt/spack/\r\n             linux-fedora33-haswell/gcc-10.2.1/papi-6.0.0.1-6lwlusuf7g22czl63sthpj5ogsu7v35p/lib -lpfm /home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/mbedtls-2.1\r\n             6.9-m4yi2faqh7kj3er6synhxtzo25evhjfg/lib/libmbedcrypto.a -L/home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/intel-xed-2019.03.01-4q665jwdggy3e544cgncw\r\n             nevqiyytdxm/lib -lpapi -L/home/wdn/Packages/spack/spack/opt/spack/linux-fedora33-haswell/gcc-10.2.1/gotcha-1.0.3-rv644sw5ptqdyhy4nywnhpsbxenjbejg/lib64 -lgotcha -lxed  -g -O3 -\r\n             Wl,-Bsymbolic   -Wl,-soname -Wl,libhpcrun.so.0 -o .libs/libhpcrun.so.0.0.0\r\n     2401    /usr/bin/ld: gpu/.libs/libhpcrun_la-gpu-metrics.o:/tmp/wdn/spack-stage/spack-stage-hpctoolkit-2020.08.03-dfrulxfvokpyet3afosqm3su3rpqkcty/spack-src/src/tool/hpcrun/gpu/gpu-metr\r\n             ics.h:66: multiple definition of `gpu_inst_stall_all_t'; gpu/.libs/libhpcrun_la-gpu-application-thread-api.o:/tmp/wdn/spack-stage/spack-stage-hpctoolkit-2020.08.03-dfrulxfvokpy\r\n             et3afosqm3su3rpqkcty/spack-src/src/tool/hpcrun/gpu/gpu-metrics.h:66: first defined here\r\n  >> 2402    collect2: error: ld returned 1 exit status\r\n     2403    make[5]: *** [Makefile:2771: libhpcrun.la] Error 1\r\n     2404    make[5]: Leaving directory '/tmp/wdn/spack-stage/spack-stage-hpctoolkit-2020.08.03-dfrulxfvokpyet3afosqm3su3rpqkcty/spack-src/src/tool/hpcrun'\r\n     2405    make[4]: *** [Makefile:7984: all-recursive] Error 1\r\n     2406    make[4]: Leaving directory '/tmp/wdn/spack-stage/spack-stage-hpctoolkit-2020.08.03-dfrulxfvokpyet3afosqm3su3rpqkcty/spack-src/src/tool/hpcrun'\r\n     2407    make[3]: *** [Makefile:2043: all] Error 2\r\n     2408    make[3]: Leaving directory '/tmp/wdn/spack-stage/spack-stage-hpctoolkit-2020.08.03-dfrulxfvokpyet3afosqm3su3rpqkcty/spack-src/src/tool/hpcrun'\r\n\r\n### Information on your system\r\n\r\n% spack debug report\r\n* **Spack:** 0.16.0-444-22a45e010\r\n* **Python:** 3.9.1\r\n* **Platform:** linux-fedora33-haswell\r\n* **Concretizer:** original\r\n\r\nNo customizations being used.\r\n\r\n### Additional information\r\n\r\n- [ x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [ ] I have searched the issues of this repo and believe this is not a duplicate\r\n- [ ] I have run the failing commands in debug mode and reported the output\r\n\r\n<!-- We encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively!\r\n\r\nIf you want to ask a question about the tool (how to use it, what it can currently do, etc.), try the `#general` channel on our Slack first. We have a welcoming community and chances are you'll get your reply faster and without opening an issue.\r\n\r\nOther than that, thanks for taking the time to contribute to Spack! -->\r\n",
    "performed_via_github_app": null
}