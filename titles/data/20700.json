{
    "url": "https://api.github.com/repos/spack/spack/issues/20700",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/20700/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/20700/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/20700/events",
    "html_url": "https://github.com/spack/spack/issues/20700",
    "id": 780688979,
    "node_id": "MDU6SXNzdWU3ODA2ODg5Nzk=",
    "number": 20700,
    "title": "An install_tree used successfully for a while is no longer usable. Can't figure out why",
    "user": {
        "login": "EthanS94",
        "id": 33101855,
        "node_id": "MDQ6VXNlcjMzMTAxODU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/33101855?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/EthanS94",
        "html_url": "https://github.com/EthanS94",
        "followers_url": "https://api.github.com/users/EthanS94/followers",
        "following_url": "https://api.github.com/users/EthanS94/following{/other_user}",
        "gists_url": "https://api.github.com/users/EthanS94/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/EthanS94/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/EthanS94/subscriptions",
        "organizations_url": "https://api.github.com/users/EthanS94/orgs",
        "repos_url": "https://api.github.com/users/EthanS94/repos",
        "events_url": "https://api.github.com/users/EthanS94/events{/privacy}",
        "received_events_url": "https://api.github.com/users/EthanS94/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 1433532775,
            "node_id": "MDU6TGFiZWwxNDMzNTMyNzc1",
            "url": "https://api.github.com/repos/spack/spack/labels/triage",
            "name": "triage",
            "color": "ed9793",
            "default": false,
            "description": "The issue needs to be prioritized"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2021-01-06T16:39:10Z",
    "updated_at": "2021-01-07T18:30:22Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "<!-- Explain, in a clear and concise way, the command you ran and the result you were trying to achieve.\r\nExample: \"I ran `spack find` to list all the installed packages and ...\" -->\r\n\r\nI am setting an install location with config.yaml:\r\n```yaml\r\nconfig:\r\n  install_tree:\r\n    root: /lustre/scratch4/yellow/stam/pilotlight-spack-snow-install\r\n```\r\n\r\nSpack debug report:\r\n```console\r\n$ spack debug report\r\n* **Spack:** 0.16.0-487-8956c8c7b\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-rhel7-broadwell\r\n* **Concretizer:** original\r\n```\r\n\r\nToday, I am not able to use this install_tree and am getting the error `==> Error: '<' not supported between instances of 'tuple' and 'str'` with simple commands like `spack find` and `spack uninstall <spec>`. Setting the install path to something else or using the default path works. I've tried reverting to older spack commits (v0.16.0) and am still get this error. Any guidance is appreciated. Thanks!\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack config blame config\r\nspack config blame config\r\n---                                                                                                                                  config:\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/config.yaml:2               install_tree:\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/config.yaml:3                 root: /lustre/scratch4/yellow/stam/pilotlight-spack-snow-install\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:21       projections:\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:22         all: ${ARCHITECTURE}/${COMPILERNAME}-${COMPILERVER}/${PACKAGE}-${VERSION}-${HASH}\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:33     template_dirs:\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:33     - $spack/share/spack/templates\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:34   \r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:38   \r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:39     # Locations where different types of modules should be installed.\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:40     module_roots:\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:68       tcl: $spack/share/spack/modules\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:69       lmod: $spack/share/spack/lmod\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:70     build_stage:\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:70     - $tempdir/$user/spack-stage\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:70     - ~/.spack/stage\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:70     # - $spack/var/spack/stage\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:70   \r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:76     # Directory in which to run tests and store test results.\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:80     # Tests will be stored in directories named by date/time and package\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:85     # name/hash.\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:91     test_stage: ~/.spack/test\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:96     source_cache: $spack/var/spack/cache\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:104    misc_cache: ~/.spack/cache\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:110    connect_timeout: 10\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:115    verify_ssl: True\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:120    suppress_gpg_warnings: False\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:128    install_missing_compilers: False\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:137    checksum: True\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:149    dirty: False\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:163    build_language: C\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:170    locks: True\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:178    ccache: False\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:184    concretizer: original\r\n/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml:189    db_lock_timeout: 3\r\n_builtin                                                                                                                               package_lock_timeout: !!null 'None'\r\n_builtin                                                                                                                               shared_linking: rpath\r\n```\r\n\r\n### Error Message\r\n\r\n<!-- If Spack reported an error, provide the error message. If it did not report an error but the output appears incorrect, provide the incorrect output. If there was no error message and no output but the result is incorrect, describe how it does not match what you expect. -->\r\n```console\r\n$ spack -d find\r\n==> [2021-01-06-09:30:20.016371] Imported find from built-in commands\r\n==> [2021-01-06-09:30:20.017870] Imported find from built-in commands\r\n==> [2021-01-06-09:30:20.019519] Reading config file /yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/defaults/config.yaml\r\n==> [2021-01-06-09:30:20.047304] Reading config file /yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/etc/spack/config.yaml\r\n==> [2021-01-06-09:30:20.051110] DATABASE LOCK TIMEOUT: 3s\r\n==> [2021-01-06-09:30:20.051184] PACKAGE LOCK TIMEOUT: No timeout\r\nTraceback (most recent call last):\r\n  File \"/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/bin/spack\", line 68, in <module>\r\n    sys.exit(spack.main.main())\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/spack/main.py\", line 762, in main\r\n    return _invoke_command(command, parser, args, unknown)\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/spack/main.py\", line 490, in _invoke_command\r\n    return_val = command(parser, args)\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/spack/cmd/find.py\", line 204, in find\r\n    results = args.specs(**q_args)\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/spack/cmd/common/arguments.py\", line 79, in _specs\r\n    return spack.store.db.query(**kwargs)\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/spack/database.py\", line 1491, in query\r\n    local_results = set(self.query_local(*args, **kwargs))\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/spack/database.py\", line 1476, in query_local\r\n    return sorted(self._query(*args, **kwargs))\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/llnl/util/lang.py\", line 249, in <lambda>\r\n    lambda s, o: o is not None and s._cmp_key() < o._cmp_key())\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/llnl/util/lang.py\", line 249, in <lambda>\r\n    lambda s, o: o is not None and s._cmp_key() < o._cmp_key())\r\n  File \"/yellow/usr/projects/paraview/stam/pilotlight/tests/spack/tmp_snow_master_intel_19.0.4.243/spack/lib/spack/llnl/util/lang.py\", line 249, in <lambda>\r\n    lambda s, o: o is not None and s._cmp_key() < o._cmp_key())\r\nTypeError: '<' not supported between instances of 'tuple' and 'str'\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\n\r\n### Additional information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\nSimilar issues I could find are https://github.com/spack/spack/issues/20310 and https://github.com/spack/spack/issues/18880\r\n- [x] I have run the failing commands in debug mode and reported the output\r\n\r\n<!-- We encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively!\r\n\r\nIf you want to ask a question about the tool (how to use it, what it can currently do, etc.), try the `#general` channel on our Slack first. We have a welcoming community and chances are you'll get your reply faster and without opening an issue.\r\n\r\nOther than that, thanks for taking the time to contribute to Spack! -->\r\n",
    "performed_via_github_app": null
}