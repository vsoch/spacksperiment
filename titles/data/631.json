{
    "url": "https://api.github.com/repos/spack/spack/issues/631",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/631/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/631/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/631/events",
    "html_url": "https://github.com/spack/spack/pull/631",
    "id": 143413723,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NjQxMjY2NzM=",
    "number": 631,
    "title": "DESTDIR support",
    "user": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908756,
            "node_id": "MDU6TGFiZWw3MzkwODc1Ng==",
            "url": "https://api.github.com/repos/spack/spack/labels/feature",
            "name": "feature",
            "color": "84b6eb",
            "default": false,
            "description": null
        },
        {
            "id": 446620033,
            "node_id": "MDU6TGFiZWw0NDY2MjAwMzM=",
            "url": "https://api.github.com/repos/spack/spack/labels/ready",
            "name": "ready",
            "color": "0e8a16",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "tgamblin",
        "id": 299842,
        "node_id": "MDQ6VXNlcjI5OTg0Mg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/299842?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tgamblin",
        "html_url": "https://github.com/tgamblin",
        "followers_url": "https://api.github.com/users/tgamblin/followers",
        "following_url": "https://api.github.com/users/tgamblin/following{/other_user}",
        "gists_url": "https://api.github.com/users/tgamblin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tgamblin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tgamblin/subscriptions",
        "organizations_url": "https://api.github.com/users/tgamblin/orgs",
        "repos_url": "https://api.github.com/users/tgamblin/repos",
        "events_url": "https://api.github.com/users/tgamblin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tgamblin/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "tgamblin",
            "id": 299842,
            "node_id": "MDQ6VXNlcjI5OTg0Mg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/299842?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tgamblin",
            "html_url": "https://github.com/tgamblin",
            "followers_url": "https://api.github.com/users/tgamblin/followers",
            "following_url": "https://api.github.com/users/tgamblin/following{/other_user}",
            "gists_url": "https://api.github.com/users/tgamblin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tgamblin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tgamblin/subscriptions",
            "organizations_url": "https://api.github.com/users/tgamblin/orgs",
            "repos_url": "https://api.github.com/users/tgamblin/repos",
            "events_url": "https://api.github.com/users/tgamblin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tgamblin/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 7,
    "created_at": "2016-03-25T03:09:15Z",
    "updated_at": "2019-04-23T09:25:13Z",
    "closed_at": "2019-04-23T09:25:13Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/631",
        "html_url": "https://github.com/spack/spack/pull/631",
        "diff_url": "https://github.com/spack/spack/pull/631.diff",
        "patch_url": "https://github.com/spack/spack/pull/631.patch"
    },
    "body": "IMO this could be merged before rpm support is ready (although is still a WIP). Right now it does the following:\n1. (conditionally) Redirect makefile, python distutils, and boost installation methods\n2. (conditionally) Redirect Spack commands that create files/directories \n3. Creates a separate .pth file for each python extension\n4. (optionally) automatically activates python extensions as part of the install process (so an rpm for a python extension would include symlinks within site-packages of the base python installation)\n\nIn short: a combination of DESTDIR support and splitting the unified python extension installation state (i.e. the single .pth file) into per-package state.\n\nNotes on [2]:\n- These alternative redirected commands are implicit within Package.install and otherwise must be called explicitly (e.g. call \u201cmkdirp_redirect\u201d for other functions in Package)\n- The redirected commands make assumptions about the desired source and/or destination\n  - e.g. \u201cinstall\u201d assumes that one is always intending to take a file outside the package installation directory and install it within the package installation directory\n  - build_environment adds a redirected working_dir which assumes by default that the user is not intending to work in package.prefix, but will attempt to redirect if the destination directory does not exist.\n  - I haven\u2019t redirected \u201cmove\u201d yet but I assume it should make the same assumptions as working_dir (i.e. users may want to move files around within the staging dir, within package.prefix, or between the two)\n\nRegarding [3] it may be the case that using the distutils DESTDIR equivalent eliminates .pth files (i.e. it does the installation so that .pth files are not required) so this may not be necessary.\n\nRegarding [4]: the activating linkage is also redirected.\n\nThere are still a few TODOs, including:\n- [x] redirection of all commands provided by build_environment to Package.install\n- [x] Python extensions creating _markerlib and pkg_resources directories. That likely needs to be omitted from linking.\n- [x] CustomDirectoryLayout in the install command does not do anything essential for this PR and should be removed \n",
    "performed_via_github_app": null
}