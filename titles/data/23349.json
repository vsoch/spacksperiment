{
    "url": "https://api.github.com/repos/spack/spack/issues/23349",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/23349/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/23349/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/23349/events",
    "html_url": "https://github.com/spack/spack/issues/23349",
    "id": 871488873,
    "node_id": "MDU6SXNzdWU4NzE0ODg4NzM=",
    "number": 23349,
    "title": "ruby-hpricot 0.8.6: rhel8 build fails: failed to build gem native extension",
    "user": {
        "login": "eugeneswalker",
        "id": 38933153,
        "node_id": "MDQ6VXNlcjM4OTMzMTUz",
        "avatar_url": "https://avatars.githubusercontent.com/u/38933153?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/eugeneswalker",
        "html_url": "https://github.com/eugeneswalker",
        "followers_url": "https://api.github.com/users/eugeneswalker/followers",
        "following_url": "https://api.github.com/users/eugeneswalker/following{/other_user}",
        "gists_url": "https://api.github.com/users/eugeneswalker/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/eugeneswalker/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/eugeneswalker/subscriptions",
        "organizations_url": "https://api.github.com/users/eugeneswalker/orgs",
        "repos_url": "https://api.github.com/users/eugeneswalker/repos",
        "events_url": "https://api.github.com/users/eugeneswalker/events{/privacy}",
        "received_events_url": "https://api.github.com/users/eugeneswalker/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 1474769306,
            "node_id": "MDU6TGFiZWwxNDc0NzY5MzA2",
            "url": "https://api.github.com/repos/spack/spack/labels/e4s",
            "name": "e4s",
            "color": "5224ad",
            "default": false,
            "description": ""
        },
        {
            "id": 966031931,
            "node_id": "MDU6TGFiZWw5NjYwMzE5MzE=",
            "url": "https://api.github.com/repos/spack/spack/labels/ecp",
            "name": "ecp",
            "color": "79d7ea",
            "default": false,
            "description": ""
        },
        {
            "id": 663894889,
            "node_id": "MDU6TGFiZWw2NjM4OTQ4ODk=",
            "url": "https://api.github.com/repos/spack/spack/labels/ruby",
            "name": "ruby",
            "color": "e99695",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2021-04-29T20:37:28Z",
    "updated_at": "2021-04-29T21:02:21Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "`ruby-hpricot@0.8.6` fails to build using:\r\n* spack@develop (c27c70acd9b03084bfcf2a07cf6270fcf350e75d from `Thu Apr 29 15:24:47 2021 -0400`)\r\n* RHEL 8 - GCC 8.3.1 (x86_64)\r\n\r\nNote: not seeing this error on Ubuntu 20.04 w/ GCC 9.3.0\r\n\r\nContainer: `ecpe4s/rhel8-runner-x86_64:2021-03-01`\r\nConcrete spec: [ruby-hpricot-3zgnes.spec.yaml.txt](https://github.com/spack/spack/files/6401484/ruby-hpricot-3zgnes.spec.yaml.txt)\r\nBuild log: [ruby-hpricot-build-out.txt](https://github.com/spack/spack/files/6401487/ruby-hpricot-build-out.txt)\r\n\r\n```\r\n$> spack mirror add E4S https://cache.e4s.io\r\n$> spack buildcache keys -it\r\n\r\n$> spack install --cache-only --only dependencies --include-build-deps -f ./ruby-hpricot-3zgnes.spec.yaml\r\n... OK\r\n\r\n$> spack install --no-cache -f ./ruby-hpricot-3zgnes.spec.yaml\r\n...\r\n==> Installing ruby-hpricot-0.8.6-3zgnesyfmrm7ym6764boo4oatx6bth6f\r\n==> Using cached archive: /opt/spack/var/spack/cache/_source-cache/archive/79/792f63cebe2f2b02058974755b4c8a3aef52e5daf37f779a34885d5ff2876017.tar.gz\r\n==> No patches needed for ruby-hpricot\r\n==> ruby-hpricot: Executing phase: 'build'\r\n==> ruby-hpricot: Executing phase: 'install'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/bin/gem' 'install' '--norc' '--ignore-dependencies' 'hpricot-0.8.6.gem'\r\n\r\n3 warnings found in build log:\r\n  >> 5    WARNING:  licenses is empty, but is recommended.  Use a license identifier from\r\n     6    http://spdx.org/licenses or 'Nonstandard' for a nonstandard license.\r\n  >> 7    WARNING:  description and summary are identical\r\n  >> 8    WARNING:  See https://guides.rubygems.org/specification-reference/ for help\r\n     9      Successfully built RubyGem\r\n     10     Name: hpricot\r\n     11     Version: 0.8.6\r\n     12     File: hpricot-0.8.6.gem\r\n     13   ==> ruby-hpricot: Executing phase: 'install'\r\n     14   ==> [2021-04-29-20:30:21.445363] '/opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/bin/gem' 'install' '--norc' '--ig\r\n          nore-dependencies' 'hpricot-0.8.6.gem'\r\n\r\nSee build log for details:\r\n  /tmp/root/spack-stage/spack-stage-ruby-hpricot-0.8.6-3zgnesyfmrm7ym6764boo4oatx6bth6f/spack-build-out.txt\r\n```\r\n\r\nRelevant excerpt from full build log:\r\n```\r\n  Successfully built RubyGem\r\n  Name: hpricot\r\n  Version: 0.8.6\r\n  File: hpricot-0.8.6.gem\r\n==> ruby-hpricot: Executing phase: 'install'\r\n==> [2021-04-29-20:30:21.445363] '/opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/bin/gem' 'install' '--norc' '--ignore-dependencies' 'hpricot-0.8.6.gem'\r\nBuilding native extensions. This could take a while...\r\nERROR:  Error installing hpricot-0.8.6.gem:\r\n\tERROR: Failed to build gem native extension.\r\n\r\n    current directory: /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-hpricot-0.8.6-3zgnesyfmrm7ym6764boo4oatx6bth6f/gems/hpricot-0.8.6/ext/fast_xs\r\n/opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/bin/ruby -I /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0 -r ./siteconf20210429-2378-hbcj1e.rb extconf.rb\r\nchecking for stdio.h... *** extconf.rb failed ***\r\nCould not create Makefile due to some reason, probably lack of necessary\r\nlibraries and/or headers.  Check the mkmf.log file for more details.  You may\r\nneed configuration options.\r\n\r\nProvided configuration options:\r\n\t--with-opt-dir\r\n\t--without-opt-dir\r\n\t--with-opt-include\r\n\t--without-opt-include=${opt-dir}/include\r\n\t--with-opt-lib\r\n\t--without-opt-lib=${opt-dir}/lib\r\n\t--with-make-prog\r\n\t--without-make-prog\r\n\t--srcdir=.\r\n\t--curdir\r\n\t--ruby=/opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/bin/$(RUBY_BASE_NAME)\r\n\t--with-stdio-dir\r\n\t--without-stdio-dir\r\n\t--with-stdio-include\r\n\t--without-stdio-include=${stdio-dir}/include\r\n\t--with-stdio-lib\r\n\t--without-stdio-lib=${stdio-dir}/lib\r\n/opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:471:in `try_do': The compiler failed to generate an executable file. (RuntimeError)\r\nYou have to install development tools first.\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:613:in `try_cpp'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:1124:in `block in have_header'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:971:in `block in checking_for'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:361:in `block (2 levels) in postpone'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:331:in `open'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:361:in `block in postpone'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:331:in `open'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:357:in `postpone'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:970:in `checking_for'\r\n\tfrom /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-3.0.0-kspsemtwugyytk7ytmopwctj32k4ty37/lib/ruby/3.0.0/mkmf.rb:1123:in `have_header'\r\n\tfrom extconf.rb:2:in `<main>'\r\n\r\nTo see why this extension failed to compile, please check the mkmf.log which can be found here:\r\n\r\n  /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-hpricot-0.8.6-3zgnesyfmrm7ym6764boo4oatx6bth6f/extensions/x86_64-linux/3.0.0-static/hpricot-0.8.6/mkmf.log\r\n\r\nextconf failed, exit code 1\r\n\r\nGem files will remain installed in /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-hpricot-0.8.6-3zgnesyfmrm7ym6764boo4oatx6bth6f/gems/hpricot-0.8.6 for inspection.\r\nResults logged to /opt/spack/opt/spack/linux-rhel8-x86_64/gcc-8.3.1/ruby-hpricot-0.8.6-3zgnesyfmrm7ym6764boo4oatx6bth6f/extensions/x86_64-linux/3.0.0-static/hpricot-0.8.6/gem_make.out\r\n```\r\n\r\n@adamjstewart - just pinging you because you added the package and maybe you know what this means? From a google search it looks like this error comes up frequently on MacOS but I couldn't find much on RHEL 8 etiology.\r\n",
    "performed_via_github_app": null
}