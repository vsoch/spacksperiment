{
    "url": "https://api.github.com/repos/spack/spack/issues/14426",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/14426/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/14426/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/14426/events",
    "html_url": "https://github.com/spack/spack/issues/14426",
    "id": 546994295,
    "node_id": "MDU6SXNzdWU1NDY5OTQyOTU=",
    "number": 14426,
    "title": "Installation Issue: llvm",
    "user": {
        "login": "jlconlin",
        "id": 1275437,
        "node_id": "MDQ6VXNlcjEyNzU0Mzc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1275437?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jlconlin",
        "html_url": "https://github.com/jlconlin",
        "followers_url": "https://api.github.com/users/jlconlin/followers",
        "following_url": "https://api.github.com/users/jlconlin/following{/other_user}",
        "gists_url": "https://api.github.com/users/jlconlin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jlconlin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jlconlin/subscriptions",
        "organizations_url": "https://api.github.com/users/jlconlin/orgs",
        "repos_url": "https://api.github.com/users/jlconlin/repos",
        "events_url": "https://api.github.com/users/jlconlin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jlconlin/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 654034395,
            "node_id": "MDU6TGFiZWw2NTQwMzQzOTU=",
            "url": "https://api.github.com/repos/spack/spack/labels/clang",
            "name": "clang",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 446614839,
            "node_id": "MDU6TGFiZWw0NDY2MTQ4Mzk=",
            "url": "https://api.github.com/repos/spack/spack/labels/macOS",
            "name": "macOS",
            "color": "c5def5",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-01-08T17:16:08Z",
    "updated_at": "2021-03-04T17:29:10Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "I'm trying to install llvm@3.8.1 after upgrade my Mac to MacOS Catalina (10.15.2). I've successfully installed llvm@3.8.1 prior to the upgrade, but it doesn't seem to work post-upgrade.\r\n\r\n- I've tried what was suggested for #13413 to no avail.\r\n- This seems to be unrelated to a previous issue of mine (#11290).\r\n---\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install llvm@3.8.1~compiler-rt~lldb # Fill in the exact spec you are using\r\n==> Created stage in /var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652pz3px\r\n==> No patches needed for llvm\r\n==> Building llvm [CMakePackage]\r\n==> Executing phase: 'cmake'\r\n==> Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make'\r\n\r\n5 errors found in build log:\r\n     3504    cd /private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod6\r\n             52pz3px/spack-build/tools/bugpoint && /Users/jlconlin/spack/lib/spack/env/clang/clang++  -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT\r\n             _MACROS -D__STDC_LIMIT_MACROS -I/private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.\r\n             8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-build/tools/bugpoint -I/private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconl\r\n             in/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-src/llvm/tools/bugpoint -I/private/var/folders/0f/pp\r\n             r9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-build/include -\r\n             I/private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652\r\n             pz3px/spack-src/llvm/include  -std=c++11 -fPIC -fvisibility-inlines-hidden -Wall -W -Wno-unused-parameter -Wwrite-strings -Wcast-\r\n             qual -Wmissing-field-initializers -pedantic -Wno-long-long -Wcovered-switch-default -Wnon-virtual-dtor -Wdelete-non-virtual-dtor\r\n             -std=c++11 -O3 -DNDEBUG -isysroot /Applications/Xcode10.1.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX1\r\n             0.14.sdk     -o CMakeFiles/bugpoint.dir/ToolRunner.cpp.o -c /private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spa\r\n             ck-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-src/llvm/tools/bugpoint/ToolRunner.cpp\r\n     3505    [ 90%] Building CXX object tools/bugpoint/CMakeFiles/bugpoint.dir/bugpoint.cpp.o\r\n     3506    cd /private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod6\r\n             52pz3px/spack-build/tools/bugpoint && /Users/jlconlin/spack/lib/spack/env/clang/clang++  -D__STDC_CONSTANT_MACROS -D__STDC_FORMAT\r\n             _MACROS -D__STDC_LIMIT_MACROS -I/private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.\r\n             8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-build/tools/bugpoint -I/private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconl\r\n             in/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-src/llvm/tools/bugpoint -I/private/var/folders/0f/pp\r\n             r9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-build/include -\r\n             I/private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652\r\n             pz3px/spack-src/llvm/include  -std=c++11 -fPIC -fvisibility-inlines-hidden -Wall -W -Wno-unused-parameter -Wwrite-strings -Wcast-\r\n             qual -Wmissing-field-initializers -pedantic -Wno-long-long -Wcovered-switch-default -Wnon-virtual-dtor -Wdelete-non-virtual-dtor\r\n             -std=c++11 -O3 -DNDEBUG -isysroot /Applications/Xcode10.1.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX1\r\n             0.14.sdk     -o CMakeFiles/bugpoint.dir/bugpoint.cpp.o -c /private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack\r\n             -stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod652pz3px/spack-src/llvm/tools/bugpoint/bugpoint.cpp\r\n     3507    [ 90%] Linking CXX executable ../../bin/bugpoint\r\n     3508    cd /private/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-vbcihp5ow2df26vibxwwwzod6\r\n             52pz3px/spack-build/tools/bugpoint && /Users/jlconlin/spack/opt/spack/darwin-catalina-x86_64/clang-10.0.0-apple/cmake-3.16.2-k3fb\r\n             d3iojgn6k5lbwuskeg56jgv2is3s/bin/cmake -E cmake_link_script CMakeFiles/bugpoint.dir/link.txt --verbose=1\r\n     3509    /Users/jlconlin/spack/lib/spack/env/clang/clang++  -std=c++11 -fPIC -fvisibility-inlines-hidden -Wall -W -Wno-unused-parameter -W\r\n             write-strings -Wcast-qual -Wmissing-field-initializers -pedantic -Wno-long-long -Wcovered-switch-default -Wnon-virtual-dtor -Wdel\r\n             ete-non-virtual-dtor -std=c++11 -O3 -DNDEBUG -isysroot /Applications/Xcode10.1.app/Contents/Developer/Platforms/MacOSX.platform/D\r\n             eveloper/SDKs/MacOSX10.14.sdk -Wl,-search_paths_first -Wl,-headerpad_max_install_names  -rdynamic CMakeFiles/bugpoint.dir/BugDriv\r\n             er.cpp.o CMakeFiles/bugpoint.dir/CrashDebugger.cpp.o CMakeFiles/bugpoint.dir/ExecutionDriver.cpp.o CMakeFiles/bugpoint.dir/Extrac\r\n             tFunction.cpp.o CMakeFiles/bugpoint.dir/FindBugs.cpp.o CMakeFiles/bugpoint.dir/Miscompilation.cpp.o CMakeFiles/bugpoint.dir/Optim\r\n             izerDriver.cpp.o CMakeFiles/bugpoint.dir/ToolRunner.cpp.o CMakeFiles/bugpoint.dir/bugpoint.cpp.o  -o ../../bin/bugpoint  -Wl,-rpa\r\n             th,@executable_path/../lib ../../lib/libLLVMAnalysis.a ../../lib/libLLVMBitWriter.a ../../lib/libLLVMCodeGen.a ../../lib/libLLVMC\r\n             ore.a ../../lib/libLLVMipo.a ../../lib/libLLVMIRReader.a ../../lib/libLLVMInstCombine.a ../../lib/libLLVMInstrumentation.a ../../\r\n             lib/libLLVMLinker.a ../../lib/libLLVMObjCARCOpts.a ../../lib/libLLVMScalarOpts.a ../../lib/libLLVMSupport.a ../../lib/libLLVMTarg\r\n             et.a ../../lib/libLLVMTransformUtils.a ../../lib/libLLVMVectorize.a ../../lib/libLLVMBitWriter.a ../../lib/libLLVMAsmParser.a ../\r\n             ../lib/libLLVMInstCombine.a ../../lib/libLLVMProfileData.a ../../lib/libLLVMObject.a ../../lib/libLLVMBitReader.a ../../lib/libLL\r\n             VMMCParser.a ../../lib/libLLVMMC.a ../../lib/libLLVMTransformUtils.a ../../lib/libLLVMAnalysis.a ../../lib/libLLVMCore.a ../../li\r\n             b/libLLVMSupport.a -lcurses -lpthread -lz -lm\r\n  >> 3510    Undefined symbols for architecture x86_64:\r\n     3511      \"polly::initializePollyPasses(llvm::PassRegistry&)\", referenced from:\r\n     3512          _main in bugpoint.cpp.o\r\n     3513    ld: symbol(s) not found for architecture x86_64\r\n  >> 3514    clang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n  >> 3515    make[2]: *** [bin/bugpoint] Error 1\r\n  >> 3516    make[1]: *** [tools/bugpoint/CMakeFiles/bugpoint.dir/all] Error 2\r\n  >> 3517    make: *** [all] Error 2\r\n```\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n```commandline\r\n$ uname -a \r\nDarwin radagast.lanl.gov 19.2.0 Darwin Kernel Version 19.2.0: Sat Nov  9 03:47:04 PST 2019; root:xnu-6153.61.1~20/RELEASE_X86_64 x86_64\r\n\r\n``` \r\nand, if relevant, post or attach:\r\n\r\n\r\n- `packages.yaml`\r\n- `compilers.yaml`\r\n```yaml\r\ncompilers:\r\n- compiler:\r\n    spec: clang@10.0.0-apple\r\n    paths:\r\n      cc: /usr/bin/clang\r\n      cxx: /usr/bin/clang++\r\n      f77:\r\n      fc:\r\n    flags: {}\r\n    operating_system: catalina\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []\r\n```\r\n\r\nto the issue\r\n\r\n### Additional information\r\n\r\nSometimes the issue benefits from additional details. In these cases there are\r\na few things we can suggest doing. First of all, you can post the full output of:\r\n```console\r\n$ spack spec --install-status llvm@3.8.1\r\nInput spec\r\n--------------------------------\r\n -   llvm@3.8.1\r\n\r\nConcretized\r\n--------------------------------\r\n==> Warning: clang@10.0.0-apple cannot build optimized binaries for \"ivybridge\". Using best target possible: \"x86_64\"\r\n -   llvm@3.8.1%clang@10.0.0-apple~all_targets build_type=Release +clang+compiler-rt~flang+gold+internal_unwind+libcxx~link_dylib+lld+lldb~omp_tsan+polly~python~shared_libs arch=darwin-catalina-x86_64\r\n[+]      ^binutils@2.32%clang@10.0.0-apple+gold~headers~libiberty+nls~plugins arch=darwin-catalina-x86_64\r\n[+]          ^gettext@0.20.1%clang@10.0.0-apple+bzip2+curses+git~libunistring+libxml2+tar+xz arch=darwin-catalina-x86_64\r\n[+]              ^bzip2@1.0.8%clang@10.0.0-apple+shared arch=darwin-catalina-x86_64\r\n[+]                  ^diffutils@3.7%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]                      ^libiconv@1.16%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]              ^libxml2@2.9.9%clang@10.0.0-apple~python arch=darwin-catalina-x86_64\r\n[+]                  ^pkgconf@1.6.3%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]                  ^xz@5.2.4%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]                  ^zlib@1.2.11%clang@10.0.0-apple+optimize+pic+shared arch=darwin-catalina-x86_64\r\n[+]              ^ncurses@6.1%clang@10.0.0-apple~symlinks~termlib arch=darwin-catalina-x86_64\r\n[+]              ^tar@1.32%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]      ^cmake@3.16.2%clang@10.0.0-apple~doc+ncurses+openssl+ownlibs~qt arch=darwin-catalina-x86_64\r\n[+]          ^openssl@1.1.1d%clang@10.0.0-apple+systemcerts arch=darwin-catalina-x86_64\r\n[+]              ^perl@5.30.0%clang@10.0.0-apple+cpanm+shared+threads arch=darwin-catalina-x86_64\r\n[+]                  ^gdbm@1.18.1%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]                      ^readline@8.0%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n -       ^libedit@3.1-20170329%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]      ^perl-data-dumper@2.173%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]      ^python@2.7.16%clang@10.0.0-apple+bz2+ctypes+dbm+lzma~nis~optimizations patches=210df3f28cde02a8135b58cc4168e70ab91dbf9097359d05938f1e2843875e57 +pic+pyexpat+pythoncmd+readline~shared+sqlite3+ssl~tix~tkinter~ucs4~uuid+zlib arch=darwin-catalina-x86_64\r\n[+]          ^expat@2.2.9%clang@10.0.0-apple~libbsd arch=darwin-catalina-x86_64\r\n[+]          ^libffi@3.2.1%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n[+]          ^sqlite@3.30.1%clang@10.0.0-apple~column_metadata+fts~functions~rtree arch=darwin-catalina-x86_64\r\n -       ^swig@4.0.0%clang@10.0.0-apple arch=darwin-catalina-x86_64\r\n -           ^pcre@8.42%clang@10.0.0-apple~jit+multibyte+utf arch=darwin-catalina-x86_64\r\n```\r\nto show people whether Spack installed a faulty software or if it was not able to\r\nbuild it at all. \r\n\r\n\r\nYou might want to run this command on the `config.log` or any other similar file\r\nfound in the stage directory: \r\n```console\r\n$\u00a0spack location -s llvm@3.8.1\r\n==> Warning: clang@10.0.0-apple cannot build optimized binaries for \"ivybridge\". Using best target possible: \"x86_64\"\r\n/var/folders/0f/ppr9sz5x29v6c48_nzc29h8w0002jq/T/jlconlin/spack-stage/spack-stage-llvm-3.8.1-eakzjsufmflvm2dlamz5bhc4xngjdq6c\r\n\r\n```\r\nIn case in `config.log` there are other settings that you think might be the cause \r\nof the build failure, you can consider attaching the file to this issue.\r\n\r\nRebuilding the package with the following options:\r\n```console\r\n$ spack -d install -j 1 <spec>\r\n...\r\n```\r\nwill provide additional debug information. After the failure you will find two files in the current directory:\r\n\r\n1. `spack-cc-<spec>.in`, which contains details on the command given in input \r\n    to Spack's compiler wrapper  \r\n1. `spack-cc-<spec>.out`, which contains the command used to compile / link the \r\n    failed object after Spack's compiler wrapper did its processing \r\n\r\nYou can post or attach those files to provide maintainers with more information on what\r\nis causing the failure.\r\n",
    "performed_via_github_app": null
}