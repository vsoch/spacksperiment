{
    "url": "https://api.github.com/repos/spack/spack/issues/12571",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/12571/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/12571/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/12571/events",
    "html_url": "https://github.com/spack/spack/issues/12571",
    "id": 484890433,
    "node_id": "MDU6SXNzdWU0ODQ4OTA0MzM=",
    "number": 12571,
    "title": "Installation issue: raja~openmp still seems to require OpenMP",
    "user": {
        "login": "goxberry",
        "id": 321479,
        "node_id": "MDQ6VXNlcjMyMTQ3OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/321479?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/goxberry",
        "html_url": "https://github.com/goxberry",
        "followers_url": "https://api.github.com/users/goxberry/followers",
        "following_url": "https://api.github.com/users/goxberry/following{/other_user}",
        "gists_url": "https://api.github.com/users/goxberry/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/goxberry/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/goxberry/subscriptions",
        "organizations_url": "https://api.github.com/users/goxberry/orgs",
        "repos_url": "https://api.github.com/users/goxberry/repos",
        "events_url": "https://api.github.com/users/goxberry/events{/privacy}",
        "received_events_url": "https://api.github.com/users/goxberry/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2019-08-25T04:50:29Z",
    "updated_at": "2019-08-27T12:00:41Z",
    "closed_at": "2019-08-27T12:00:41Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "### Summary\r\n\r\nAttempting to build RAJA 0.8.0 without OpenMP using Apple Clang 10.0.1 and GNU Fortran 9.2.0 yields a run-time error in CMake because Apple Clang does not ship with OpenMP. In other words, building RAJA without OpenMP still seems to require OpenMP, which is counterintuitive.\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install raja@0.8.0~cuda~openmp buildtype=RelWithDebInfo %clang@10.0.1-apple\r\n==> cmake@3.15.2 : externally installed in /usr/local/opt/cmake\r\n==> cmake@3.15.2 : already registered in DB\r\n==> Installing raja\r\n==> Searching for binary cache of raja\r\n==> Finding buildcaches in /Users/goxberry/repos/spack/var/spack/mirrors/coinhsl-mirror/build_cache\r\n==> No binary for raja found: installing from source\r\n==> Warning: Fetching from mirror without a checksum!\r\n  This package is normally checked out from a version control system, but it has been archived on a spack mirror.  This means we cannot know a checksum for the tarball in advance. Be sure that your connection to this mirror is secure!\r\n==> Using cached archive: /Users/goxberry/repos/spack/var/spack/cache/raja/raja-0.8.0.tar.gz\r\n==> Staging archive: /var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/raja-0.8.0.tar.gz\r\n==> Created stage in /var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla\r\n==> No patches needed for raja\r\n==> Building raja [CMakePackage]\r\n==> Executing phase: 'cmake'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    'cmake' '/var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/spack-src' '-G' 'Unix Makefiles' '-DCMAKE_INSTALL_PREFIX:PATH=/Users/goxberry/repos/spack/opt/spack/darwin-mojave-x86_64/clang-10.0.1-apple/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla' '-DCMAKE_BUILD_TYPE:STRING=RelWithDebInfo' '-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON' '-DCMAKE_FIND_FRAMEWORK:STRING=LAST' '-DCMAKE_FIND_APPBUNDLE:STRING=LAST' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=FALSE' '-DCMAKE_INSTALL_RPATH:STRING=/Users/goxberry/repos/spack/opt/spack/darwin-mojave-x86_64/clang-10.0.1-apple/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/lib;/Users/goxberry/repos/spack/opt/spack/darwin-mojave-x86_64/clang-10.0.1-apple/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/lib64' '-DCMAKE_PREFIX_PATH:STRING=/usr/local/opt/cmake'\r\n\r\n1 error found in build log:\r\n     63    Call Stack (most recent call first):\r\n     64      CMakeLists.txt:96 (include)\r\n     65    This warning is for project developers.  Use -Wno-dev to suppress it.\r\n     66    \r\n     67    -- C Compiler family is Clang\r\n     68    -- OpenMP Support is On\r\n  >> 69    CMake Error at /usr/local/Cellar/cmake/3.15.2/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:137 (message):\r\n     70      Could NOT find OpenMP_C (missing: OpenMP_C_FLAGS OpenMP_C_LIB_NAMES)\r\n     71    Call Stack (most recent call first):\r\n     72      /usr/local/Cellar/cmake/3.15.2/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:378 (_FPHSA_FAILURE_MESSAGE)\r\n     73      /usr/local/Cellar/cmake/3.15.2/share/cmake/Modules/FindOpenMP.cmake:477 (find_package_handle_standard_args)\r\n     74      blt/cmake/SetupCompilerOptions.cmake:85 (find_package)\r\n     75      blt/SetupBLT.cmake:170 (include)\r\n\r\nSee build log for details:\r\n  /var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/spack-build-out.txt\r\n```\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n\r\nI am running macOS 10.14.6 and compiling RAJA with Apple Clang 10.0.1 + GNU Fortran 9.2. I have installed LLVM 8.0's OpenMP via `brew install libomp`, but was not sure if there was an LLVM OpenMP package in Spack. (Could it be `llvm-openmp-ompt`?)\r\n\r\nand, if relevant, post or attach:\r\n\r\n- `compilers.yaml`:\r\n```yaml\r\ncompilers:\r\n- compiler:\r\n    environment: {}\r\n    extra_rpaths: []\r\n    flags: {}\r\n    modules: []\r\n    operating_system: mojave\r\n    paths:\r\n      cc: /usr/bin/clang\r\n      cxx: /usr/bin/clang++\r\n      f77: /usr/local/bin/gfortran\r\n      fc: /usr/local/bin/gfortran\r\n    spec: clang@10.0.1-apple\r\n    target: x86_64\r\n- compiler:\r\n    environment: {}\r\n    extra_rpaths: []\r\n    flags: {}\r\n    modules: []\r\n    operating_system: mojave\r\n    paths:\r\n      cc: /usr/local/bin/gcc-9\r\n      cxx: /usr/local/bin/g++-9\r\n      f77: /usr/local/bin/gfortran-9\r\n      fc: /usr/local/bin/gfortran-9\r\n    spec: gcc@9.2.0\r\n    target: x86_64\r\n```\r\n\r\nto the issue\r\n\r\n### Additional information\r\n\r\n`spack-build-out.txt`:\r\n```console\r\n==> Executing phase: 'cmake'\r\n==> [2019-08-24-21:38:37.732567] 'cmake' '/var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/spack-src' '-G' 'Unix Makefiles' '-DCMAKE_INSTALL_PREFIX:PATH=/Users/goxberry/repos/spack/opt/spack/darwin-mojave-x86_64/clang-10.0.1-apple/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla' '-DCMAKE_BUILD_TYPE:STRING=RelWithDebInfo' '-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON' '-DCMAKE_FIND_FRAMEWORK:STRING=LAST' '-DCMAKE_FIND_APPBUNDLE:STRING=LAST' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=FALSE' '-DCMAKE_INSTALL_RPATH:STRING=/Users/goxberry/repos/spack/opt/spack/darwin-mojave-x86_64/clang-10.0.1-apple/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/lib;/Users/goxberry/repos/spack/opt/spack/darwin-mojave-x86_64/clang-10.0.1-apple/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/lib64' '-DCMAKE_PREFIX_PATH:STRING=/usr/local/opt/cmake'\r\n-- The CXX compiler identification is AppleClang 10.0.1.10010046\r\n-- The C compiler identification is AppleClang 10.0.1.10010046\r\n-- Check for working CXX compiler: /Users/goxberry/repos/spack/lib/spack/env/clang/clang++\r\n-- Check for working CXX compiler: /Users/goxberry/repos/spack/lib/spack/env/clang/clang++ -- works\r\n-- Detecting CXX compiler ABI info\r\n-- Detecting CXX compiler ABI info - done\r\n-- Detecting CXX compile features\r\n-- Detecting CXX compile features - done\r\n-- Check for working C compiler: /Users/goxberry/repos/spack/lib/spack/env/clang/clang\r\n-- Check for working C compiler: /Users/goxberry/repos/spack/lib/spack/env/clang/clang -- works\r\n-- Detecting C compiler ABI info\r\n-- Detecting C compiler ABI info - done\r\n-- Detecting C compile features\r\n-- Detecting C compile features - done\r\nCMake Warning (dev) at CMakeLists.txt:46 (set):\r\n  implicitly converting 'Bool' to 'STRING' type.\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n\r\nCMake Warning (dev) at CMakeLists.txt:47 (set):\r\n  implicitly converting 'Bool' to 'STRING' type.\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n\r\nCMake Warning (dev) at CMakeLists.txt:48 (set):\r\n  implicitly converting 'Bool' to 'STRING' type.\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n\r\nCMake Warning (dev) at CMakeLists.txt:49 (set):\r\n  implicitly converting 'Bool' to 'STRING' type.\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n\r\n-- BLT Version: 0.2.0\r\n-- CMake Version: 3.15.2\r\n-- CMake Executable: /usr/local/Cellar/cmake/3.15.2/bin/cmake\r\n-- Found Git: /usr/local/bin/git (found version \"2.23.0\") \r\n-- Git Support is ON\r\n-- Git Executable: /usr/local/bin/git\r\n-- Git Version: 2.23.0\r\n-- MPI Support is OFF\r\n-- CUDA Support is Off\r\n-- ROCM Support is OFF\r\n-- Found Doxygen: /usr/local/bin/doxygen (found version \"1.8.16\") found components:  doxygen dot \r\n-- Sphinx support is ON\r\n-- Found Sphinx: /Users/goxberry/Library/Python/2.7/bin/sphinx-build  \r\n-- Valgrind support is ON\r\n-- Failed to locate Valgrind executable (missing: VALGRIND_EXECUTABLE) \r\n-- Uncrustify support is ON\r\n-- Found Uncrustify: /usr/local/bin/uncrustify  \r\n-- AStyle support is ON\r\n-- Found AStyle: /usr/local/bin/astyle  \r\n-- Cppcheck support is ON\r\n-- Found Cppcheck: /usr/local/bin/cppcheck  \r\n-- ClangQuery support is \r\nCMake Warning (dev) at blt/SetupBLT.cmake:160 (set):\r\n  implicitly converting 'LIST' to 'STRING' type.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:96 (include)\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n\r\nCMake Warning (dev) at blt/SetupBLT.cmake:162 (set):\r\n  implicitly converting 'LIST' to 'STRING' type.\r\nCall Stack (most recent call first):\r\n  CMakeLists.txt:96 (include)\r\nThis warning is for project developers.  Use -Wno-dev to suppress it.\r\n\r\n-- C Compiler family is Clang\r\n-- OpenMP Support is On\r\nCMake Error at /usr/local/Cellar/cmake/3.15.2/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:137 (message):\r\n  Could NOT find OpenMP_C (missing: OpenMP_C_FLAGS OpenMP_C_LIB_NAMES)\r\nCall Stack (most recent call first):\r\n  /usr/local/Cellar/cmake/3.15.2/share/cmake/Modules/FindPackageHandleStandardArgs.cmake:378 (_FPHSA_FAILURE_MESSAGE)\r\n  /usr/local/Cellar/cmake/3.15.2/share/cmake/Modules/FindOpenMP.cmake:477 (find_package_handle_standard_args)\r\n  blt/cmake/SetupCompilerOptions.cmake:85 (find_package)\r\n  blt/SetupBLT.cmake:170 (include)\r\n  CMakeLists.txt:96 (include)\r\n\r\n-- Configuring incomplete, errors occurred!\r\nSee also \"/private/var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/spack-build/CMakeFiles/CMakeOutput.log\".\r\nSee also \"/private/var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/raja-0.8.0-ibk6hokkeywfcsw3vqyj7qs6kon4xzla/spack-build/CMakeFiles/CMakeError.log\".\r\n```\r\n",
    "performed_via_github_app": null
}