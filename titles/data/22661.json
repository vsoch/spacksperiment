{
    "url": "https://api.github.com/repos/spack/spack/issues/22661",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/22661/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/22661/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/22661/events",
    "html_url": "https://github.com/spack/spack/issues/22661",
    "id": 845661540,
    "node_id": "MDU6SXNzdWU4NDU2NjE1NDA=",
    "number": 22661,
    "title": "bind9:make check error with 9_17_11",
    "user": {
        "login": "fubingting",
        "id": 72855012,
        "node_id": "MDQ6VXNlcjcyODU1MDEy",
        "avatar_url": "https://avatars.githubusercontent.com/u/72855012?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fubingting",
        "html_url": "https://github.com/fubingting",
        "followers_url": "https://api.github.com/users/fubingting/followers",
        "following_url": "https://api.github.com/users/fubingting/following{/other_user}",
        "gists_url": "https://api.github.com/users/fubingting/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/fubingting/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fubingting/subscriptions",
        "organizations_url": "https://api.github.com/users/fubingting/orgs",
        "repos_url": "https://api.github.com/users/fubingting/repos",
        "events_url": "https://api.github.com/users/fubingting/events{/privacy}",
        "received_events_url": "https://api.github.com/users/fubingting/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-03-31T02:11:30Z",
    "updated_at": "2021-03-31T02:11:30Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "When I tested bind9 for make check, there was 75 fail, so I decided to upgrade to the latest version 9_17_11 and modify the code as follows, but there are still errors. I don't have the authority to communicate with the bind9 community. Can you give feedback on this bug to the official community?\r\n**spack update code\uff1a**\r\nclass Bind9(AutotoolsPackage):\r\n\u00a0\u00a0\u00a0\u00a0\"\"\"\r\n\u00a0\u00a0\u00a0\u00a0BIND 9 has evolved to be a very flexible, full-featured DNS system.\r\n\u00a0\u00a0\u00a0\u00a0\"\"\"\r\n\r\n\u00a0\u00a0\u00a0\u00a0homepage = \"https://github.com/isc-projects/bind9\"\r\n\u00a0\u00a0\u00a0\u00a0url      = \"https://github.com/isc-projects/bind9/archive/v9_14_6.tar.gz\"\r\n\r\n\u00a0\u00a0\u00a0\u00a0version('9_17_11', sha256='9cc9b2274beb25df3c31ac7a0e0a6cca2fa12098257ccc7250b37d5ef6fde05c')\r\n\u00a0\u00a0\u00a0\u00a0version('9_14_6', sha256='98be7a7b6d614b519f6c8d6ec7a8a39759ae9604d87228d9dc7c034471e5433e')\r\n\r\n\u00a0\u00a0\u00a0\u00a0depends_on('libuv', type='link')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('pkgconfig', type='build')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('openssl', type='link')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('libiconv', type='link')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('nghttp2', type='link')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('krb5')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('libcap')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('py-testresources')\r\n\u00a0\u00a0\u00a0\u00a0depends_on('cmocka')\r\n\u00a0\u00a0\u00a0\u00a0\r\n\u00a0\u00a0\u00a0\u00a0def configure_args(self):\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0args = ['--with-openssl={0}'.format(self.spec['openssl'].prefix), '--enable-developer']\r\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0return args\r\n\r\n\r\n**Test Environment\uff1a\r\nos\uff1acentos8\r\nplatform\uff1aaarch64**\r\n\r\n**bind9 make check bug\uff1a**\r\n================================================\r\n   BIND 9.17.11: lib/isc/tests/test-suite.log\r\n================================================\r\n\r\n# TOTAL: 36\r\n# PASS:  20\r\n# SKIP:  0\r\n# XFAIL: 0\r\n# FAIL:  16\r\n# XPASS: 0\r\n# ERROR: 0\r\n\r\n.. contents:: :depth: 2\r\n\r\nFAIL: buffer_test\r\n=================\r\n\r\n[==========] Running 4 test(s).\r\n[ RUN      ] isc_buffer_reserve_test\r\nFAIL buffer_test (exit status: 255)\r\n\r\nFAIL: counter_test\r\n==================\r\n\r\n[==========] Running 1 test(s).\r\n[ RUN      ] isc_counter_test\r\nFAIL counter_test (exit status: 255)\r\n\r\nFAIL: doh_test\r\n==============\r\n\r\n[==========] Running 32 test(s).\r\n[ RUN      ] mock_doh_uv_tcp_bind\r\n[       OK ] mock_doh_uv_tcp_bind\r\n\u2026\u2026\r\n[ RUN      ] doh_half_recv_send_POST\r\nnetmgr/netmgr.c:492: INSIST(references == 1) failed, back trace\r\n/tmp/root/spack-stage/spack-stage-bind9-9_17_11-nvq6zta72ocfyaewd6gvqxqsxym7lskq/spack-src/lib/isc/.libs/libisc-9.17.11.so(+0x4a84c) [0xffffb4aea84c]\r\n/tmp/root/spack-stage/spack-stage-bind9-9_17_11-nvq6zta72ocfyaewd6gvqxqsxym7lskq/spack-src/lib/isc/.libs/libisc-9.17.11.so(isc_assertion_failed+0x14) [0xffffb4aea794]\r\n/tmp/root/spack-stage/spack-stage-bind9-9_17_11-nvq6zta72ocfyaewd6gvqxqsxym7lskq/spack-src/lib/isc/.libs/libisc-9.17.11.so(isc__nmsocket_active+0) [0xffffb4ac19d8]\r\n/tmp/root/spack-stage/spack-stage-bind9-9_17_11-nvq6zta72ocfyaewd6gvqxqsxym7lskq/spack-src/lib/isc/tests/.libs/lt-doh_test() [0x406ed0]\r\n/home/spack/opt/spack/linux-centos8-aarch64/gcc-8.3.1/cmocka-1.1.1-5m5qjnn24i7ty5xojjjw6snlvws6pqgo/lib/libcmocka.so.0(+0x4e88) [0xffffb4b64e88]\r\n/home/spack/opt/spack/linux-centos8-aarch64/gcc-8.3.1/cmocka-1.1.1-5m5qjnn24i7ty5xojjjw6snlvws6pqgo/lib/libcmocka.so.0(_cmocka_run_group_tests+0x368) [0xffffb4b65678]\r\n/tmp/root/spack-stage/spack-stage-bind9-9_17_11-nvq6zta72ocfyaewd6gvqxqsxym7lskq/spack-src/lib/isc/tests/.libs/lt-doh_test() [0x404a2c]\r\n/lib64/libc.so.6(__libc_start_main+0xe4) [0xffffb4460be4]\r\n/tmp/root/spack-stage/spack-stage-bind9-9_17_11-nvq6zta72ocfyaewd6gvqxqsxym7lskq/spack-src/lib/isc/tests/.libs/lt-doh_test() [0x404a7c]\r\n./../../unit-test-driver.sh: line 13: 3114606 Aborted                 (core dumped) \"${TEST_PROGRAM}\"\r\nFAIL doh_test (exit status: 134)\r\n\r\nFAIL: heap_test\r\n===============\r\n\r\n[==========] Running 1 test(s).\r\n[ RUN      ] isc_heap_delete_test\r\n[       OK ] isc_heap_delete_test\r\nFAIL heap_test (exit status: 255)\r\n\r\nFAIL: ht_test\r\n=============\r\n\r\n[==========] Running 4 test(s).\r\n[ RUN      ] isc_ht_20\r\n[       OK ] isc_ht_20\r\n[ RUN      ] isc_ht_8\r\n[       OK ] isc_ht_8\r\n[ RUN      ] isc_ht_1\r\n[       OK ] isc_ht_1\r\n[ RUN      ] isc_ht_iterator_test\r\n[       OK ] isc_ht_iterator_test\r\ntrampoline.c:152: fatal error: trampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failedtrampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failedRUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\n\r\n\r\ntrampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\n./../../unit-test-driver.sh: line 13: 3117159 Aborted                 (core dumped) \"${TEST_PROGRAM}\"\r\nFAIL ht_test (exit status: 134)\r\n\r\nFAIL: lex_test\r\n==============\r\n\r\n[==========] Running 2 test(s).\r\n[ RUN      ] lex_0xff\r\n[       OK ] lex_0xff\r\n[ RUN      ] lex_setline\r\n[       OK ] lex_setline\r\nFAIL lex_test (exit status: 255)\r\n\r\nFAIL: mem_test\r\n==============\r\n\r\n[==========] Running 8 test(s).\r\n[ RUN      ] isc_mem_test\r\ntrampoline.c:152: fatal error: trampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\ntrampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\nRUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\n./../../unit-test-driver.sh: line 13: 3117861 Aborted                 (core dumped) \"${TEST_PROGRAM}\"\r\nFAIL mem_test (exit status: 134)\r\n\r\nFAIL: parse_test\r\n================\r\n\r\n[==========] Running 1 test(s).\r\n[ RUN      ] parse_overflow\r\nFAIL parse_test (exit status: 255)\r\n\r\nFAIL: pool_test\r\n===============\r\n\r\n[==========] Running 3 test(s).\r\n[ RUN      ] create_pool\r\nFAIL pool_test (exit status: 255)\r\n\r\nFAIL: radix_test\r\n================\r\n\r\n[==========] Running 1 test(s).\r\n[ RUN      ] isc_radix_search_test\r\nFAIL radix_test (exit status: 255)\r\n\r\nFAIL: random_test\r\n=================\r\n\r\n[==========] Running 16 test(s).\r\n[ RUN      ] isc_random32_monobit\r\n[       OK ] isc_random32_monobit\r\n\u2026\u2026\r\n[ RUN      ] isc_nonce_bytes_binarymatrixrank\r\n[       OK ] isc_nonce_bytes_binarymatrixrank\r\ntrampoline.c:152: fatal error: trampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\ntrampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\nRUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\ntrampoline.c:152: fatal error: RUNTIME_CHECK(((pthread_mutex_lock(((&isc__trampoline_lock))) == 0) ? 0 : 34) == 0) failed\r\n./../../unit-test-driver.sh: line 13: 3120108 Aborted                 (core dumped) \"${TEST_PROGRAM}\"\r\nFAIL random_test (exit status: 134)\r\n\r\nFAIL: sockaddr_test\r\n===================\r\n\r\n[==========] Running 3 test(s).\r\n[ RUN      ] sockaddr_hash\r\nFAIL sockaddr_test (exit status: 255)\r\n\r\nFAIL: socket_test\r\n=================\r\n\r\n[==========] Running 8 test(s).\r\n[ RUN      ] udp_sendto_test\r\nFAIL socket_test (exit status: 255)\r\n\r\nFAIL: symtab_test\r\n=================\r\n\r\n[==========] Running 1 test(s).\r\n[ RUN      ] symtab_grow\r\nFAIL symtab_test (exit status: 255)\r\n\r\nFAIL: task_test\r\n===============\r\n\r\n[==========] Running 14 test(s).\r\n[ RUN      ] manytasks\r\n[       OK ] manytasks\r\n[ RUN      ] all_events\r\nFAIL task_test (exit status: 255)\r\n\r\nFAIL: taskpool_test\r\n===================\r\n\r\n[==========] Running 4 test(s).\r\n[ RUN      ] create_pool\r\nFAIL taskpool_test (exit status: 255)\r\n\r\n",
    "performed_via_github_app": null
}