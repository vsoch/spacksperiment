{
    "url": "https://api.github.com/repos/spack/spack/issues/2868",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/2868/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/2868/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/2868/events",
    "html_url": "https://github.com/spack/spack/pull/2868",
    "id": 201709141,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTAyMTYyMDU5",
    "number": 2868,
    "title": "Adding some fixes to packages that use `configure_args` function without setting spec set or directly referencing it",
    "user": {
        "login": "TheQueasle",
        "id": 13701545,
        "node_id": "MDQ6VXNlcjEzNzAxNTQ1",
        "avatar_url": "https://avatars.githubusercontent.com/u/13701545?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/TheQueasle",
        "html_url": "https://github.com/TheQueasle",
        "followers_url": "https://api.github.com/users/TheQueasle/followers",
        "following_url": "https://api.github.com/users/TheQueasle/following{/other_user}",
        "gists_url": "https://api.github.com/users/TheQueasle/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/TheQueasle/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/TheQueasle/subscriptions",
        "organizations_url": "https://api.github.com/users/TheQueasle/orgs",
        "repos_url": "https://api.github.com/users/TheQueasle/repos",
        "events_url": "https://api.github.com/users/TheQueasle/events{/privacy}",
        "received_events_url": "https://api.github.com/users/TheQueasle/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 475441813,
            "node_id": "MDU6TGFiZWw0NzU0NDE4MTM=",
            "url": "https://api.github.com/repos/spack/spack/labels/autotools",
            "name": "autotools",
            "color": "d93f0b",
            "default": false,
            "description": null
        },
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 446645732,
            "node_id": "MDU6TGFiZWw0NDY2NDU3MzI=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-environment",
            "name": "build-environment",
            "color": "bfdadc",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2017-01-18T22:21:00Z",
    "updated_at": "2017-01-19T14:26:40Z",
    "closed_at": "2017-01-19T14:26:40Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/2868",
        "html_url": "https://github.com/spack/spack/pull/2868",
        "diff_url": "https://github.com/spack/spack/pull/2868.diff",
        "patch_url": "https://github.com/spack/spack/pull/2868.patch"
    },
    "body": "Pulled down a fresh copy of Spack and attempted to install emacs and was met with \"**Error: NameError: global name 'spec' is not defined**\":\r\n```\r\n==> Installing emacs\r\n==> ncurses is already installed in /home/vagrant/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/ncurses-6.0-jfac4tqswyeppf5jphk2lxew7bpqx4z6\r\n==> Using cached archive: /home/vagrant/spack/var/spack/cache/emacs/emacs-25.1.tar.gz\r\n==> Staging archive: /home/vagrant/spack/var/spack/stage/emacs-25.1-k5preh7xr6tciuhbf2t42dj5ennepor5/emacs-25.1.tar.gz\r\n==> Created stage in /home/vagrant/spack/var/spack/stage/emacs-25.1-k5preh7xr6tciuhbf2t42dj5ennepor5\r\n==> Ran patch() for emacs\r\n==> Building emacs [AutotoolsPackage]\r\n==> Executing phase : 'autoreconf'\r\n==> Executing phase : 'configure'\r\n==> Error: NameError: global name 'spec' is not defined\r\n/home/vagrant/spack/var/spack/repos/builtin/packages/emacs/package.py:52, in configure_args:\r\n     50       def configure_args(self):\r\n     51           args = []\r\n  >> 52           toolkit = spec.variants['toolkit'].value\r\n     53           if '+X' in spec:\r\n     54               if toolkit not in ('gtk', 'athena'):\r\n     55                   raise InstallError(\"toolkit must be in (gtk, athena), not %s\" %\r\n     56                                      toolkit)\r\n     57               args = [\r\n     58                   '--with-x',\r\n     59                   '--with-x-toolkit={0}'.format(toolkit)\r\n     60               ]\r\n     61           else:\r\n     62               args = ['--without-x']\r\n     63\r\n     64           return args\r\n\r\nSee build log for details:\r\n  /tmp/vagrant/spack-stage/spack-stage-dWYAqz/emacs-25.1/spack-build.out\r\n```\r\n\r\nAfter a quick search of open issues, I was not able to locate a reference to this.  I did find a similar issue in #2113.\r\n\r\nAfter reading that, it seems there is some conflicting preferences...or at least that's how I read it...on when to use passing `spec` to the `configure_args()` function vs `self.spec` and not passing `spec` to said function.\r\n\r\nI opted for defining `spec` as `self.spec`.",
    "performed_via_github_app": null
}