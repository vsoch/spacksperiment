{
    "url": "https://api.github.com/repos/spack/spack/issues/12796",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/12796/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/12796/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/12796/events",
    "html_url": "https://github.com/spack/spack/issues/12796",
    "id": 492771797,
    "node_id": "MDU6SXNzdWU0OTI3NzE3OTc=",
    "number": 12796,
    "title": "Reduce the verbosity of the 'mirror' command",
    "user": {
        "login": "alalazo",
        "id": 4199709,
        "node_id": "MDQ6VXNlcjQxOTk3MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alalazo",
        "html_url": "https://github.com/alalazo",
        "followers_url": "https://api.github.com/users/alalazo/followers",
        "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
        "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
        "organizations_url": "https://api.github.com/users/alalazo/orgs",
        "repos_url": "https://api.github.com/users/alalazo/repos",
        "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alalazo/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908756,
            "node_id": "MDU6TGFiZWw3MzkwODc1Ng==",
            "url": "https://api.github.com/repos/spack/spack/labels/feature",
            "name": "feature",
            "color": "84b6eb",
            "default": false,
            "description": null
        },
        {
            "id": 466955297,
            "node_id": "MDU6TGFiZWw0NjY5NTUyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/proposal",
            "name": "proposal",
            "color": "0e8a16",
            "default": false,
            "description": null
        },
        {
            "id": 521903170,
            "node_id": "MDU6TGFiZWw1MjE5MDMxNzA=",
            "url": "https://api.github.com/repos/spack/spack/labels/user-experience",
            "name": "user-experience",
            "color": "bfdadc",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2019-09-12T12:24:27Z",
    "updated_at": "2019-09-12T12:24:27Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "Most of the times the `spack mirror` command is too verbose. This is a proposal to reduce the number of messages displayed by default and demote most of the current ones to debug level.\r\n\r\n### Rationale\r\n\r\nAs an example I'll post what happens when a user tries to update a mirror with a few tarballs already in:\r\n```console\r\n$ spack mirror create -d /home/mculpo/production/mirror -D hdf5+mpi ^mpich\r\n==> Adding package perl@5.26.2 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/perl/perl-5.26.2.tar.gz\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/perl/cpanm-5.26.2.tar.gz\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/perl/perl-5.26.1-guard_old_libcrypt_fix.patch\r\n==> Adding package xz@5.2.4 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/xz/xz-5.2.4.tar.bz2\r\n==> Adding package mpich@3.3.1 to mirror\r\n==> Fetching file:///home/mculpo/production/mirror/mpich/mpich-3.3.1.tar.gz\r\ncurl: (37) Couldn't open file /home/mculpo/production/mirror/mpich/mpich-3.3.1.tar.gz\r\n==> Fetching from file:///home/mculpo/production/mirror/mpich/mpich-3.3.1.tar.gz failed.\r\n==> Fetching file:///home/mculpo/production/binary-mirror/mpich/mpich-3.3.1.tar.gz\r\ncurl: (37) Couldn't open file /home/mculpo/production/binary-mirror/mpich/mpich-3.3.1.tar.gz\r\n==> Fetching from file:///home/mculpo/production/binary-mirror/mpich/mpich-3.3.1.tar.gz failed.\r\n==> Fetching http://www.mpich.org/static/downloads/3.3.1/mpich-3.3.1.tar.gz\r\n######################################################################## 100,0%\r\n==> Adding package ncurses@6.1 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/ncurses/ncurses-6.1.tar.gz\r\n==> Adding package libszip@2.1.1 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/libszip/libszip-2.1.1.tar.gz\r\n==> Adding package hdf5@1.10.5 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/hdf5/hdf5-1.10.5.tar.gz\r\n==> Adding package autoconf@2.69 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/autoconf/autoconf-2.69.tar.gz\r\n==> Adding package libtool@2.4.6 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/libtool/libtool-2.4.6.tar.gz\r\n==> Adding package pkg-config@0.29.2 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/pkg-config/pkg-config-0.29.2.tar.gz\r\n==> Adding package readline@7.0 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/readline/readline-7.0.tar.gz\r\n==> Adding package libxml2@2.9.9 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/libxml2/libxml2-2.9.9.tar.gz\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/libxml2/xmlts-2.9.9.tar.gz\r\n==> Adding package zlib@1.2.11 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/zlib/zlib-1.2.11.tar.gz\r\n==> Adding package m4@1.4.18 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/m4/m4-1.4.18.tar.gz\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/m4/m4-1.4.18-glibc-change-work-around.patch\r\n==> Adding package libsigsegv@2.11 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/libsigsegv/libsigsegv-2.11.tar.gz\r\n==> Adding package libiconv@1.15 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/libiconv/libiconv-1.15.tar.gz\r\n==> Adding package libpciaccess@0.13.5 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/libpciaccess/libpciaccess-0.13.5.tar.gz\r\n==> Adding package findutils@4.6.0 to mirror\r\n==> Fetching file:///home/mculpo/production/mirror/findutils/findutils-4.6.0.tar.gz\r\ncurl: (37) Couldn't open file /home/mculpo/production/mirror/findutils/findutils-4.6.0.tar.gz\r\n==> Fetching from file:///home/mculpo/production/mirror/findutils/findutils-4.6.0.tar.gz failed.\r\n==> Fetching file:///home/mculpo/production/binary-mirror/findutils/findutils-4.6.0.tar.gz\r\ncurl: (37) Couldn't open file /home/mculpo/production/binary-mirror/findutils/findutils-4.6.0.tar.gz\r\n==> Fetching from file:///home/mculpo/production/binary-mirror/findutils/findutils-4.6.0.tar.gz failed.\r\n==> Fetching https://ftpmirror.gnu.org/findutils/findutils-4.6.0.tar.gz\r\n######################################################################## 100,0%\r\n==> Fetching file:///home/mculpo/production/mirror/findutils/findutils-4.6.0-gnulib-fflush.patch\r\ncurl: (37) Couldn't open file /home/mculpo/production/mirror/findutils/findutils-4.6.0-gnulib-fflush.patch\r\n==> Fetching from file:///home/mculpo/production/mirror/findutils/findutils-4.6.0-gnulib-fflush.patch failed.\r\n==> Fetching file:///home/mculpo/production/binary-mirror/findutils/findutils-4.6.0-gnulib-fflush.patch\r\ncurl: (37) Couldn't open file /home/mculpo/production/binary-mirror/findutils/findutils-4.6.0-gnulib-fflush.patch\r\n==> Fetching from file:///home/mculpo/production/binary-mirror/findutils/findutils-4.6.0-gnulib-fflush.patch failed.\r\n==> Fetching https://src.fedoraproject.org/rpms/findutils/raw/97ba2d7a18d1f9ae761b6ff0b4f1c4d33d7a8efc/f/findutils-4.6.0-gnulib-fflush.patch\r\n######################################################################## 100,0%\r\n==> Fetching file:///home/mculpo/production/mirror/findutils/findutils-4.6.0-gnulib-makedev.patch\r\ncurl: (37) Couldn't open file /home/mculpo/production/mirror/findutils/findutils-4.6.0-gnulib-makedev.patch\r\n==> Fetching from file:///home/mculpo/production/mirror/findutils/findutils-4.6.0-gnulib-makedev.patch failed.\r\n==> Fetching file:///home/mculpo/production/binary-mirror/findutils/findutils-4.6.0-gnulib-makedev.patch\r\ncurl: (37) Couldn't open file /home/mculpo/production/binary-mirror/findutils/findutils-4.6.0-gnulib-makedev.patch\r\n==> Fetching from file:///home/mculpo/production/binary-mirror/findutils/findutils-4.6.0-gnulib-makedev.patch failed.\r\n==> Fetching https://src.fedoraproject.org/rpms/findutils/raw/97ba2d7a18d1f9ae761b6ff0b4f1c4d33d7a8efc/f/findutils-4.6.0-gnulib-makedev.patch\r\n######################################################################## 100,0%\r\n==> Adding package texinfo@6.5 to mirror\r\n==> Fetching file:///home/mculpo/production/mirror/texinfo/texinfo-6.5.tar.gz\r\ncurl: (37) Couldn't open file /home/mculpo/production/mirror/texinfo/texinfo-6.5.tar.gz\r\n==> Fetching from file:///home/mculpo/production/mirror/texinfo/texinfo-6.5.tar.gz failed.\r\n==> Fetching file:///home/mculpo/production/binary-mirror/texinfo/texinfo-6.5.tar.gz\r\ncurl: (37) Couldn't open file /home/mculpo/production/binary-mirror/texinfo/texinfo-6.5.tar.gz\r\n==> Fetching from file:///home/mculpo/production/binary-mirror/texinfo/texinfo-6.5.tar.gz failed.\r\n==> Fetching https://ftpmirror.gnu.org/texinfo/texinfo-6.5.tar.gz\r\n######################################################################## 100,0%\r\n==> Adding package util-macros@1.19.1 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/util-macros/util-macros-1.19.1.tar.bz2\r\n==> Adding package automake@1.16.1 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/automake/automake-1.16.1.tar.gz\r\n==> Adding package gdbm@1.18.1 to mirror\r\n==> Using cached archive: /home/mculpo/github/spack/var/spack/cache/gdbm/gdbm-1.18.1.tar.gz\r\n==> Successfully updated mirror in /home/mculpo/production/mirror\r\n  Archive stats:\r\n    22   already present\r\n    5    added\r\n    0    failed to fetch.\r\n```\r\nIt's basically a wall of text to download 5 tarballs.\r\n\r\n### Description\r\n\r\nWhat I'd like to see is instead something like:\r\n```console\r\n$ spack mirror create -d /home/mculpo/production/mirror -D hdf5+mpi ^mpich\r\n==> Computing source tarballs to be fetched: mpich@3.3.1, texinfo@6.5, findutils@4.6.0\r\n==> Fetching source tarballs\r\n\r\n  mpich@3.3.1    ########## 100%\r\n  texinfo@6.5    ########## 100%\r\n  findutils@4.6.0\r\n    sources      ########## 100%\r\n    patch-1      ########## 100%\r\n    patch-2      ########## 100%\r\n\r\n==> Updated mirror in /home/mculpo/production/mirror\r\n  Archive stats:\r\n    22   already present\r\n    5    added\r\n    0    failed to fetch.\r\n```\r\nOff the top of my head I would probably just demote most of the current messages from `tty.msg` to `tty.debug`.\r\n\r\n### Additional information\r\nI think `spack mirror` might not be the only command that deserves some review in the default output level.\r\n",
    "performed_via_github_app": null
}