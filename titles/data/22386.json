{
    "url": "https://api.github.com/repos/spack/spack/issues/22386",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/22386/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/22386/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/22386/events",
    "html_url": "https://github.com/spack/spack/issues/22386",
    "id": 835091678,
    "node_id": "MDU6SXNzdWU4MzUwOTE2Nzg=",
    "number": 22386,
    "title": "Conflict between processes sharing common stage directory",
    "user": {
        "login": "G-Ragghianti",
        "id": 33492707,
        "node_id": "MDQ6VXNlcjMzNDkyNzA3",
        "avatar_url": "https://avatars.githubusercontent.com/u/33492707?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/G-Ragghianti",
        "html_url": "https://github.com/G-Ragghianti",
        "followers_url": "https://api.github.com/users/G-Ragghianti/followers",
        "following_url": "https://api.github.com/users/G-Ragghianti/following{/other_user}",
        "gists_url": "https://api.github.com/users/G-Ragghianti/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/G-Ragghianti/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/G-Ragghianti/subscriptions",
        "organizations_url": "https://api.github.com/users/G-Ragghianti/orgs",
        "repos_url": "https://api.github.com/users/G-Ragghianti/repos",
        "events_url": "https://api.github.com/users/G-Ragghianti/events{/privacy}",
        "received_events_url": "https://api.github.com/users/G-Ragghianti/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 11,
    "created_at": "2021-03-18T17:43:28Z",
    "updated_at": "2021-03-26T15:48:32Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "We recently started seeing what appears to be a conflict between spack processes of a user on the same host when they are building the same package.  This occurs in our CI system a lot.  The common stage directory will have the same directory name for a package's staged files so that when one process deletes the stage directory, it breaks the second process's build.  This occurs even when using separate spack installs. I'm going to be looking into a workaround by setting a custom stage directory, but I think the default should be to have a stage directory that is unique to the spack install. Thoughts?\r\n\r\nReproducing: Create two spack installs on the same host and run \"spack install xz\" on each at the same time.  You'll get various errors due to the conflict.\r\n\r\nIf it is agreed that a unique stage directory is desirable, I'm happy to create the patch.\r\n\r\nAlternatively, the locking functionality could be slightly extended to work across separate spack installs (on the same system).",
    "performed_via_github_app": null
}