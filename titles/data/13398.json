{
    "url": "https://api.github.com/repos/spack/spack/issues/13398",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/13398/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/13398/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/13398/events",
    "html_url": "https://github.com/spack/spack/issues/13398",
    "id": 511342991,
    "node_id": "MDU6SXNzdWU1MTEzNDI5OTE=",
    "number": 13398,
    "title": "gcc: build issue on aarch64",
    "user": {
        "login": "lee218llnl",
        "id": 3641995,
        "node_id": "MDQ6VXNlcjM2NDE5OTU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3641995?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lee218llnl",
        "html_url": "https://github.com/lee218llnl",
        "followers_url": "https://api.github.com/users/lee218llnl/followers",
        "following_url": "https://api.github.com/users/lee218llnl/following{/other_user}",
        "gists_url": "https://api.github.com/users/lee218llnl/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lee218llnl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lee218llnl/subscriptions",
        "organizations_url": "https://api.github.com/users/lee218llnl/orgs",
        "repos_url": "https://api.github.com/users/lee218llnl/repos",
        "events_url": "https://api.github.com/users/lee218llnl/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lee218llnl/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 512483390,
            "node_id": "MDU6TGFiZWw1MTI0ODMzOTA=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-medium",
            "name": "impact-medium",
            "color": "fef2c0",
            "default": false,
            "description": ""
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "becker33",
        "id": 13971568,
        "node_id": "MDQ6VXNlcjEzOTcxNTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/13971568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/becker33",
        "html_url": "https://github.com/becker33",
        "followers_url": "https://api.github.com/users/becker33/followers",
        "following_url": "https://api.github.com/users/becker33/following{/other_user}",
        "gists_url": "https://api.github.com/users/becker33/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/becker33/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/becker33/subscriptions",
        "organizations_url": "https://api.github.com/users/becker33/orgs",
        "repos_url": "https://api.github.com/users/becker33/repos",
        "events_url": "https://api.github.com/users/becker33/events{/privacy}",
        "received_events_url": "https://api.github.com/users/becker33/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "becker33",
            "id": 13971568,
            "node_id": "MDQ6VXNlcjEzOTcxNTY4",
            "avatar_url": "https://avatars.githubusercontent.com/u/13971568?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/becker33",
            "html_url": "https://github.com/becker33",
            "followers_url": "https://api.github.com/users/becker33/followers",
            "following_url": "https://api.github.com/users/becker33/following{/other_user}",
            "gists_url": "https://api.github.com/users/becker33/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/becker33/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/becker33/subscriptions",
            "organizations_url": "https://api.github.com/users/becker33/orgs",
            "repos_url": "https://api.github.com/users/becker33/repos",
            "events_url": "https://api.github.com/users/becker33/events{/privacy}",
            "received_events_url": "https://api.github.com/users/becker33/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 4,
    "created_at": "2019-10-23T13:58:22Z",
    "updated_at": "2020-06-27T23:51:12Z",
    "closed_at": "2020-06-27T23:51:12Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Spack is failing to build gcc on ARM systems using our side-installed gcc compilers:\r\n\r\n[lee218@ulna2:spack-gcc-arm]$ ./bin/spack install --keep-stage gcc@9.2.0%gcc@7.3 \r\n\r\n...\r\n\r\n  >> 10226    /tmp/lee218/spack-stage/spack-stage-gcc-9.2.0-fm7js2yexc7zo54qv54\r\n              jjanbxft5jorq/spack-src/spack-build/./gcc/cc1: error while loadin\r\n              g shared libraries: libisl.so.19: cannot open shared object file:\r\n               No such file or directory\r\n\r\nOn our ARM systems, the side-installed gcc compiler (i.e., /opt/rh/devtoolset-7/root/bin/gcc ) hardcodes LD as /opt/rh/devtoolset-7/root/usr/libexec/gcc/aarch64-redhat-linux/7/ld. This is found by configure when running gcc -print-prog-name=ld:\r\n \r\n[lee218@ulna2:spack-src]$ /opt/rh/devtoolset-7/root/bin/gcc -print-prog-name=ld\r\n/opt/rh/devtoolset-7/root/usr/libexec/gcc/aarch64-redhat-linux/7/ld\r\n \r\nEffectively, this finds anything in the in th/opt/rh/devtoolset-7/root/usr/libexec/gcc/aarch64-redhat-linux/7 directory and will print the full path, otherwise, it will just echo the \u201c-print-prog-name\u201d value:\r\n \r\n[lee218@ulna2:spack-src]$ /opt/rh/devtoolset-7/root/bin/gcc -print-prog-name=blahblahblah\r\nblahblahblah\r\n \r\nWith most of our other gcc builds (on x86 systems, /usr/bin/gcc on x86 and arm, spack-built gcc, etc.), the search directory does not contain ld and thus the command just prints \u201cld\u201d and effectively uses Spack\u2019s wrapper and gets the necessary rpaths for libisl.so.\r\n\r\nThis method of finding ld is in gcc's configure script, so one solution may be to add a patch that modifies the configure script to avoid using the full-path ld and just use ld instead. I'm not sure if there are any unintended consequences. It's also not clear to me at this point whether other configure scripts do similar things and thus merits a more general solution.\r\n",
    "performed_via_github_app": null
}