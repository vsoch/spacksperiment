{
    "url": "https://api.github.com/repos/spack/spack/issues/18749",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/18749/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/18749/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/18749/events",
    "html_url": "https://github.com/spack/spack/issues/18749",
    "id": 704671336,
    "node_id": "MDU6SXNzdWU3MDQ2NzEzMzY=",
    "number": 18749,
    "title": "Installation issue: python@3.8.5 with shared library",
    "user": {
        "login": "Char-Aznable",
        "id": 32589713,
        "node_id": "MDQ6VXNlcjMyNTg5NzEz",
        "avatar_url": "https://avatars.githubusercontent.com/u/32589713?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Char-Aznable",
        "html_url": "https://github.com/Char-Aznable",
        "followers_url": "https://api.github.com/users/Char-Aznable/followers",
        "following_url": "https://api.github.com/users/Char-Aznable/following{/other_user}",
        "gists_url": "https://api.github.com/users/Char-Aznable/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Char-Aznable/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Char-Aznable/subscriptions",
        "organizations_url": "https://api.github.com/users/Char-Aznable/orgs",
        "repos_url": "https://api.github.com/users/Char-Aznable/repos",
        "events_url": "https://api.github.com/users/Char-Aznable/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Char-Aznable/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 446619758,
            "node_id": "MDU6TGFiZWw0NDY2MTk3NTg=",
            "url": "https://api.github.com/repos/spack/spack/labels/python",
            "name": "python",
            "color": "c2e0c6",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-09-18T21:36:12Z",
    "updated_at": "2020-09-19T02:34:41Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "<!-- Thanks for taking the time to report this build failure. To proceed with the report please:\r\n\r\n1. Title the issue \"Installation issue: <name-of-the-package>\".\r\n2. Provide the information required below.\r\n\r\nWe encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively! -->\r\n\r\n### Steps to reproduce the issue\r\n\r\n<!-- Fill in the exact spec you are trying to build and the relevant part of the error message -->\r\n```console\r\n$ spack install python@3.8.5+optimizations+tkinter cflags=\"-O3\" cppflags=\"-O3\"\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n* **Spack:** 0.15.4-1022-80fe51046\r\n* **Python:** 3.8.5\r\n* **Platform:** linux-centos7-haswell\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\npackages.yaml:\r\n```\r\npackages:\r\n  all:\r\n    compiler: [gcc@9.3.0, clang@10.0.1]\r\n    providers:\r\n      D: [ldc]\r\n      awk: [gawk]\r\n      blas: [openblas]\r\n      daal: [intel-daal]\r\n      elf: [elfutils]\r\n      fftw-api: [fftw]\r\n      gl: [mesa+opengl, opengl]\r\n      glx: [mesa+glx, opengl]\r\n      glu: [mesa-glu, openglu]\r\n      golang: [gcc]\r\n      ipp: [intel-ipp]\r\n      java: [openjdk, jdk, ibm-java]\r\n      jpeg: [libjpeg-turbo, libjpeg]\r\n      lapack: [openblas]\r\n      mariadb-client: [mariadb-c-client, mariadb]\r\n      mkl: [intel-mkl]\r\n      mpe: [mpe2]\r\n      mpi: [openmpi, mpich]\r\n      mysql-client: [mysql, mariadb-c-client]\r\n      opencl: [pocl]\r\n      pil: [py-pillow]\r\n      pkgconfig: [pkgconf, pkg-config]\r\n      scalapack: [netlib-scalapack]\r\n      szip: [libszip, libaec]\r\n      tbb: [intel-tbb]\r\n      unwind: [libunwind]\r\n    permissions:\r\n      read: world\r\n      write: user\r\n```\r\n\r\n### Additional information\r\n\r\n<!-- Please upload the following files. They should be present in the stage directory of the failing build. Also upload any config.log or similar file if one exists. -->\r\nThis is the relevant error message in the build log:\r\n```\r\n/home/aznable/spack/lib/spack/env/gcc/gcc -pthread -shared -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/gettext-0.21-55mhwod6a63ps4ottclomuy72an57his/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/readline-8.0-vlftkqsvkinigldvkpkwgqtsy7ulmycn/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/ncurses-6.2-ccpvja4f5mz6aw7ioz5u7ihdrxbugyzf/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/openssl-1.1.1g-jfooumullita6g74ujk5jgatwvhl7bea/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/sqlite-3.33.0-kgquxoe5whn75qbpfra54ydgoaweu3of/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/gdbm-1.18.1-yfizpfmx2nghsdmhdvxnl7y6drdbkxq7/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/zlib-1.2.11-gfes7f35rppowsinvimnaheom23qbs55/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/bzip2-1.0.8-mlz6pdrikglamnlrn55am5uvxl4xu6lz/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/xz-5.2.5-ou6sagf3ii3lp76leopjcl2kixnz27t5/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/expat-2.2.9-sue4c2adf3iqpbhs573xx4e4rqt2ugmy/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/libffi-3.3-cb3hqvbkpmzm7lt5teoc47243vjdbdxm/lib64 -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/tk-8.6.8-hdasonb3ps5wj22vrvpa2tbf6rpn2myt/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/tcl-8.6.10-xdusiasvah27lmkrbo3qfwuzlnecmdwn/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/libuuid-1.0.3-aaommvjgyqtanujnrt4ksjckrysm3lcn/lib   -fprofile-generate -Wl,--no-as-needed -o libpython3.so -Wl,-hlibpython3.so libpython3.8.so\r\n/home/aznable/spack/lib/spack/env/gcc/gcc -pthread -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/gettext-0.21-55mhwod6a63ps4ottclomuy72an57his/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/readline-8.0-vlftkqsvkinigldvkpkwgqtsy7ulmycn/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/ncurses-6.2-ccpvja4f5mz6aw7ioz5u7ihdrxbugyzf/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/openssl-1.1.1g-jfooumullita6g74ujk5jgatwvhl7bea/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/sqlite-3.33.0-kgquxoe5whn75qbpfra54ydgoaweu3of/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/gdbm-1.18.1-yfizpfmx2nghsdmhdvxnl7y6drdbkxq7/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/zlib-1.2.11-gfes7f35rppowsinvimnaheom23qbs55/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/bzip2-1.0.8-mlz6pdrikglamnlrn55am5uvxl4xu6lz/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/xz-5.2.5-ou6sagf3ii3lp76leopjcl2kixnz27t5/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/expat-2.2.9-sue4c2adf3iqpbhs573xx4e4rqt2ugmy/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/libffi-3.3-cb3hqvbkpmzm7lt5teoc47243vjdbdxm/lib64 -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/tk-8.6.8-hdasonb3ps5wj22vrvpa2tbf6rpn2myt/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/tcl-8.6.10-xdusiasvah27lmkrbo3qfwuzlnecmdwn/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/libuuid-1.0.3-aaommvjgyqtanujnrt4ksjckrysm3lcn/lib   -fprofile-generate -Xlinker -export-dynamic -o python Programs/python.o -L. -lpython3.8 -lcrypt -lintl -lpthread -ldl  -lutil -lm   -lm \r\n/home/aznable/spack/lib/spack/env/gcc/gcc -pthread -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/gettext-0.21-55mhwod6a63ps4ottclomuy72an57his/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/readline-8.0-vlftkqsvkinigldvkpkwgqtsy7ulmycn/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/ncurses-6.2-ccpvja4f5mz6aw7ioz5u7ihdrxbugyzf/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/openssl-1.1.1g-jfooumullita6g74ujk5jgatwvhl7bea/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/sqlite-3.33.0-kgquxoe5whn75qbpfra54ydgoaweu3of/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/gdbm-1.18.1-yfizpfmx2nghsdmhdvxnl7y6drdbkxq7/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/zlib-1.2.11-gfes7f35rppowsinvimnaheom23qbs55/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/bzip2-1.0.8-mlz6pdrikglamnlrn55am5uvxl4xu6lz/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/xz-5.2.5-ou6sagf3ii3lp76leopjcl2kixnz27t5/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/expat-2.2.9-sue4c2adf3iqpbhs573xx4e4rqt2ugmy/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/libffi-3.3-cb3hqvbkpmzm7lt5teoc47243vjdbdxm/lib64 -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/tk-8.6.8-hdasonb3ps5wj22vrvpa2tbf6rpn2myt/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/tcl-8.6.10-xdusiasvah27lmkrbo3qfwuzlnecmdwn/lib -L/home/aznable/spack/opt/spack/linux-centos7-haswell/gcc-9.3.0/libuuid-1.0.3-aaommvjgyqtanujnrt4ksjckrysm3lcn/lib   -fprofile-generate -Xlinker -export-dynamic -o Programs/_testembed Programs/_testembed.o -L. -lpython3.8 -lcrypt -lintl -lpthread -ldl  -lutil -lm   -lm \r\nLD_LIBRARY_PATH=/data/scratch/ssd/tmp/188620345.1.login.q/aznable/spack-stage/spack-stage-python-3.8.5-la275lvn6kira5qdx5vr7b2vq54lzofe/spack-src/spack-build ./python -E -S -m sysconfig --generate-posix-vars ;\\\r\nif test $? -ne 0 ; then \\\r\n        echo \"generate-posix-vars failed\" ; \\\r\n        rm -f ./pybuilddir.txt ; \\\r\n        exit 1 ; \\\r\nfi\r\n./python: symbol lookup error: ./python: undefined symbol: __gcov_indirect_call\r\n```\r\n<!-- Some packages have maintainers who have volunteered to debug build failures. Run `spack maintainers <name-of-the-package>` and @mention them here if they exist. -->\r\n@adamjstewart \r\n\r\n### General information\r\nTurns out the problem is that the compiled python executable /data/scratch/ssd/tmp/188620345.1.login.q/aznable/spack-stage/spack-stage-python-3.8.5-la275lvn6kira5qdx5vr7b2vq54lzofe/spack-src/spack-build/python has picked up a wrong version of libpython38.so in my home directory rather than the one in the same build directory. I think spack should do some environment santization at build time the prune away paths that are not part of the spack built package hiearchy.\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "performed_via_github_app": null
}