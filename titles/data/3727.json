{
    "url": "https://api.github.com/repos/spack/spack/issues/3727",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/3727/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/3727/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/3727/events",
    "html_url": "https://github.com/spack/spack/issues/3727",
    "id": 219876799,
    "node_id": "MDU6SXNzdWUyMTk4NzY3OTk=",
    "number": 3727,
    "title": "bash@4.3 ^readline@7.0 gives error: ",
    "user": {
        "login": "samfux84",
        "id": 11944875,
        "node_id": "MDQ6VXNlcjExOTQ0ODc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/11944875?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/samfux84",
        "html_url": "https://github.com/samfux84",
        "followers_url": "https://api.github.com/users/samfux84/followers",
        "following_url": "https://api.github.com/users/samfux84/following{/other_user}",
        "gists_url": "https://api.github.com/users/samfux84/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/samfux84/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/samfux84/subscriptions",
        "organizations_url": "https://api.github.com/users/samfux84/orgs",
        "repos_url": "https://api.github.com/users/samfux84/repos",
        "events_url": "https://api.github.com/users/samfux84/events{/privacy}",
        "received_events_url": "https://api.github.com/users/samfux84/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2017-04-06T12:05:38Z",
    "updated_at": "2017-04-07T13:43:14Z",
    "closed_at": "2017-04-07T13:43:14Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I am using the development branch + PR: 2548, 2972\r\n\r\n```\r\n[sfux@develop02 tools]$ spack find\r\n==> 35 installed packages.\r\n-- linux-centos7-x86_64 / gcc@4.8.5 -----------------------------\r\nautoconf@2.69  coreutils@8.26  font-util@1.3.1  libpng@1.6.27       lua@5.3.2            ncurses@6.0   perl@5.24.1        tcl@8.6.6           xz@5.2.3\r\nautomake@1.15  curl@7.53.1     freetype@2.7     libsigsegv@2.11     lua-luaposix@33.4.0  patch@2.7.5   pkg-config@0.29.2  unzip@6.0           yasm@1.3.0\r\nbison@3.0.4    dbus@1.11.2     libelf@0.8.13    libtool@2.4.6       m4@1.4.18            patchelf@0.9  readline@7.0       util-macros@1.19.1  zlib@1.2.11\r\nbzip2@1.0.6    expat@2.2.0     libiconv@1.15    libunistring@0.9.7  mawk@1.3.4           pcre@8.40     tar@1.29           wget@1.17\r\n```\r\n\r\n```\r\n[sfux@develop02 tools]$ spack install bash@4.3 ^readline@7.0\r\n==> Installing bash\r\n==> readline is already installed in /local/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/readline-7.0-p5j542rky6ftmlge27u2fk3m5hsbqn2w\r\n==> Fetching https://ftp.gnu.org/gnu/bash/bash-4.3.tar.gz\r\n######################################################################## 100.0%\r\n==> Staging archive: /local/cluster/spack/var/spack/stage/bash-4.3-hes7gbusu3hidnr6lwav6injj6b4gi3g/bash-4.3.tar.gz\r\n==> Created stage in /local/cluster/spack/var/spack/stage/bash-4.3-hes7gbusu3hidnr6lwav6injj6b4gi3g\r\n==> Ran patch() for bash\r\n==> Building bash [Package]\r\n==> Executing phase : 'install'\r\n==> Error: ProcessError: Command exited with status 2:\r\n```\r\n```\r\n\r\n/local/cluster/spack/lib/spack/env/gcc/gcc -L./builtins -L./lib/readline -L./lib/readline -L./lib/glob -L./lib/tilde -L./lib/malloc -L./lib/sh  -rdynamic  -g -O2 -o bash shell.o eval.o y.tab.o general.o make_cmd.o print_cmd.o  dispose_cmd.o execute_cmd.o variables.o copy_cmd.o error.o expr.o flags.o jobs.o subst.o hashcmd.o hashlib.o mailcheck.o trap.o input.o unwind_prot.o pathexp.o sig.o test.o version.o alias.o array.o arrayfunc.o assoc.o braces.o bracecomp.o bashhist.o bashline.o  list.o stringlib.o locale.o findcmd.o redir.o pcomplete.o pcomplib.o syntax.o xmalloc.o  -lbuiltins -lglob -lsh -lreadline -lhistory -lcurses -ltilde -lmalloc    -ldl\r\n/usr/bin/ld: cannot find -lcurses\r\ncollect2: error: ld returned 1 exit status\r\n```\r\n\r\nbash spec:\r\n\r\n```\r\n    def install(self, spec, prefix):\r\n        configure('--prefix=%s' % prefix,\r\n                  '--with-curses',\r\n                  '--with-installed-readline=%s' % spec['readline'].prefix)\r\n```\r\n\r\nIt seems that the configure script ignores the specified readline:\r\n\r\n```\r\nchecking for tgetent... no\r\nchecking for tgetent in -ltermcap... no\r\nchecking for tgetent in -ltinfo... no\r\nchecking for tgetent in -lcurses... no\r\nchecking for tgetent in -lncurses... no\r\nchecking which library has the termcap functions... using gnutermcap\r\nchecking version of installed readline library... configure: WARNING: Could not test version of installed readline library.\r\nconfigure: WARNING: installed readline library is too old to be linked with bash\r\nconfigure: WARNING: using private bash version\r\n```\r\n\r\nconfig.log:\r\n```\r\n\r\nconfigure:5252: checking version of installed readline library\r\nconfigure:5306: /local/cluster/spack/lib/spack/env/gcc/gcc -o conftest -g -O2 -I/local/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/readline-7.0-p5j542rky6ftmlge27u2fk3m5hsbqn2w/include   -L/local/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/readline-7.0-p5j542rky6ftmlge27u2fk3m5hsbqn2w/lib conftest.c  -lreadline -lcurses >&5\r\nconftest.c: In function 'main':\r\nconftest.c:60:3: warning: incompatible implicit declaration of built-in function 'exit' [enabled by default]\r\n   exit(1);\r\n   ^\r\n/usr/bin/ld: cannot find -lcurses\r\ncollect2: error: ld returned 1 exit status\r\nconfigure:5306: $? = 1\r\nconfigure: program exited with status 1\r\nconfigure: failed program was:\r\n| /* confdefs.h */\r\n| #define PACKAGE_NAME \"bash\"\r\n| #define PACKAGE_TARNAME \"bash\"\r\n| #define PACKAGE_VERSION \"4.3-release\"\r\n| #define PACKAGE_STRING \"bash 4.3-release\"\r\n| #define PACKAGE_BUGREPORT \"bug-bash@gnu.org\"\r\n| #define PACKAGE_URL \"\"\r\n| #define USING_BASH_MALLOC 1\r\n| #define ALIAS 1\r\n| #define PUSHD_AND_POPD 1\r\n| #define RESTRICTED_SHELL 1\r\n| #define PROCESS_SUBSTITUTION 1\r\n| #define PROMPT_STRING_DECODE 1\r\n| #define SELECT_COMMAND 1\r\n| #define HELP_BUILTIN 1\r\n| #define ARRAY_VARS 1\r\n| #define DPAREN_ARITHMETIC 1\r\n| #define BRACE_EXPANSION 1\r\n| #define COMMAND_TIMING 1\r\n| #define EXTENDED_GLOB 1\r\n| #define EXTGLOB_DEFAULT 0\r\n| #define COND_COMMAND 1\r\n| #define COND_REGEXP 1\r\n| #define COPROCESS_SUPPORT 1\r\n| #define ARITH_FOR_COMMAND 1\r\n| #define NETWORK_REDIRECTIONS 1\r\n| #define PROGRAMMABLE_COMPLETION 1\r\n| #define DEBUGGER 1\r\n| #define CASEMOD_ATTRS 1\r\n| #define CASEMOD_EXPANSIONS 1\r\n| #define GLOBASCII_DEFAULT 0\r\n| #define MEMSCRAMBLE 1\r\n| #define STDC_HEADERS 1\r\n| #define HAVE_SYS_TYPES_H 1\r\n| #define HAVE_SYS_STAT_H 1\r\n| #define HAVE_STDLIB_H 1\r\n| #define HAVE_STRING_H 1\r\n| #define HAVE_MEMORY_H 1\r\n| #define HAVE_STRINGS_H 1\r\n| #define HAVE_INTTYPES_H 1\r\n| #define HAVE_STDINT_H 1\r\n| #define HAVE_UNISTD_H 1\r\n| #define __EXTENSIONS__ 1\r\n| #define _ALL_SOURCE 1\r\n| #define _GNU_SOURCE 1\r\n| #define _POSIX_PTHREAD_SEMANTICS 1\r\n| #define _TANDEM_SOURCE 1\r\n| /* end confdefs.h.  */\r\n| \r\n| #include <stdio.h>\r\n| #include <readline/readline.h>\r\n| \r\n| extern int rl_gnu_readline_p;\r\n| \r\n| main()\r\n| {\r\n|       FILE *fp;\r\n|       fp = fopen(\"conftest.rlv\", \"w\");\r\n|       if (fp == 0)\r\n|               exit(1);\r\n|       if (rl_gnu_readline_p != 1)\r\n|               fprintf(fp, \"0.0\\n\");\r\n|       else\r\n|               fprintf(fp, \"%s\\n\", rl_library_version ? rl_library_version : \"0.0\");\r\n|       fclose(fp);\r\n|       exit(0);\r\n| }\r\n| \r\nconfigure:5352: WARNING: Could not test version of installed readline library.\r\nconfigure:5397: WARNING: installed readline library is too old to be linked with bash\r\nconfigure:5399: WARNING: using private bash version\r\nconfigure:5503: checking for a BSD-compatible install\r\n```\r\n\r\nAny idea ?\r\n\r\nShould bash have a dependency ncurses, since it the speck contains the option --with-curses, or do you think it is because the readline library that is linked against ncurses is not recognized ?\r\n\r\nBest regards\r\n\r\nSam",
    "performed_via_github_app": null
}