{
    "url": "https://api.github.com/repos/spack/spack/issues/22593",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/22593/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/22593/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/22593/events",
    "html_url": "https://github.com/spack/spack/issues/22593",
    "id": 842423691,
    "node_id": "MDU6SXNzdWU4NDI0MjM2OTE=",
    "number": 22593,
    "title": "libtermkey fails to build on macOS",
    "user": {
        "login": "certik",
        "id": 20568,
        "node_id": "MDQ6VXNlcjIwNTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/20568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/certik",
        "html_url": "https://github.com/certik",
        "followers_url": "https://api.github.com/users/certik/followers",
        "following_url": "https://api.github.com/users/certik/following{/other_user}",
        "gists_url": "https://api.github.com/users/certik/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/certik/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/certik/subscriptions",
        "organizations_url": "https://api.github.com/users/certik/orgs",
        "repos_url": "https://api.github.com/users/certik/repos",
        "events_url": "https://api.github.com/users/certik/events{/privacy}",
        "received_events_url": "https://api.github.com/users/certik/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-03-27T05:36:16Z",
    "updated_at": "2021-03-27T05:36:16Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "This came up for `spack install -j8 neovim`.\r\n\r\n```\r\n==> Installing libtermkey-0.18-jjb4nvom4y76lj6ukkez4y26cf2rttue\r\n==> No binary for libtermkey-0.18-jjb4nvom4y76lj6ukkez4y26cf2rttue found: installing from source\r\n==> Fetching https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/_source-cache/archive/23/239746de41c845af52bb3c14055558f743292dd6c24ac26c2d6567a5a6093926.tar.gz\r\n######################################################################### 100.0%\r\n==> No patches needed for libtermkey\r\n==> libtermkey: Executing phase: 'install'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j8'\r\n\r\n6 errors found in build log:\r\n     9     glibtool --quiet --mode=compile --tag=CC /Users/certik/repos/spack/l\r\n           ib/spack/env/clang/clang -Wall -std=c99 -o driver-ti.lo -c driver-ti\r\n           .c\r\n     10    glibtool --quiet --mode=compile --tag=CC /Users/certik/repos/spack/l\r\n           ib/spack/env/clang/clang -Wall -std=c99 -o demo.lo -c demo.c\r\n     11    glibtool --quiet --mode=compile --tag=CC /Users/certik/repos/spack/l\r\n           ib/spack/env/clang/clang -Wall -std=c99 -o demo-async.lo -c demo-asy\r\n           nc.c\r\n     12    glibtool --quiet --mode=link --tag=CC /Users/certik/repos/spack/lib/\r\n           spack/env/clang/clang -rpath /usr/local/lib -version-info 13:0:12 -l\r\n           ncurses -o libtermkey.la termkey.lo driver-csi.lo driver-ti.lo\r\n     13    glibtool --quiet --mode=link --tag=CC /Users/certik/repos/spack/lib/\r\n           spack/env/clang/clang -o demo libtermkey.la demo.lo\r\n     14    glibtool --quiet --mode=link --tag=CC /Users/certik/repos/spack/lib/\r\n           spack/env/clang/clang -o demo-async libtermkey.la demo-async.lo\r\n  >> 15    Undefined symbols for architecture x86_64:\r\n     16      \"_cur_term\", referenced from:\r\n     17          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     18      \"_setupterm\", referenced from:\r\n     19          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     20      \"_strfnames\", referenced from:\r\n     21          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     22      \"_strnames\", referenced from:\r\n     23          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     24      \"_tigetstr\", referenced from:\r\n     25          _load_terminfo in libtermkey.a(driver-ti.o)\r\n  >> 26    Undefined symbols for architecture x86_64:\r\n     27      \"_cur_term\", referenced from:\r\n     28          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     29      \"_setupterm\", referenced from:\r\n     30          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     31      \"_strfnames\", referenced from:\r\n     32          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     33      \"_strnames\", referenced from:\r\n     34          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     35      \"_tigetstr\", referenced from:\r\n     36          _load_terminfo in libtermkey.a(driver-ti.o)\r\n     37    ld: symbol(s) not found for architecture x86_64\r\n     38    ld: symbol(s) not found for architecture x86_64\r\n  >> 39    clang: error: linker command failed with exit code 1 (use -v to see \r\n           invocation)\r\n  >> 40    clang: error: linker command failed with exit code 1 (use -v to see \r\n           invocation)\r\n  >> 41    make: *** [demo-async] Error 1\r\n     42    make: *** Waiting for unfinished jobs....\r\n  >> 43    make: *** [demo] Error 1\r\n\r\nSee build log for details:\r\n  /var/folders/_w/414v9g5d59gfc7f8qmgwl904000fsc/T/certik/spack-stage/spack-stage-libtermkey-0.18-jjb4nvom4y76lj6ukkez4y26cf2rttue/spack-build-out.txt\r\n```\r\n\r\n\r\nSpec:\r\n```\r\n$ spack spec neovim\r\nInput spec\r\n--------------------------------\r\nneovim\r\n\r\nConcretized\r\n--------------------------------\r\nneovim@0.4.4%apple-clang@12.0.0~ipo build_type=RelWithDebInfo arch=darwin-catalina-skylake\r\n    ^cmake@3.20.0%apple-clang@12.0.0~doc+ncurses+openssl+ownlibs~qt build_type=Release arch=darwin-catalina-skylake\r\n        ^ncurses@6.2%apple-clang@12.0.0~symlinks+termlib arch=darwin-catalina-skylake\r\n            ^pkgconf@1.7.3%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n        ^openssl@1.1.1k%apple-clang@12.0.0~docs+systemcerts arch=darwin-catalina-skylake\r\n            ^perl@5.32.1%apple-clang@12.0.0+cpanm+shared+threads arch=darwin-catalina-skylake\r\n                ^berkeley-db@18.1.40%apple-clang@12.0.0~docs patches=b231fcc4d5cff05e5c3a4814f6a5af0e9a966428dc2176540d2c05aff41de522 arch=darwin-catalina-skylake\r\n                ^gdbm@1.19%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n                    ^readline@8.0%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n            ^zlib@1.2.11%apple-clang@12.0.0+optimize+pic+shared arch=darwin-catalina-skylake\r\n    ^gettext@0.21%apple-clang@12.0.0+bzip2+curses+git~libunistring+libxml2+tar+xz arch=darwin-catalina-skylake\r\n        ^bzip2@1.0.8%apple-clang@12.0.0+shared arch=darwin-catalina-skylake\r\n            ^diffutils@3.7%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n                ^libiconv@1.16%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n        ^libxml2@2.9.10%apple-clang@12.0.0~python arch=darwin-catalina-skylake\r\n            ^xz@5.2.5%apple-clang@12.0.0~pic arch=darwin-catalina-skylake\r\n        ^tar@1.32%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n    ^gperf@3.1%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n    ^jemalloc@5.2.1%apple-clang@12.0.0~prof~stats jemalloc_prefix=none arch=darwin-catalina-skylake\r\n    ^libluv@1.36.0-0%apple-clang@12.0.0~ipo build_type=RelWithDebInfo arch=darwin-catalina-skylake\r\n        ^libuv@1.40.0%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n            ^autoconf@2.69%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n                ^help2man@1.47.16%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n                ^m4@1.4.18%apple-clang@12.0.0+sigsegv patches=3877ab548f88597ab2327a2230ee048d2d07ace1062efe81fc92e91b7f39cd00,c0a408fbffb7255fcc75e26bd8edab116fc81d216bfd18b473668b7739a4158e,fc9b61654a3ba1a8d6cd78ce087e7c96366c290bc8d2c299f09828d793b853c8 arch=darwin-catalina-skylake\r\n                    ^libsigsegv@2.12%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n            ^automake@1.16.3%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n            ^libtool@2.4.6%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n        ^lua@5.1.5%apple-clang@12.0.0~pcfile+shared arch=darwin-catalina-skylake\r\n            ^unzip@6.0%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n    ^libtermkey@0.18%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n    ^libvterm@0.1.4%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n    ^lua-bitlib@23-2%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n    ^lua-lpeg@1.0.2-1%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n    ^lua-mpack@1.0.6-0%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n        ^msgpack-c@3.1.1%apple-clang@12.0.0~ipo build_type=RelWithDebInfo arch=darwin-catalina-skylake\r\n    ^unibilium@2.0.0%apple-clang@12.0.0 arch=darwin-catalina-skylake\r\n```",
    "performed_via_github_app": null
}