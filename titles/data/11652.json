{
    "url": "https://api.github.com/repos/spack/spack/issues/11652",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/11652/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/11652/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/11652/events",
    "html_url": "https://github.com/spack/spack/pull/11652",
    "id": 453267837,
    "node_id": "MDExOlB1bGxSZXF1ZXN0Mjg1OTkzOTI0",
    "number": 11652,
    "title": "spack list: format version_json",
    "user": {
        "login": "ax3l",
        "id": 1353258,
        "node_id": "MDQ6VXNlcjEzNTMyNTg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1353258?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ax3l",
        "html_url": "https://github.com/ax3l",
        "followers_url": "https://api.github.com/users/ax3l/followers",
        "following_url": "https://api.github.com/users/ax3l/following{/other_user}",
        "gists_url": "https://api.github.com/users/ax3l/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ax3l/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ax3l/subscriptions",
        "organizations_url": "https://api.github.com/users/ax3l/orgs",
        "repos_url": "https://api.github.com/users/ax3l/repos",
        "events_url": "https://api.github.com/users/ax3l/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ax3l/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 471995122,
            "node_id": "MDU6TGFiZWw0NzE5OTUxMjI=",
            "url": "https://api.github.com/repos/spack/spack/labels/commands",
            "name": "commands",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2019-06-06T22:37:49Z",
    "updated_at": "2019-06-07T21:16:46Z",
    "closed_at": "2019-06-07T21:14:09Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/11652",
        "html_url": "https://github.com/spack/spack/pull/11652",
        "diff_url": "https://github.com/spack/spack/pull/11652.diff",
        "patch_url": "https://github.com/spack/spack/pull/11652.patch"
    },
    "body": "List the latest version of each package in JSON encoding.\r\nPreparation for consumption for a \"spack badge\" service.\r\n\r\n```command\r\nspack list --format version_json\r\n```\r\n```json\r\n[\r\n  {\"...\": \"...\"},\r\n  {\"name\": \"adios2\",\r\n   \"latest_version\": \"2.3.1\",\r\n   \"versions\": [\"develop\", \"2.3.1\", \"2.2.0\", \"2.1.0\", \"2.0.0\"],\r\n   \"homepage\": \"https://www.olcf.ornl.gov/center-projects/adios/\",\r\n   \"file\": \"https://github.com/spack/spack/blob/develop/var/spack/repos/builtin/packages/adios2/package.py\",\r\n   \"maintainers\": [\"ax3l\", \"chuckatkins\"],\r\n   \"dependencies\": {\"build\": [\"cmake\", \"pkgconfig\", \"mpi\", \"zeromq\", \"hdf5\", \"adios\", \"bzip2\", \"zfp\", \"python\", \"py-numpy\", \"py-mpi4py\"], \"link\": [\"mpi\", \"zeromq\", \"hdf5\", \"adios\", \"bzip2\", \"zfp\", \"python\"], \"run\": [\"python\", \"py-numpy\", \"py-mpi4py\"], \"test\": []}},\r\n  {\"...\": \"...\"},\r\n  {\"name\": \"zsh\",\r\n   \"latest_version\": \"5.4.2\",\r\n   \"versions\": [\"5.4.2\", \"5.3.1\", \"5.1.1\"],\r\n   \"homepage\": \"http://www.zsh.org\",\r\n   \"file\": \"https://github.com/spack/spack/blob/develop/var/spack/repos/builtin/packages/zsh/package.py\",\r\n   \"maintainers\": [],\r\n   \"dependencies\": {\"build\": [\"pcre\", \"ncurses\"], \"link\": [\"pcre\", \"ncurses\"], \"run\": [], \"test\": []}},\r\n  {\"name\": \"zstd\",\r\n   \"latest_version\": \"1.4.0\",\r\n   \"versions\": [\"1.4.0\", \"1.3.8\", \"1.3.0\", \"1.1.2\"],\r\n   \"homepage\": \"http://facebook.github.io/zstd/\",\r\n   \"file\": \"https://github.com/spack/spack/blob/develop/var/spack/repos/builtin/packages/zstd/package.py\",\r\n   \"maintainers\": [],\r\n   \"dependencies\": {\"build\": [], \"link\": [], \"run\": [], \"test\": []}}\r\n]\r\n```\r\n\r\nGenerating a package index suitable for RESTful consumption in a static HTML service:\r\n```bash\r\nbase_dir=$(pwd)/packages/\r\nfor pkg in $(spack list --format version_json | jq -c '.[]')\r\ndo\r\n    name=\"$(echo ${pkg} | jq -r '.name')\";\r\n    first_letter=${name::1}\r\n    mkdir -p ${base_dir}${first_letter}/\r\n    echo ${pkg} > ${base_dir}${first_letter}/${name}.json\r\ndone\r\n````\r\n\r\n```\r\n$ tree packages\r\npackages/\r\n\u251c\u2500\u2500 a\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 abinit.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 abyss.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 accfft.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 ack.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 activeharmony.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 acts-core.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 adept-utils.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 adios2.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 adios.json\r\n...\r\n\u251c\u2500\u2500 y\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 yajl.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 yambo.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 yaml-cpp.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 yara.json\r\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 yasm.json\r\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 yorick.json\r\n\u2514\u2500\u2500 z\r\n    \u251c\u2500\u2500 z3.json\r\n    \u251c\u2500\u2500 zeromq.json\r\n    \u251c\u2500\u2500 zfp.json\r\n    \u251c\u2500\u2500 zip.json\r\n    \u251c\u2500\u2500 zlib.json\r\n    \u251c\u2500\u2500 zoltan.json\r\n    \u251c\u2500\u2500 zsh.json\r\n    \u2514\u2500\u2500 zstd.json\r\n\r\n$ du -hs packages/                                                                                                       (topic-\r\n13M\tpackages/\r\n$ tree packages/ | wc -l                                                                                                     (topic-\r\n3260\r\n```",
    "performed_via_github_app": null
}