{
    "url": "https://api.github.com/repos/spack/spack/issues/3553",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/3553/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/3553/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/3553/events",
    "html_url": "https://github.com/spack/spack/pull/3553",
    "id": 216944654,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTEyNTcxMDQ4",
    "number": 3553,
    "title": "Support for resources that should not be expanded",
    "user": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446625544,
            "node_id": "MDU6TGFiZWw0NDY2MjU1NDQ=",
            "url": "https://api.github.com/repos/spack/spack/labels/documentation",
            "name": "documentation",
            "color": "0d5977",
            "default": true,
            "description": ""
        },
        {
            "id": 560616785,
            "node_id": "MDU6TGFiZWw1NjA2MTY3ODU=",
            "url": "https://api.github.com/repos/spack/spack/labels/don't-merge-yet",
            "name": "don't-merge-yet",
            "color": "d93f0b",
            "default": false,
            "description": null
        },
        {
            "id": 475567363,
            "node_id": "MDU6TGFiZWw0NzU1NjczNjM=",
            "url": "https://api.github.com/repos/spack/spack/labels/resources",
            "name": "resources",
            "color": "c5def5",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 16,
    "created_at": "2017-03-25T03:04:17Z",
    "updated_at": "2020-09-10T20:03:12Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/3553",
        "html_url": "https://github.com/spack/spack/pull/3553",
        "diff_url": "https://github.com/spack/spack/pull/3553.diff",
        "patch_url": "https://github.com/spack/spack/pull/3553.patch"
    },
    "body": "Fixes #3448\r\nFixes #3473\r\nFixes #3475\r\nFixes #6081\r\n\r\n(EDIT 11/21/17: new description)\r\n\r\n Improve documentation and handling of resources\r\n\r\n* Adds documentation on the 'placement' keyword when declaring resources for a package.\r\n* If the target dir already exists, print a warning (before, the source was silently skipped)\r\n* If the target dir exists and is an empty directory, just copy all the files in the resource directory to the target directory (this can occur if the root resource creates an empty directory to \"prepare\" for placing outside resources)\r\n* Added tests for resource stages (both for archived resources and non-expanding resources), and also for the resource restaging issue fixed by https://github.com/spack/spack/pull/5681\r\n* For cached resources, only symlink if the resource is an archive (don't symlink non-expanded resources)\r\n* Avoid appending `None` as an extension to the names of mirrored/cached resources\r\n* ~If the destination is a file and matches the source exactly, dont print a warning.~ This was removed for simplicity/efficiency\r\n* Fix installing packages from cached sources compressed with gzip\r\n\r\nTODOs:\r\n\r\n- [x] ~~Document use of ```destination``` for non-expanded resources~~ (EDIT: that was inconsistent with how ```placement``` is used for non-expanded resources so I have since changed it back, and updated the docs)\r\n- [x] Add test for non-expanded resources\r\n- [x] Fix expansion of cached .gz resources (added 11/1/17)\r\n- [x] ~Support archived resources which expand to a single file (11/1/17)~ UPDATE (11/21/17) this turned out to be an issue with how `.gz` resources were expanded\r\n\r\nOld description:\r\n\r\n~~Spack support for resources that should not be expanded was generally broken. This adds/restores support for non-expanded resources.~~ (EDIT: this actually worked but was not well documented, which has since been addressed in this PR)\r\n\r\n~~This PR also updates the meaning of 'destination' for resources where 'expand' is false: in this case 'destination' is used to place the single file relative to the root stage's source directory (whereas under normal circumstances 'destination' is itself a directory under the root stage's source directory where resources are placed).~~\r\n  \r\n  ",
    "performed_via_github_app": null
}