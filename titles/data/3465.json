{
    "url": "https://api.github.com/repos/spack/spack/issues/3465",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/3465/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/3465/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/3465/events",
    "html_url": "https://github.com/spack/spack/issues/3465",
    "id": 214707072,
    "node_id": "MDU6SXNzdWUyMTQ3MDcwNzI=",
    "number": 3465,
    "title": "OpenMP crashes: Cannot install gcc and llvm simultaneously",
    "user": {
        "login": "eschnett",
        "id": 213514,
        "node_id": "MDQ6VXNlcjIxMzUxNA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/213514?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/eschnett",
        "html_url": "https://github.com/eschnett",
        "followers_url": "https://api.github.com/users/eschnett/followers",
        "following_url": "https://api.github.com/users/eschnett/following{/other_user}",
        "gists_url": "https://api.github.com/users/eschnett/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/eschnett/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/eschnett/subscriptions",
        "organizations_url": "https://api.github.com/users/eschnett/orgs",
        "repos_url": "https://api.github.com/users/eschnett/repos",
        "events_url": "https://api.github.com/users/eschnett/events{/privacy}",
        "received_events_url": "https://api.github.com/users/eschnett/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446615135,
            "node_id": "MDU6TGFiZWw0NDY2MTUxMzU=",
            "url": "https://api.github.com/repos/spack/spack/labels/configuration",
            "name": "configuration",
            "color": "bfd4f2",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2017-03-16T13:39:36Z",
    "updated_at": "2019-12-09T13:33:04Z",
    "closed_at": "2019-12-09T13:33:04Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I first built gcc (6.3) with a system compiler, then llvm (3.9) with that gcc, both via Spack. I then created a view that contained both gcc and llvm. My intention was to combine the respective Clang and Gfortran.\r\n\r\nHowever, this lead to crashes and segfaults in applications built with that version of gcc. I tracked this down to a shared library confusion: Both gcc and llvm provide a shared library named `libgomp`. For gcc, this is the real thing, for llvm, this is a mere symbolic link to its `libomp`. (Since the two `libgomp` live in different places in the directory hierarchy of the view there is no immediate conflict.)\r\n\r\nI can imagine several solutions:\r\n- Remove the symbolic link for llvm\r\n- Teach llvm to use gcc's libgomp directly (is that even possible?), as there is no need for two OpenMP implementations\r\n- When linking applications, ensure that gcc and clang pick up the correct `libgomp`, even if used via a view, and ensure that that path is hard-coded\r\n",
    "performed_via_github_app": null
}