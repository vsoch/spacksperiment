{
    "url": "https://api.github.com/repos/spack/spack/issues/2215",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/2215/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/2215/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/2215/events",
    "html_url": "https://github.com/spack/spack/issues/2215",
    "id": 186833516,
    "node_id": "MDU6SXNzdWUxODY4MzM1MTY=",
    "number": 2215,
    "title": "spack load: don't load multiple variants of same packages and don't load packages that depend on different versions of already-loaded packages",
    "user": {
        "login": "mkuron",
        "id": 1748330,
        "node_id": "MDQ6VXNlcjE3NDgzMzA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1748330?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mkuron",
        "html_url": "https://github.com/mkuron",
        "followers_url": "https://api.github.com/users/mkuron/followers",
        "following_url": "https://api.github.com/users/mkuron/following{/other_user}",
        "gists_url": "https://api.github.com/users/mkuron/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/mkuron/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mkuron/subscriptions",
        "organizations_url": "https://api.github.com/users/mkuron/orgs",
        "repos_url": "https://api.github.com/users/mkuron/repos",
        "events_url": "https://api.github.com/users/mkuron/events{/privacy}",
        "received_events_url": "https://api.github.com/users/mkuron/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446632829,
            "node_id": "MDU6TGFiZWw0NDY2MzI4Mjk=",
            "url": "https://api.github.com/repos/spack/spack/labels/modules",
            "name": "modules",
            "color": "fef2c0",
            "default": false,
            "description": null
        },
        {
            "id": 446619758,
            "node_id": "MDU6TGFiZWw0NDY2MTk3NTg=",
            "url": "https://api.github.com/repos/spack/spack/labels/python",
            "name": "python",
            "color": "c2e0c6",
            "default": false,
            "description": null
        },
        {
            "id": 574328447,
            "node_id": "MDU6TGFiZWw1NzQzMjg0NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/python3",
            "name": "python3",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 456144594,
            "node_id": "MDU6TGFiZWw0NTYxNDQ1OTQ=",
            "url": "https://api.github.com/repos/spack/spack/labels/virtual-dependencies",
            "name": "virtual-dependencies",
            "color": "0052cc",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "alalazo",
        "id": 4199709,
        "node_id": "MDQ6VXNlcjQxOTk3MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alalazo",
        "html_url": "https://github.com/alalazo",
        "followers_url": "https://api.github.com/users/alalazo/followers",
        "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
        "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
        "organizations_url": "https://api.github.com/users/alalazo/orgs",
        "repos_url": "https://api.github.com/users/alalazo/repos",
        "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alalazo/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "alalazo",
            "id": 4199709,
            "node_id": "MDQ6VXNlcjQxOTk3MDk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/alalazo",
            "html_url": "https://github.com/alalazo",
            "followers_url": "https://api.github.com/users/alalazo/followers",
            "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
            "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
            "organizations_url": "https://api.github.com/users/alalazo/orgs",
            "repos_url": "https://api.github.com/users/alalazo/repos",
            "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
            "received_events_url": "https://api.github.com/users/alalazo/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 24,
    "created_at": "2016-11-02T15:28:07Z",
    "updated_at": "2018-05-02T09:07:06Z",
    "closed_at": "2018-05-02T09:07:06Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Assume I have installed two versions of OpenMPI with matching versions of Boost by running the following:\r\n```\r\nspack install boost +mpi ^openmpi@1.10.3+slurm+verbs+pmi\r\nspack install boost +mpi ^openmpi@1.8.8+slurm+verbs+pmi\r\n```\r\n\r\nNow if a user does the obvious thing\r\n```\r\nspack load openmpi\r\nspack load boost\r\n```\r\nthey end up with all matching modules loaded:\r\n```\r\nCurrently Loaded Modulefiles:\r\n  1) spack                              4) boost-1.62.0-gcc-4.9.4-bb3jpvq\r\n  2) openmpi-1.8.8-gcc-4.9.4-gyda6cg    5) boost-1.62.0-gcc-4.9.4-5kz43yc\r\n  3) openmpi-1.10.3-gcc-4.9.4-mnqdpir\r\n```\r\nThis is of course never the intended action. To get the correct set of modules, a user will need to run commands like these instead:\r\n```\r\nspack load openmpi@1.10.3\r\nspack load boost ^openmpi@1.10.3\r\n```\r\n`spack find --deps` can tell me what dependencies a package is linked to, but constructing dependency specs is not something you'd want to bother a novel user with if you can avoid it (also, they shouldn't need to care whether they're using OpenMPI 1.10.1 or 1.10.3). I think this could be made easier on the `spack load` level:\r\n1. Since loading the same package in multiple versions or with multiple different dependencies never makes sense, first of all, all spack-generated module files should declare conflicts against all modules with the same name.\r\n2. It should be possible to specify a default version that will be loaded if no version number is specified (e.g. `spack load openmpi` could translate into `spack load openmpi@1.10.3` or `spack load openmpi@1.8.8` depending on configuration). Similar to how `spack install openmpi` will always install the most recent version, except it should be configurable to a different version. Maybe _etc/spack/packages.yaml_ can already be used for this purpose.\r\n3. If a dependency module (e.g. _openmpi@1.10.3_) is already loaded, then loading the dependent without further dependency specification (e.g. `spack load boost`) should automatically load the version of the dependent that is linked against the loaded dependency (in this example, _boost ^openmpi@1.10.3_)",
    "performed_via_github_app": null
}