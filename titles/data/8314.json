{
    "url": "https://api.github.com/repos/spack/spack/issues/8314",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/8314/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/8314/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/8314/events",
    "html_url": "https://github.com/spack/spack/issues/8314",
    "id": 327637660,
    "node_id": "MDU6SXNzdWUzMjc2Mzc2NjA=",
    "number": 8314,
    "title": "pfft compile issue on mac",
    "user": {
        "login": "luca-heltai",
        "id": 2919756,
        "node_id": "MDQ6VXNlcjI5MTk3NTY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2919756?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/luca-heltai",
        "html_url": "https://github.com/luca-heltai",
        "followers_url": "https://api.github.com/users/luca-heltai/followers",
        "following_url": "https://api.github.com/users/luca-heltai/following{/other_user}",
        "gists_url": "https://api.github.com/users/luca-heltai/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/luca-heltai/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/luca-heltai/subscriptions",
        "organizations_url": "https://api.github.com/users/luca-heltai/orgs",
        "repos_url": "https://api.github.com/users/luca-heltai/repos",
        "events_url": "https://api.github.com/users/luca-heltai/events{/privacy}",
        "received_events_url": "https://api.github.com/users/luca-heltai/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 446614839,
            "node_id": "MDU6TGFiZWw0NDY2MTQ4Mzk=",
            "url": "https://api.github.com/repos/spack/spack/labels/macOS",
            "name": "macOS",
            "color": "c5def5",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2018-05-30T09:01:57Z",
    "updated_at": "2018-05-30T09:16:15Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "spack install pfft fails with the following:\r\n~~~\r\n==> No patches needed for pfft\r\n==> Building pfft [AutotoolsPackage]\r\n==> Executing phase: 'autoreconf'\r\n==> Executing phase: 'configure'\r\n==> Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j8'\r\n\r\n5 errors found in build log:\r\n     658    libtool: link: ar cru .libs/libapi.a .libs/api-basic.o .libs/api-adv.o .libs/fortran-api.o .libs/f03-w\r\n            rap.o\r\n     659    libtool: link: ranlib .libs/libapi.a\r\n     660    libtool: link: ( cd \".libs\" && rm -f \"libapi.la\" && ln -s \"../libapi.la\" \"libapi.la\" )\r\n     661    Making all in .\r\n     662    /bin/sh ./libtool  --tag=CC   --mode=link /Applications/deal.II-9.1.0.app/Contents/Resources/spack/lib\r\n            /spack/env/clang/clang  -O3 -fomit-frame-pointer -fPIC -malign-double -fstrict-aliasing -ffast-math -m\r\n            arch=core2 -mtune=core2   -no-undefined -version-info 0:0:0  -o libpfft.la -rpath /Applications/deal.I\r\n            I-9.1.0.app/Contents/Resources/spack/opt/spack/darwin-highsierra-x86_64/clang-6.0.0/pfft-1.0.8-alpha-6\r\n            bbo3t7q5ltk7mjmrx7tzli5rc77funk/lib  kernel/libkernel.la util/libutil.la api/libapi.la gcell/libgcell.\r\n            la -lmpi\r\n     663    libtool: link: /Applications/deal.II-9.1.0.app/Contents/Resources/spack/lib/spack/env/clang/clang -dyn\r\n            amiclib  -o .libs/libpfft.0.dylib   -Wl,-force_load,kernel/.libs/libkernel.a -Wl,-force_load,util/.lib\r\n            s/libutil.a -Wl,-force_load,api/.libs/libapi.a -Wl,-force_load,gcell/.libs/libgcell.a  -lmpi  -O3 -mal\r\n            ign-double -march=core2 -mtune=core2   -install_name  /Applications/deal.II-9.1.0.app/Contents/Resourc\r\n            es/spack/opt/spack/darwin-highsierra-x86_64/clang-6.0.0/pfft-1.0.8-alpha-6bbo3t7q5ltk7mjmrx7tzli5rc77f\r\n            unk/lib/libpfft.0.dylib -compatibility_version 1 -current_version 1.0 -Wl,-single_module\r\n  >> 664    Undefined symbols for architecture x86_64:\r\n     665      \"_fftw_alloc_complex\", referenced from:\r\n     666          _pfft_alloc_complex in libkernel.a(malloc.o)\r\n     667      \"_fftw_alloc_real\", referenced from:\r\n     668          _pfft_alloc_real in libkernel.a(malloc.o)\r\n     669      \"_fftw_destroy_plan\", referenced from:\r\n     670          _pfft_plan_sertrafo in libkernel.a(sertrafo.o)\r\n\r\n     ...\r\n\r\n     706      \"_fftw_plan_guru64_dft_r2c\", referenced from:\r\n     707          _plan_trafo in libkernel.a(sertrafo.o)\r\n     708      \"_fftw_plan_guru64_r2r\", referenced from:\r\n     709          _plan_remap in libkernel.a(sertrafo.o)\r\n     710          _plan_trafo in libkernel.a(sertrafo.o)\r\n     711    ld: symbol(s) not found for architecture x86_64\r\n  >> 712    clang-6.0: error: linker command failed with exit code 1 (use -v to see invocation)\r\n  >> 713    make[2]: *** [libpfft.la] Error 1\r\n  >> 714    make[1]: *** [all-recursive] Error 1\r\n  >> 715    make: *** [all] Error 2\r\n~~~\r\n\r\nI'm not an expert with auto-tools, but it looks to me that `libtool` is missing fftw flags. If I compile manually, by *tricking* libtools in this way:\r\n\r\n~~~\r\nCC='clang -lfftw3_mpi  -lfftw3_threads -lfftw3' ./configure; make -j4;\r\n~~~\r\ncompilation and linking goes through. \r\n\r\nWhere is the right place to fix this? Notice that on some linux machines things work out of the box, but I have one linux box (with a custom distribution based on centos) where I see the same issue.",
    "performed_via_github_app": null
}