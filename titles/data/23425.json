{
    "url": "https://api.github.com/repos/spack/spack/issues/23425",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/23425/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/23425/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/23425/events",
    "html_url": "https://github.com/spack/spack/issues/23425",
    "id": 875516850,
    "node_id": "MDU6SXNzdWU4NzU1MTY4NTA=",
    "number": 23425,
    "title": "Installation issue: hwloc",
    "user": {
        "login": "cessenat",
        "id": 40771352,
        "node_id": "MDQ6VXNlcjQwNzcxMzUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/40771352?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cessenat",
        "html_url": "https://github.com/cessenat",
        "followers_url": "https://api.github.com/users/cessenat/followers",
        "following_url": "https://api.github.com/users/cessenat/following{/other_user}",
        "gists_url": "https://api.github.com/users/cessenat/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/cessenat/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/cessenat/subscriptions",
        "organizations_url": "https://api.github.com/users/cessenat/orgs",
        "repos_url": "https://api.github.com/users/cessenat/repos",
        "events_url": "https://api.github.com/users/cessenat/events{/privacy}",
        "received_events_url": "https://api.github.com/users/cessenat/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2021-05-04T14:24:31Z",
    "updated_at": "2021-05-05T08:23:36Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "\r\n### Steps to reproduce the issue\r\nWhen compiling hwloc with nvhpc on Ubuntu 20.04 while libxml2 is external, libxml2 is not found. When using gcc it is found, when using an spack libxml2 there is no problem either. Problem occurs on Ubuntu 18.04 as well.\r\n\r\n<!-- Fill in the exact spec you are trying to build and the relevant part of the error message -->\r\n```console\r\n$ spack install hwloc %nvhpc\r\n[+] /usr (external libxml2-2.9.10-icsj6fenju5bx5hkbmsohdwiot2ikfai)\r\n==> Installing hwloc-2.4.1-uepik74337nuaeoi35fqpee6ouclriya\r\n==> No binary for hwloc-2.4.1-uepik74337nuaeoi35fqpee6ouclriya found: installing from source\r\n==> Warning: Missing a source id for ncurses@6.2.20200212\r\n==> Using cached archive: /home/cessenat/Softs/spack/var/spack/cache/_source-cache/archive/42/4267fe1193a8989f3ab7563a7499e047e77e33fed8f4dec16822a7aebcf78459.tar.gz\r\n==> No patches needed for hwloc\r\n==> hwloc: Executing phase: 'autoreconf'\r\n==> hwloc: Executing phase: 'configure'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/tmp/cessenat/spack-stage/spack-stage-hwloc-2.4.1-uepik74337nuaeoi35fqpee6ouclriya/spack-src/configure' '--prefix=/home/cessenat/Softs/spack/opt/spack/linux-ubuntu20.04-core2/nvhpc-21.2/hwloc-2.4.1-uepik74337nuaeoi35fqpee6ouclriya' '--disable-opencl' '--disable-cairo' '--disable-nvml' '--disable-gl' '--disable-cuda' '--enable-libxml2' '--disable-libudev' '--enable-pci' '--enable-shared'\r\n\r\n1 error found in build log:\r\n     264    checking for final PCIACCESS support... yes\r\n     265    checking rocm_smi/rocm_smi.h usability... no\r\n     266    checking rocm_smi/rocm_smi.h presence... no\r\n     267    checking for rocm_smi/rocm_smi.h... no\r\n     268    checking for LIBXML2... no\r\n     269    configure: WARNING: --enable-libxml2 requested, but libxml2 was not found\r\n  >> 270    configure: error: Cannot continue\r\n\r\nSee build log for details:\r\n  /tmp/cessenat/spack-stage/spack-stage-hwloc-2.4.1-uepik74337nuaeoi35fqpee6ouclriya/spack-build-out.txt\r\n\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n* **Spack:** 0.16.1-2501-2efcfa9de1\r\n* **Python:** 3.8.5\r\n* **Platform:** linux-ubuntu20.04-core2\r\n* **Concretizer:** original\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\n~/.spack/packages.yaml:\r\n```\r\n  libxml2:\r\n    externals:\r\n    - spec: libxml2\r\n      prefix: /usr\r\n```\r\n~/.spack/linux/compilers.yaml:\r\n```\r\n- compiler:\r\n    spec: nvhpc@21.2\r\n    paths:\r\n      cc: /opt/nvidia/hpc_sdk/Linux_x86_64/21.2/compilers/bin/nvc\r\n      cxx: /opt/nvidia/hpc_sdk/Linux_x86_64/21.2/compilers/bin/nvc++\r\n      f77: /opt/nvidia/hpc_sdk/Linux_x86_64/21.2/compilers/bin/nvfortran\r\n      fc: /opt/nvidia/hpc_sdk/Linux_x86_64/21.2/compilers/bin/nvfortran\r\n    flags: {}\r\n    operating_system: ubuntu20.04\r\n    target: x86_64\r\n    modules: [nvhpc/21.2]\r\n```\r\n\r\nPrior to spack install:\r\n$ sudo apt install libxml2-dev libxml2\r\n\r\n$ uname -a\r\nLinux dv6700 5.8.0-41-generic #46~20.04.1-Ubuntu SMP Mon Jan 18 17:52:23 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n\r\n### Additional information\r\n\r\n<!-- Please upload the following files. They should be present in the stage directory of the failing build. Also upload any config.log or similar file if one exists. -->\r\n* [spack-build-out.txt](https://github.com/spack/spack/files/6421633/spack-build-out.txt)\r\n* [spack-build-env.txt](https://github.com/spack/spack/files/6421634/spack-build-env.txt)\r\n\r\n<!-- Some packages have maintainers who have volunteered to debug build failures. Run `spack maintainers <name-of-the-package>` and @mention them here if they exist. -->\r\n@bgoglin\r\n\r\n### General information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "performed_via_github_app": null
}