{
    "url": "https://api.github.com/repos/spack/spack/issues/22614",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/22614/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/22614/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/22614/events",
    "html_url": "https://github.com/spack/spack/pull/22614",
    "id": 843549807,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NjAyOTE0Nzk5",
    "number": 22614,
    "title": "Respect compiler preferences when choosing externals (original concretizer)",
    "user": {
        "login": "skosukhin",
        "id": 19591868,
        "node_id": "MDQ6VXNlcjE5NTkxODY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/19591868?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/skosukhin",
        "html_url": "https://github.com/skosukhin",
        "followers_url": "https://api.github.com/users/skosukhin/followers",
        "following_url": "https://api.github.com/users/skosukhin/following{/other_user}",
        "gists_url": "https://api.github.com/users/skosukhin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/skosukhin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/skosukhin/subscriptions",
        "organizations_url": "https://api.github.com/users/skosukhin/orgs",
        "repos_url": "https://api.github.com/users/skosukhin/repos",
        "events_url": "https://api.github.com/users/skosukhin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/skosukhin/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-03-29T16:35:03Z",
    "updated_at": "2021-03-30T06:57:31Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/22614",
        "html_url": "https://github.com/spack/spack/pull/22614",
        "diff_url": "https://github.com/spack/spack/pull/22614.diff",
        "patch_url": "https://github.com/spack/spack/pull/22614.patch"
    },
    "body": "Fixes (for the original concretizer) #21311 #4635 #5110 #8082\r\nSupersedes my previous attempt to fix this #4956\r\n\r\n\r\nIntroduces a number of tests:\r\n1. `test_external_package_and_compiler_preferences` extended and enabled for the `original` concretizer;\r\n2. `test_external_package_without_version` not related directly to the modifications of this PR but shows a bug in the ASP-based concretizer;\r\n3. `test_preferred_compiler_with_externals` checks that we respect the compiler preferences when the input spec does not specify a compiler;\r\n4. `test_preferred_compiler_latest_version_with_externals` checks that we repect the preferred version of the compiler and take the latest one if the compiler preference list does not specify versions;\r\n5. `test_preferred_compiler_with_lesser_external_version` checks that we prefer an older version of an external with the preferred compiler over a newer version with less preferred compiler (the ASP-based concretizer does not agree with that);\r\n6. `test_ignore_externals_with_non_preferred_compilers` checks that we prefer to build a buildable external if none of its specs satisfies the preferred compiler (not supported yet by both concretizers);\r\n7. `test_ignore_externals_with_invalid_compilers` checks that we ignore externals with compilers/arcitechtures that are not listed in `compilers.yaml` (partially implemented for the `original` concretizer, not supported by the ASP-based one);\r\n8. `test_preferred_external_without_compiler_version`, `test_preferred_external_without_compiler` and `test_preferred_external_without_version` check that we prefer a less conctrained (in terms of compiler and version) external (the last one is not supported by the ASP-based concretizer);\r\n9. `test_preferred_external_version` checks that we respect the version preference list when choosing an external.\r\n\r\nThis obviously needs a discussion.\r\n\r\n@alalazo",
    "performed_via_github_app": null
}