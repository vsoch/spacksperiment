{
    "url": "https://api.github.com/repos/spack/spack/issues/3668",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/3668/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/3668/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/3668/events",
    "html_url": "https://github.com/spack/spack/issues/3668",
    "id": 218963320,
    "node_id": "MDU6SXNzdWUyMTg5NjMzMjA=",
    "number": 3668,
    "title": "Spack-built gcc can't find crtbegin.o or -lgcc",
    "user": {
        "login": "hartzell",
        "id": 312978,
        "node_id": "MDQ6VXNlcjMxMjk3OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/312978?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hartzell",
        "html_url": "https://github.com/hartzell",
        "followers_url": "https://api.github.com/users/hartzell/followers",
        "following_url": "https://api.github.com/users/hartzell/following{/other_user}",
        "gists_url": "https://api.github.com/users/hartzell/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/hartzell/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hartzell/subscriptions",
        "organizations_url": "https://api.github.com/users/hartzell/orgs",
        "repos_url": "https://api.github.com/users/hartzell/repos",
        "events_url": "https://api.github.com/users/hartzell/events{/privacy}",
        "received_events_url": "https://api.github.com/users/hartzell/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2017-04-03T15:03:51Z",
    "updated_at": "2017-04-03T17:24:49Z",
    "closed_at": "2017-04-03T15:17:31Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I'm using Spack on a CentOS 7 system which has *gcc@4.8.5* as the system compiler.  I've used that to build *gcc@5.4.0*.\r\n\r\nThis compiler is used by Spack to build a big old pile of packages that work successfully.\r\n\r\nI've used Spack's Lmod support to build lua modulefiles using the configuration [described in this comment](https://github.com/TACC/Lmod/issues/245#issuecomment-290950488).\r\n\r\nIf I `module use` the `.../gcc/4.8.5` directory and then `module load gcc` I end up with my Spack-built `gcc` on my path.\r\n\r\nI'm trying to use it to compile a simple C program:\r\n\r\n```c\r\n#include <stdio.h>\r\n\r\nvoid main() { printf(\"YIKES\\n\"); }\r\n```\r\n\r\nand it fails because it cannot file `crtbegin.o` or `-lgcc`:\r\n\r\n```\r\n[hartzelg@lb046dev spack]$ gcc -o ~/foo ~/foo.c\r\n/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/bin/ld: cannot find crtbegin.o: No such file or directory\r\n/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/bin/ld: cannot find -lgcc\r\ncollect2: error: ld returned 1 exit status\r\n[hartzelg@lb046dev spack]$\r\n```\r\n\r\n**I think this should work.  Am I correct?**\r\n\r\nI can help it find `-lgcc` by adding a `-L` argument, but it doesn't solve the `crtbegin.o` problem and I don't think that I should have to do this....\r\n\r\n```\r\n[hartzelg@lb046dev spack]$ gcc -L/sc1/apps/spack/0.0.3/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/gcc -L/sc1/apps/spack/0.0.3/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/ -o ~/foo ~/foo.c\r\n/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/bin/ld: cannot find crtbegin.o: No such file or directory\r\ncollect2: error: ld returned 1 exit status\r\n```\r\n\r\nHere's `gcc -v` output:\r\n\r\n```\r\n[hartzelg@lb046dev spack]$ which gcc\r\n/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/bin/gcc\r\n[hartzelg@lb046dev spack]$ gcc -v\r\nUsing built-in specs.\r\nCOLLECT_GCC=gcc\r\nCOLLECT_LTO_WRAPPER=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/libexec/gcc/x86_64-unknown-linux-gnu/5.4.0/lto-wrapper\r\nTarget: x86_64-unknown-linux-gnu\r\nConfigured with: /scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/var/spack/stage/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/gcc-5.4.0/configure --prefix=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6 --libdir=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64 --disable-multilib --enable-languages=c,java,c++,fortran,objc,go --with-mpfr=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/mpfr-3.1.5-yisprahw4e7ksk67qrrhjb63u3euvrlf --with-gmp=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gmp-6.1.2-6bsovvkqwx6zscwtbvjj6egrgizbyycm --enable-lto --with-quad --with-sysroot=/ --with-stage1-ldflags='-Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64 -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/mpfr-3.1.5-yisprahw4e7ksk67qrrhjb63u3euvrlf/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gmp-6.1.2-6bsovvkqwx6zscwtbvjj6egrgizbyycm/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/mpc-1.0.3-umgid46twpczw3hnlkz3jgond32zf33l/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/isl-0.18-l4somr6goh77xpmdb4tey7uwovhds526/lib -static-libstdc++ -static-libgcc' --with-boot-ldflags='-Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64 -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/mpfr-3.1.5-yisprahw4e7ksk67qrrhjb63u3euvrlf/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gmp-6.1.2-6bsovvkqwx6zscwtbvjj6egrgizbyycm/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/mpc-1.0.3-umgid46twpczw3hnlkz3jgond32zf33l/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/lib -Wl,-rpath,/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/isl-0.18-l4somr6goh77xpmdb4tey7uwovhds526/lib -static-libstdc++ -static-libgcc' --with-gnu-ld --with-ld=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/bin/ld --with-gnu-as --with-as=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/bin/as --with-mpc=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/mpc-1.0.3-umgid46twpczw3hnlkz3jgond32zf33l --with-isl=/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/isl-0.18-l4somr6goh77xpmdb4tey7uwovhds526\r\nThread model: posix\r\ngcc version 5.4.0 (GCC)\r\n```\r\n\r\nand here's `gcc --print-search-dirs`.\r\n\r\n```\r\n[hartzelg@lb046dev spack]$ gcc --print-search-dirs\r\ninstall: /scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/\r\nprograms: =/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/libexec/gcc/x86_64-unknown-linux-gnu/5.4.0/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/libexec/gcc/x86_64-unknown-linux-gnu/5.4.0/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/libexec/gcc/x86_64-unknown-linux-gnu/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/lib64/gcc/x86_64-unknown-linux-gnu/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/x86_64-unknown-linux-gnu/bin/x86_64-unknown-linux-gnu/5.4.0/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/x86_64-unknown-linux-gnu/bin/\r\nlibraries: =/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/x86_64-unknown-linux-gnu/lib/x86_64-unknown-linux-gnu/5.4.0/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/x86_64-unknown-linux-gnu/lib/../lib64/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/../../../x86_64-unknown-linux-gnu/5.4.0/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/../../../../lib64/:/lib/x86_64-unknown-linux-gnu/5.4.0/:/lib/../lib64/:/usr/lib/x86_64-unknown-linux-gnu/5.4.0/:/usr/lib/../lib64/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/binutils-2.28-74n7hbbnm2eevj462ls27fgdfct6zwn6/x86_64-unknown-linux-gnu/lib/:/scratch/hartzelg/spack-cime-sc1-working-dir/workspace/sc1-daily-build/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-5.4.0-bwn6ord45bc5nt7mbudipoa7haga4zk6/lib64/gcc/x86_64-unknown-linux-gnu/5.4.0/../../../:/lib/:/usr/lib/\r\n```\r\n\r\nAnyone see what I'm missing?\r\n\r\n",
    "performed_via_github_app": null
}