{
    "url": "https://api.github.com/repos/spack/spack/issues/12857",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/12857/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/12857/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/12857/events",
    "html_url": "https://github.com/spack/spack/pull/12857",
    "id": 494952191,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MzE4NjAxNjky",
    "number": 12857,
    "title": "Tests/bugfix: clean up build stage handling; no user config.yaml change (#12651, #12798, #13009)",
    "user": {
        "login": "tldahlgren",
        "id": 35777542,
        "node_id": "MDQ6VXNlcjM1Nzc3NTQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/35777542?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tldahlgren",
        "html_url": "https://github.com/tldahlgren",
        "followers_url": "https://api.github.com/users/tldahlgren/followers",
        "following_url": "https://api.github.com/users/tldahlgren/following{/other_user}",
        "gists_url": "https://api.github.com/users/tldahlgren/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tldahlgren/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tldahlgren/subscriptions",
        "organizations_url": "https://api.github.com/users/tldahlgren/orgs",
        "repos_url": "https://api.github.com/users/tldahlgren/repos",
        "events_url": "https://api.github.com/users/tldahlgren/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tldahlgren/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 1566617052,
            "node_id": "MDU6TGFiZWwxNTY2NjE3MDUy",
            "url": "https://api.github.com/repos/spack/spack/labels/bugfix",
            "name": "bugfix",
            "color": "c4aaef",
            "default": false,
            "description": ""
        },
        {
            "id": 512483390,
            "node_id": "MDU6TGFiZWw1MTI0ODMzOTA=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-medium",
            "name": "impact-medium",
            "color": "fef2c0",
            "default": false,
            "description": ""
        },
        {
            "id": 456121338,
            "node_id": "MDU6TGFiZWw0NTYxMjEzMzg=",
            "url": "https://api.github.com/repos/spack/spack/labels/refactoring",
            "name": "refactoring",
            "color": "f28f2a",
            "default": false,
            "description": null
        },
        {
            "id": 1371552534,
            "node_id": "MDU6TGFiZWwxMzcxNTUyNTM0",
            "url": "https://api.github.com/repos/spack/spack/labels/stage",
            "name": "stage",
            "color": "b50fc1",
            "default": false,
            "description": ""
        },
        {
            "id": 456341797,
            "node_id": "MDU6TGFiZWw0NTYzNDE3OTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/tests",
            "name": "tests",
            "color": "b60205",
            "default": false,
            "description": "General test capability(ies)"
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "tldahlgren",
        "id": 35777542,
        "node_id": "MDQ6VXNlcjM1Nzc3NTQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/35777542?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tldahlgren",
        "html_url": "https://github.com/tldahlgren",
        "followers_url": "https://api.github.com/users/tldahlgren/followers",
        "following_url": "https://api.github.com/users/tldahlgren/following{/other_user}",
        "gists_url": "https://api.github.com/users/tldahlgren/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tldahlgren/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tldahlgren/subscriptions",
        "organizations_url": "https://api.github.com/users/tldahlgren/orgs",
        "repos_url": "https://api.github.com/users/tldahlgren/repos",
        "events_url": "https://api.github.com/users/tldahlgren/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tldahlgren/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "tldahlgren",
            "id": 35777542,
            "node_id": "MDQ6VXNlcjM1Nzc3NTQy",
            "avatar_url": "https://avatars.githubusercontent.com/u/35777542?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tldahlgren",
            "html_url": "https://github.com/tldahlgren",
            "followers_url": "https://api.github.com/users/tldahlgren/followers",
            "following_url": "https://api.github.com/users/tldahlgren/following{/other_user}",
            "gists_url": "https://api.github.com/users/tldahlgren/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tldahlgren/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tldahlgren/subscriptions",
            "organizations_url": "https://api.github.com/users/tldahlgren/orgs",
            "repos_url": "https://api.github.com/users/tldahlgren/repos",
            "events_url": "https://api.github.com/users/tldahlgren/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tldahlgren/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 12,
    "created_at": "2019-09-18T02:36:47Z",
    "updated_at": "2019-10-16T19:01:15Z",
    "closed_at": "2019-10-10T23:50:07Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/12857",
        "html_url": "https://github.com/spack/spack/pull/12857",
        "diff_url": "https://github.com/spack/spack/pull/12857.diff",
        "patch_url": "https://github.com/spack/spack/pull/12857.patch"
    },
    "body": "Fixes #12651\r\nFixes #12798\r\nFixes #13009 \r\n\r\nThis PR restructures tests needing to temporarily change the`config:build_stage` path such that the tests no longer create or overwrite the setting in `$HOME/.spack/config.yaml`.  The change also appears to resolve stage path related issues when filtering tests on staging.\r\n\r\nThis PR consists of **two distinct commits**.  The first provides support for nested `overrides` scopes, which are created via the `spack.config.override` context manager.  The second commit changes how the `autouse`'d `mock_stage` and assorted test fixtures and tests establish their temporary stage directories. \r\n\r\nTODO :\r\n- [x]  Resolve test failures and errors (by setting `stage._stage_root` instead of using `spack.config.override`)\r\n- [x] Address potential presence of `$spack/test-stage` (made `test-stage` hidden)\r\n- [x] Address fixture vs test issue for `test_get_stage_root_in_spack` (added directory presence check)\r\n- [x] Make `overrides-` (internal overrides base name) a `config.py` variable\r\n- [x] Change `always_access_path` name and fixture\r\n- [x] Update `test_stage_purge` docstring\r\n- [x] Hide `test_stage` within a spack instance; ensure stage root is a directory\r\n- [x] Move base name of config override scope to `config.py`\r\n- [x] Change name and comment for `always_access_path` fixture to reflect it mocking `can_access`\r\n- [x] Correct `test_stage_purge` docstring\r\n- [x] Add `spack` to `test_stage` within a spack instance (to reduce odds of conflict)\r\n- [x] Move `instance_path_for_stage` fixture code into the only test using it\r\n- [x] Change a couple of stage test asserts\r\n- [x] Remove stage-related use of `nomockstage`\r\n- [x] Change docstring for `test_get_stage_root_in_spack`\r\n- [x] Add TODO to address requested `tmp_build_stage_dir` follow-on work",
    "performed_via_github_app": null
}