{
    "url": "https://api.github.com/repos/spack/spack/issues/17999",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/17999/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/17999/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/17999/events",
    "html_url": "https://github.com/spack/spack/issues/17999",
    "id": 677271480,
    "node_id": "MDU6SXNzdWU2NzcyNzE0ODA=",
    "number": 17999,
    "title": "Installation issue: cuda package fails to locate linking library directory",
    "user": {
        "login": "rblake-llnl",
        "id": 24722037,
        "node_id": "MDQ6VXNlcjI0NzIyMDM3",
        "avatar_url": "https://avatars.githubusercontent.com/u/24722037?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rblake-llnl",
        "html_url": "https://github.com/rblake-llnl",
        "followers_url": "https://api.github.com/users/rblake-llnl/followers",
        "following_url": "https://api.github.com/users/rblake-llnl/following{/other_user}",
        "gists_url": "https://api.github.com/users/rblake-llnl/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rblake-llnl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rblake-llnl/subscriptions",
        "organizations_url": "https://api.github.com/users/rblake-llnl/orgs",
        "repos_url": "https://api.github.com/users/rblake-llnl/repos",
        "events_url": "https://api.github.com/users/rblake-llnl/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rblake-llnl/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-08-11T23:49:59Z",
    "updated_at": "2020-08-12T11:13:58Z",
    "closed_at": "2020-08-12T11:13:58Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "<!-- Thanks for taking the time to report this build failure. To proceed with the report please:\r\n\r\n1. Title the issue \"Installation issue: <name-of-the-package>\".\r\n2. Provide the information required below.\r\n\r\nWe encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively! -->\r\n\r\n### Steps to reproduce the issue\r\n\r\n<!-- Fill in the exact spec you are trying to build and the relevant part of the error message -->\r\n```console\r\n# set up spack environment below\r\n$ spack install\r\n```\r\nRelevant error message\r\n```\r\n==> Installing py-horovod\r\n==> No binary for py-horovod found: installing from source\r\n==> Error: IndexError: list index out of range\r\n\r\n/usr/WS2/blake14/spack/var/spack/repos/builtin/packages/py-horovod/package.py:118, in setup_build_environment:\r\n        115            env.set('HOROVOD_CUDA_HOME', self.spec['cuda'].prefix)\r\n        116            env.set('HOROVOD_CUDA_INCLUDE',\r\n        117                    self.spec['cuda'].headers.directories[0])\r\n  >>    118            env.set('HOROVOD_CUDA_LIB', self.spec['cuda'].libs.directories[0])\r\n        119\r\n        120            env.set('HOROVOD_NCCL_HOME', self.spec['nccl'].prefix)\r\n        121            env.set('HOROVOD_NCCL_INCLUDE',\r\n\r\n```\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.15.3-489-2f0fd44\r\n* **Python:** 3.7.2\r\n* **Platform:** linux-rhel7-power9le\r\n\r\nspack.yaml\r\n```\r\nspack:\r\n  packages:\r\n    all:\r\n      providers:\r\n        mpi:\r\n        - spectrum-mpi@0.0.1\r\n        lapack:\r\n        - openblas\r\n        blas:\r\n        - openblas\r\n      buildable: true\r\n      version: []\r\n      compiler:\r\n      - gcc@8.3.1\r\n      target: []\r\n    openblas:\r\n      compiler: []\r\n      buildable: true\r\n      version: []\r\n      target: []\r\n      providers: {}\r\n    cmake:\r\n      variants: ~openssl ~ncurses\r\n      version:\r\n      - 3.16.8\r\n      target: []\r\n      compiler: []\r\n      buildable: true\r\n      providers: {}\r\n      externals:\r\n      - spec: cmake@3.16.8\r\n        prefix: /usr/tce/packages/cmake/cmake-3.16.8\r\n    cuda:\r\n      buildable: false\r\n      version:\r\n      - 10.1.243\r\n      target: []\r\n      compiler: []\r\n      providers: {}\r\n      externals:\r\n      - spec: cuda@10.1.243\r\n        prefix: /usr/tce/packages/cuda/cuda-10.1.243\r\n    py-torch:\r\n      buildable: true\r\n      variants: +cuda +distributed cuda_arch=72\r\n      version: []\r\n      target: []\r\n      compiler: []\r\n      providers: {}\r\n    nccl:\r\n      variants: +cuda cuda_arch=72\r\n      version: []\r\n      target: []\r\n      compiler: []\r\n      buildable: true\r\n      providers: {}\r\n    cudnn:\r\n      version:\r\n      - 7.6.5.32-10.1-linux-ppc64le\r\n      target: []\r\n      compiler: []\r\n      buildable: true\r\n      providers: {}\r\n    spectrum-mpi:\r\n      buildable: false\r\n      version:\r\n      - 0.0.1\r\n      target: []\r\n      compiler: []\r\n      providers: {}\r\n      externals:\r\n      - spec: spectrum-mpi@0.0.1%gcc@8.3.1\r\n        prefix: /usr/tce/packages/spectrum-mpi/spectrum-mpi-rolling-release-gcc-8.3.1\r\n  compilers:\r\n  - compiler:\r\n      spec: gcc@8.3.1\r\n      paths:\r\n        cc: /usr/tce/packages/gcc/gcc-8.3.1/bin/gcc\r\n        cxx: /usr/tce/packages/gcc/gcc-8.3.1/bin/g++\r\n        f77: /usr/tce/packages/gcc/gcc-8.3.1/bin/gfortran\r\n        fc: /usr/tce/packages/gcc/gcc-8.3.1/bin/gfortran\r\n      flags: {}\r\n      operating_system: rhel7\r\n      target: ppc64le\r\n      modules: []\r\n      environment:\r\n        unset: []\r\n      extra_rpaths: []\r\n  specs:\r\n  - python\r\n  - py-torch\r\n  - py-horovod\r\n  - py-pandas\r\n  - py-scipy\r\n  - py-h5py\r\n  - py-scikit-learn\r\n  - py-matplotlib\r\n  - py-pillow\r\n```\r\n\r\n### Additional information\r\n\r\nProblem occurs here in the cuda package:\r\n```\r\n    @property\r\n    def libs(self):\r\n        libs = find_libraries('libcuda', root=self.prefix, shared=True,\r\n                              recursive=True)\r\n\r\n        filtered_libs = []\r\n        # CUDA 10.0 provides Compatability libraries for running newer versions\r\n        # of CUDA with older drivers. These do not work with newer drivers.\r\n        for lib in libs:\r\n            parts = lib.split(os.sep)\r\n            if 'compat' not in parts and 'stubs' not in parts:\r\n                filtered_libs.append(lib)\r\n        return LibraryList(filtered_libs)\r\n```\r\n\r\nCommit 54bce00d on 2020-07-24 broke this, while fixing issue #17607 with PR #17619\r\n\r\n### General information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [X] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [ ] I have uploaded the build log and environment files (N/A)\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "performed_via_github_app": null
}