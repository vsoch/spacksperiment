{
    "url": "https://api.github.com/repos/spack/spack/issues/9902",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/9902/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/9902/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/9902/events",
    "html_url": "https://github.com/spack/spack/issues/9902",
    "id": 382613158,
    "node_id": "MDU6SXNzdWUzODI2MTMxNTg=",
    "number": 9902,
    "title": "spack env : optionally concretize all root packages together",
    "user": {
        "login": "davydden",
        "id": 8023934,
        "node_id": "MDQ6VXNlcjgwMjM5MzQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/8023934?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davydden",
        "html_url": "https://github.com/davydden",
        "followers_url": "https://api.github.com/users/davydden/followers",
        "following_url": "https://api.github.com/users/davydden/following{/other_user}",
        "gists_url": "https://api.github.com/users/davydden/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/davydden/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/davydden/subscriptions",
        "organizations_url": "https://api.github.com/users/davydden/orgs",
        "repos_url": "https://api.github.com/users/davydden/repos",
        "events_url": "https://api.github.com/users/davydden/events{/privacy}",
        "received_events_url": "https://api.github.com/users/davydden/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446623646,
            "node_id": "MDU6TGFiZWw0NDY2MjM2NDY=",
            "url": "https://api.github.com/repos/spack/spack/labels/concretization",
            "name": "concretization",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 537065486,
            "node_id": "MDU6TGFiZWw1MzcwNjU0ODY=",
            "url": "https://api.github.com/repos/spack/spack/labels/environments",
            "name": "environments",
            "color": "d4c5f9",
            "default": false,
            "description": null
        },
        {
            "id": 73908756,
            "node_id": "MDU6TGFiZWw3MzkwODc1Ng==",
            "url": "https://api.github.com/repos/spack/spack/labels/feature",
            "name": "feature",
            "color": "84b6eb",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "tgamblin",
        "id": 299842,
        "node_id": "MDQ6VXNlcjI5OTg0Mg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/299842?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tgamblin",
        "html_url": "https://github.com/tgamblin",
        "followers_url": "https://api.github.com/users/tgamblin/followers",
        "following_url": "https://api.github.com/users/tgamblin/following{/other_user}",
        "gists_url": "https://api.github.com/users/tgamblin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tgamblin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tgamblin/subscriptions",
        "organizations_url": "https://api.github.com/users/tgamblin/orgs",
        "repos_url": "https://api.github.com/users/tgamblin/repos",
        "events_url": "https://api.github.com/users/tgamblin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tgamblin/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "tgamblin",
            "id": 299842,
            "node_id": "MDQ6VXNlcjI5OTg0Mg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/299842?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tgamblin",
            "html_url": "https://github.com/tgamblin",
            "followers_url": "https://api.github.com/users/tgamblin/followers",
            "following_url": "https://api.github.com/users/tgamblin/following{/other_user}",
            "gists_url": "https://api.github.com/users/tgamblin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tgamblin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tgamblin/subscriptions",
            "organizations_url": "https://api.github.com/users/tgamblin/orgs",
            "repos_url": "https://api.github.com/users/tgamblin/repos",
            "events_url": "https://api.github.com/users/tgamblin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tgamblin/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 11,
    "created_at": "2018-11-20T11:09:38Z",
    "updated_at": "2019-10-07T16:53:24Z",
    "closed_at": "2019-10-07T16:53:24Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "based on [environment tutorial](https://spack.readthedocs.io/en/latest/tutorial_environments.html), my understanding was that all `root` packages are conretized simultaneously so that we don't build multiple dependencies. This does not seem to be the case for the following example:\r\n\r\n\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack env create temp\r\n$ spack env activate temp\r\n$ spack add dealii\r\n$ spack add valgrind\r\n$ spack concretize -f\r\n==> Concretizing dealii\r\n[+]  s5ctayk  dealii@develop%clang@10.0.0-apple~adol-c+arpack~assimp build_type=DebugRelease ~cuda cuda_arch= ~doc~gmsh+gsl+hdf5~int64+metis+mpi+muparser~nanoflann+netcdf~oce+optflags+p4est~petsc~python+scalapack~slepc~sundials+trilinos arch=darwin-mojave-x86_64\r\n[+]  rmphnvs      ^arpack-ng@3.6.3%clang@10.0.0-apple+mpi+shared arch=darwin-mojave-x86_64\r\n[+]  uuwucyz          ^cmake@3.12.3%clang@10.0.0-apple~doc+ncurses+openssl+ownlibs patches=dd3a40d4d92f6b2158b87d6fb354c277947c776424aa03f6dc8096cf3135f5d0 ~qt arch=darwin-mojave-x86_64\r\n[+]  zvaa4lh              ^ncurses@6.1%clang@10.0.0-apple~symlinks~termlib arch=darwin-mojave-x86_64\r\n[+]  b5gm23c                  ^pkgconf@1.4.2%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  t4zg4vb              ^openssl@1.0.2o%clang@10.0.0-apple+systemcerts arch=darwin-mojave-x86_64\r\n[+]  igk7of6                  ^perl@5.26.2%clang@10.0.0-apple+cpanm patches=0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac +shared+threads arch=darwin-mojave-x86_64\r\n[+]  4ldnoio                      ^gdbm@1.14.1%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  722dzmg                          ^readline@7.0%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  uw6agny                  ^zlib@1.2.11%clang@10.0.0-apple+optimize+pic+shared arch=darwin-mojave-x86_64\r\n[+]  v2t5rno          ^openblas@0.3.3%clang@10.0.0-apple cpu_target= ~ilp64 patches=47cfa7a952ac7b2e4632c73ae199d69fb54490627b66a62c681e21019c4ddc9d,714aea33692304a50bd0ccde42590c176c82ded4a8ac7f06e573dc8071929c33 +pic+shared threads=none ~virtual_machine arch=darwin-mojave-x86_64\r\n[+]  6owrpmt          ^openmpi@3.1.3%clang@10.0.0-apple~cuda+cxx_exceptions fabrics= ~java~legacylaunchers~memchecker~pmi schedulers= ~sqlite3~thread_multiple+vt arch=darwin-mojave-x86_64\r\n[+]  irsuwjw              ^hwloc@1.11.9%clang@10.0.0-apple~cairo~cuda+libxml2~pci+shared arch=darwin-mojave-x86_64\r\n[+]  5ansovh                  ^libxml2@2.9.8%clang@10.0.0-apple~python arch=darwin-mojave-x86_64\r\n[+]  i47twa3                      ^xz@5.2.4%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  2solnba      ^boost@1.68.0%clang@10.0.0-apple+atomic+chrono~clanglibcpp cxxstd=default +date_time~debug+exception+filesystem+graph~icu+iostreams+locale+log+math~mpi+multithreaded~numpy patches=b37164268f34f7133cbc9a4066ae98fda08adf51e1172223f6a969909216870f +program_options+python+random+regex+serialization+shared+signals~singlethreaded+system~taggedlayout+test+thread+timer~versionedlayout+wave arch=darwin-mojave-x86_64\r\n[+]  syohzw5          ^bzip2@1.0.6%clang@10.0.0-apple+shared arch=darwin-mojave-x86_64\r\n[+]  te2wy74              ^diffutils@3.6%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  nunzf4z          ^python@2.7.15%clang@10.0.0-apple+dbm~optimizations patches=123082ab3483ded78e86d7c809e98a804b3465b4683c96bd79a2fd799f572244 +pic+pythoncmd~shared~tk~ucs4 arch=darwin-mojave-x86_64\r\n[+]  ndtg2ny              ^sqlite@3.23.1%clang@10.0.0-apple~functions arch=darwin-mojave-x86_64\r\n[+]  3xp3xgx      ^gsl@2.5%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  lzwprfv      ^hdf5@1.10.4%clang@10.0.0-apple~cxx~debug~fortran+hl+mpi+pic+shared~szip~threadsafe arch=darwin-mojave-x86_64\r\n[+]  wmzjbao      ^intel-tbb@2019%clang@10.0.0-apple cxxstd=default patches=ca08c28bdb15582c30777f9303d1986e4c09b3d514776494f3fbf5f19381bfda +shared+tm arch=darwin-mojave-x86_64\r\n[+]  tokytep      ^metis@5.1.0%clang@10.0.0-apple build_type=Release ~gdb~int64 patches=4991da938c1d3a1d3dea78e49bbebecba00273f98df2a656e38b83d55b281da1 +real64+shared arch=darwin-mojave-x86_64\r\n[+]  5ammk4l      ^muparser@2.2.6.1%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  uh4jqye      ^netcdf@4.6.1%clang@10.0.0-apple~dap~hdf4 maxdims=1024 maxvars=8192 +mpi~parallel-netcdf+shared arch=darwin-mojave-x86_64\r\n[+]  azyaray          ^m4@1.4.18%clang@10.0.0-apple patches=3877ab548f88597ab2327a2230ee048d2d07ace1062efe81fc92e91b7f39cd00,c0a408fbffb7255fcc75e26bd8edab116fc81d216bfd18b473668b7739a4158e,fc9b61654a3ba1a8d6cd78ce087e7c96366c290bc8d2c299f09828d793b853c8 +sigsegv arch=darwin-mojave-x86_64\r\n[+]  yzxmqil              ^libsigsegv@2.11%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  wjxt2y6      ^netcdf-cxx@4.2%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  udk3fgd      ^netlib-scalapack@2.0.2%clang@10.0.0-apple build_type=RelWithDebInfo ~pic+shared arch=darwin-mojave-x86_64\r\n[+]  pjavlko      ^p4est@2.0%clang@10.0.0-apple~openmp patches=8fb829e34e3a1e28afdd6e56e0bdc1d377af569b7ccb9e9d8da0eeb5829ed27e,e9418b1a9347a409be241cd185519b31950e42a7f55b6fb80ce53097657098ee arch=darwin-mojave-x86_64\r\n[+]  wuz6miy          ^autoconf@2.69%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  5mmp44g          ^automake@1.16.1%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  6uxuqma          ^libtool@2.4.6%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  xkgsfwe      ^suite-sparse@5.3.0%clang@10.0.0-apple~cuda~openmp+pic~tbb arch=darwin-mojave-x86_64\r\n[+]  twdxche      ^trilinos@12.12.1%clang@10.0.0-apple~alloptpkgs+amesos+amesos2+anasazi+aztec+belos+boost build_type=RelWithDebInfo ~cgns~complex~dtk+epetra+epetraext+exodus+explicit_template_instantiation~float+fortran~fortrilinos+gtest+hdf5+hypre+ifpack+ifpack2~intrepid~intrepid2~isorropia+kokkos+metis~minitensor+ml+muelu+mumps~nox~openmp patches=7ba0dea6c8407322c21970e549f2988fdfeeda8e3a5e0bb178207471142c1047,95420650aee640da31d5adc4ad8dcd3f67ae3e7d4736e167f7b3991e8ff47e0e ~phalanx~piro~pnetcdf~python+rol~rythmos+sacado~shards+shared~stk+suite-sparse~superlu+superlu-dist~teko~tempus+teuchos+tpetra~x11~xsdkflags~zlib+zoltan+zoltan2 arch=darwin-mojave-x86_64\r\n[+]  wkxhidy          ^glm@0.9.7.1%clang@10.0.0-apple build_type=RelWithDebInfo arch=darwin-mojave-x86_64\r\n[+]  hmnkxye          ^hypre@2.15.1%clang@10.0.0-apple~debug~int64~internal-superlu+mpi~shared arch=darwin-mojave-x86_64\r\n[+]  qgfey32          ^matio@1.5.9%clang@10.0.0-apple+hdf5+shared+zlib arch=darwin-mojave-x86_64\r\n[+]  y2ckdum          ^mumps@5.1.1%clang@10.0.0-apple+complex+double+float~int64~metis+mpi~parmetis~ptscotch~scotch+shared arch=darwin-mojave-x86_64\r\n[+]  pigioig          ^parmetis@4.0.3%clang@10.0.0-apple build_type=RelWithDebInfo ~gdb patches=4f892531eb0a807eb1b82e683a416d3e35154a455274cf9b162fb02054d11a5b,50ed2081bc939269689789942067c58b3e522c269269a430d5d34c00edbc5870,704b84f7c7444d4372cb59cca6e1209df4ef3b033bc4ee3cf50f369bce972a9d +shared arch=darwin-mojave-x86_64\r\n[+]  uwlpi7b          ^superlu-dist@5.3.0%clang@10.0.0-apple build_type=RelWithDebInfo ~int64+shared arch=darwin-mojave-x86_64\r\n==> Concretizing valgrind\r\n -   3cbq25o  valgrind@3.14.0%clang@10.0.0-apple+boost+mpi+only64bit~ubsan arch=darwin-mojave-x86_64\r\n -   r573dgz      ^boost@1.68.0%clang@10.0.0-apple+atomic+chrono~clanglibcpp cxxstd=default +date_time~debug+exception+filesystem+graph~icu+iostreams+locale+log+math~mpi+multithreaded~numpy+program_options+python+random+regex+serialization+shared+signals~singlethreaded+system~taggedlayout+test+thread+timer~versionedlayout+wave arch=darwin-mojave-x86_64\r\n[+]  syohzw5          ^bzip2@1.0.6%clang@10.0.0-apple+shared arch=darwin-mojave-x86_64\r\n[+]  te2wy74              ^diffutils@3.6%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  nunzf4z          ^python@2.7.15%clang@10.0.0-apple+dbm~optimizations patches=123082ab3483ded78e86d7c809e98a804b3465b4683c96bd79a2fd799f572244 +pic+pythoncmd~shared~tk~ucs4 arch=darwin-mojave-x86_64\r\n[+]  4ldnoio              ^gdbm@1.14.1%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  722dzmg                  ^readline@7.0%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  zvaa4lh                      ^ncurses@6.1%clang@10.0.0-apple~symlinks~termlib arch=darwin-mojave-x86_64\r\n[+]  b5gm23c                          ^pkgconf@1.4.2%clang@10.0.0-apple arch=darwin-mojave-x86_64\r\n[+]  t4zg4vb              ^openssl@1.0.2o%clang@10.0.0-apple+systemcerts arch=darwin-mojave-x86_64\r\n[+]  igk7of6                  ^perl@5.26.2%clang@10.0.0-apple+cpanm patches=0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac +shared+threads arch=darwin-mojave-x86_64\r\n[+]  uw6agny                  ^zlib@1.2.11%clang@10.0.0-apple+optimize+pic+shared arch=darwin-mojave-x86_64\r\n[+]  ndtg2ny              ^sqlite@3.23.1%clang@10.0.0-apple~functions arch=darwin-mojave-x86_64\r\n[+]  6owrpmt      ^openmpi@3.1.3%clang@10.0.0-apple~cuda+cxx_exceptions fabrics= ~java~legacylaunchers~memchecker~pmi schedulers= ~sqlite3~thread_multiple+vt arch=darwin-mojave-x86_64\r\n[+]  irsuwjw          ^hwloc@1.11.9%clang@10.0.0-apple~cairo~cuda+libxml2~pci+shared arch=darwin-mojave-x86_64\r\n[+]  5ansovh              ^libxml2@2.9.8%clang@10.0.0-apple~python arch=darwin-mojave-x86_64\r\n[+]  i47twa3                  ^xz@5.2.4%clang@10.0.0-apple arch=darwin-mojave-x86_64```\r\n```\r\n\r\n### Error Message\r\n\r\nSo it looks like `boost` will be re-installed for `valgrind`.\r\nMy best guess is that this is related to patching of `boost` from `deal.II`.\r\n\r\n\r\n### Information on your system\r\n\r\n 1. macOS 10.14.1\r\n 2.  `packages.yaml` \r\n\r\n```\r\n  valgrind:\r\n    variants: ~ubsan\r\n  boost:\r\n    variants: +thread+system+serialization+iostreams+python\r\n  dealii:\r\n    version: [develop]\r\n    variants: ~doc+optflags~python~adol-c~assimp~gmsh~nanoflann~oce~petsc~slepc~sundials\r\n```",
    "performed_via_github_app": null
}