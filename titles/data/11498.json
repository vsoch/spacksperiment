{
    "url": "https://api.github.com/repos/spack/spack/issues/11498",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/11498/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/11498/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/11498/events",
    "html_url": "https://github.com/spack/spack/issues/11498",
    "id": 445326527,
    "node_id": "MDU6SXNzdWU0NDUzMjY1Mjc=",
    "number": 11498,
    "title": "Installation issue: mumps (serial), error \"/bin/sh: line 0: fc: -h: invalid option\"",
    "user": {
        "login": "samfux84",
        "id": 11944875,
        "node_id": "MDQ6VXNlcjExOTQ0ODc1",
        "avatar_url": "https://avatars.githubusercontent.com/u/11944875?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/samfux84",
        "html_url": "https://github.com/samfux84",
        "followers_url": "https://api.github.com/users/samfux84/followers",
        "following_url": "https://api.github.com/users/samfux84/following{/other_user}",
        "gists_url": "https://api.github.com/users/samfux84/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/samfux84/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/samfux84/subscriptions",
        "organizations_url": "https://api.github.com/users/samfux84/orgs",
        "repos_url": "https://api.github.com/users/samfux84/repos",
        "events_url": "https://api.github.com/users/samfux84/events{/privacy}",
        "received_events_url": "https://api.github.com/users/samfux84/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 512483297,
            "node_id": "MDU6TGFiZWw1MTI0ODMyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-low",
            "name": "impact-low",
            "color": "fef2c0",
            "default": false,
            "description": ""
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "becker33",
        "id": 13971568,
        "node_id": "MDQ6VXNlcjEzOTcxNTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/13971568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/becker33",
        "html_url": "https://github.com/becker33",
        "followers_url": "https://api.github.com/users/becker33/followers",
        "following_url": "https://api.github.com/users/becker33/following{/other_user}",
        "gists_url": "https://api.github.com/users/becker33/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/becker33/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/becker33/subscriptions",
        "organizations_url": "https://api.github.com/users/becker33/orgs",
        "repos_url": "https://api.github.com/users/becker33/repos",
        "events_url": "https://api.github.com/users/becker33/events{/privacy}",
        "received_events_url": "https://api.github.com/users/becker33/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "becker33",
            "id": 13971568,
            "node_id": "MDQ6VXNlcjEzOTcxNTY4",
            "avatar_url": "https://avatars.githubusercontent.com/u/13971568?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/becker33",
            "html_url": "https://github.com/becker33",
            "followers_url": "https://api.github.com/users/becker33/followers",
            "following_url": "https://api.github.com/users/becker33/following{/other_user}",
            "gists_url": "https://api.github.com/users/becker33/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/becker33/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/becker33/subscriptions",
            "organizations_url": "https://api.github.com/users/becker33/orgs",
            "repos_url": "https://api.github.com/users/becker33/repos",
            "events_url": "https://api.github.com/users/becker33/events{/privacy}",
            "received_events_url": "https://api.github.com/users/becker33/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 3,
    "created_at": "2019-05-17T08:32:09Z",
    "updated_at": "2020-02-06T08:31:00Z",
    "closed_at": "2020-02-06T08:31:00Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "### Steps to reproduce the issue\r\n\r\n`spack install mumps@5.1.1+scotch~ptscotch~mpi+metis~parmetis+float+double+complex ^scotch@6.0.3+esmumps~mpi %gcc@4.8.5 arch=linux-centos7-x86_64`\r\n\r\nError:\r\n\r\n```\r\nlink_cmd() { fc -shared -Wl,-soname -Wl,/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/mumps-5.1.1-vvioxgwnqlr7rrdpzoktm3batzppozbi/lib/libpord.so -o \"$@\" -L/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/scotch-6.0.3-zp7hpy7mezr5betm6bdbddmifa3oim4d/lib -L/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/zlib-1.2.11-tu4n3a4rud6dtfqmgmgfrb32liysc5lu/lib -lesmumps -lscotch -lscotcherr -lz -L/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/metis-5.1.0-iennmlkbyexvyt5labjpnf6jwh7yo4tr/lib -lmetis -L/cluster/spack/apps/linux-centos7-x86_64/gcc-4.8.5/openblas-0.2.20-ut6yhgxs5opzdjsqbfm7kaodfpqj7haf/lib -lopenblas; }; link_cmd libpord.so graph.o gbipart.o gbisect.o ddcreate.o ddbisect.o nestdiss.o multisector.o gelim.o bucket.o tree.o symbfac.o interface.o sort.o minpriority.o\r\n/bin/sh: line 0: fc: -h: invalid option\r\nfc: usage: fc [-e ename] [-lnr] [first] [last] or fc -s [pat=rep] [command]\r\nmake[2]: *** [Makefile:29: libpord.so] Error 2\r\nmake[2]: Leaving directory '/dev/shm/spackapps/spack-stage/spack-stage-Q5M9wr/MUMPS_5.1.1/PORD/lib'\r\nmake[1]: *** [Makefile:66: lib/libpord.so] Error 2\r\nmake[1]: *** Waiting for unfinished jobs....\r\n```\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n```\r\n[spackapps@eu-c7-042-05 scripts]$ uname -a\r\nLinux eu-c7-042-05 3.10.0-862.14.4.el7.x86_64 #1 SMP Wed Sep 26 15:12:11 UTC 2018 x86_64 GNU/Linux\r\n```\r\n\r\n```\r\n[spackapps@eu-c7-042-05 scripts]$ lsb_release -d\r\nDescription:    CentOS Linux release 7.5.1804 (Core)\r\n```\r\n\r\n```\r\n- compiler:\r\n    environment: {}\r\n    extra_rpaths: []\r\n    flags:\r\n      cflags: -O2 -fPIC -ftree-vectorize -march=core-avx2 -mavx2\r\n      cppflags: -O2 -fPIC -ftree-vectorize -march=core-avx2 -mavx2\r\n      cxxflags: -O2 -fPIC -ftree-vectorize -march=core-avx2 -mavx2\r\n    modules: []\r\n    operating_system: centos7\r\n    paths:\r\n      cc: /usr/bin/gcc\r\n      cxx: /usr/bin/g++\r\n      f77: /usr/bin/gfortran\r\n      fc: /usr/bin/gfortran\r\n    spec: gcc@4.8.5\r\n    target: x86_64\r\n```\r\n\r\n### Additional information\r\n\r\nBuilding the same spec with +mpi instead of ~mpi worked without problems.\r\n\r\nThe main difference of the mumps Makefile.inc with respect to FC or fc, when comparing +mpi with ~mpi is:\r\n\r\n```\r\n        if '+mpi' in self.spec:\r\n            scalapack = self.spec['scalapack'].libs if not shared \\\r\n                else LibraryList([])\r\n            makefile_conf.extend(\r\n                ['CC = {0}'.format(self.spec['mpi'].mpicc),\r\n                 'FC = {0}'.format(self.spec['mpi'].mpifc),\r\n                 'FL = {0}'.format(self.spec['mpi'].mpifc),\r\n                 \"SCALAP = %s\" % scalapack.ld_flags,\r\n                 \"MUMPS_TYPE = par\"])\r\n        else:\r\n            makefile_conf.extend(\r\n                [\"CC = cc\",\r\n                 \"FC = fc\",\r\n                 \"FL = fc\",\r\n                 \"MUMPS_TYPE = seq\"])\r\n```\r\n\r\nI guess that \"fc\" is here referring to the SPACK compiler wrapper fc and not to the Linux command \"/usr/bin/fc\". What is a bit puzzling regarding the error message (\"/bin/sh: line 0: fc: -h: invalid option\") is, that I can not figure out where the -h option is set for the fc command at all. I did a grep on all files in the staged directory where SPACK was supposed to compile the library.\r\n\r\nCould any other SPACK user yet successfully install serial mumps ?\r\n\r\n```\r\n[spackapps@eu-c7-042-05 scripts]$ spack spec --install-status mumps@5.1.1+scotch~ptscotch~mpi+metis~parmetis+float+double+complex ^scotch@6.0.3+esmumps~mpi %$SSTDCOMP arch=$OS_ARCH\r\nInput spec\r\n--------------------------------\r\n     mumps@5.1.1+complex+double+float+metis~mpi~parmetis~ptscotch+scotch\r\n         ^scotch@6.0.3%gcc@4.8.5+esmumps~mpi arch=linux-centos7-x86_64 \r\n\r\nConcretized\r\n--------------------------------\r\n     mumps@5.1.1%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" +complex+double+float~int64+metis~mpi~parmetis~ptscotch+scotch+shared arch=linux-centos7-x86_64 \r\n[+]      ^metis@5.1.0%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  build_type=Release ~gdb~int64 patches=4991da938c1d3a1d3dea78e49bbebecba00273f98df2a656e38b83d55b281da1 ~real64+shared arch=linux-centos7-x86_64 \r\n[+]          ^cmake@3.11.1%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" ~doc+ncurses+openssl+ownlibs~qt arch=linux-centos7-x86_64 \r\n[+]              ^ncurses@6.0%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  patches=f84b2708a42777aadcc7f502a261afe10ca5646a51c1ef8b5e60d2070d926b57 ~symlinks~termlib arch=linux-centos7-x86_64 \r\n[+]                  ^pkgconf@1.4.0%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  arch=linux-centos7-x86_64 \r\n[+]              ^openssl@1.0.1e%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" +systemcerts arch=linux-centos7-x86_64 \r\n[+]      ^openblas@0.2.20%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  cpu_target= ~ilp64 patches=47cfa7a952ac7b2e4632c73ae199d69fb54490627b66a62c681e21019c4ddc9d +pic+shared threads=none ~virtual_machine arch=linux-centos7-x86_64 \r\n[+]      ^scotch@6.0.3%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" +compression+esmumps~int64+metis~mpi+shared arch=linux-centos7-x86_64 \r\n[+]          ^bison@3.0.4%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  patches=b72914fe38e54a6fc25f29019e0a0786705c4f61ce20d414cc2010c8d62448c7 arch=linux-centos7-x86_64 \r\n[+]              ^m4@1.4.18%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  patches=3877ab548f88597ab2327a2230ee048d2d07ace1062efe81fc92e91b7f39cd00 +sigsegv arch=linux-centos7-x86_64 \r\n[+]                  ^libsigsegv@2.11%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  arch=linux-centos7-x86_64 \r\n[+]          ^flex@2.6.4%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" +lex arch=linux-centos7-x86_64 \r\n[+]              ^gettext@0.19.8.1%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" +bzip2+curses+git~libunistring+libxml2 patches=9acdb4e73f67c241b5ef32505c9ddf7cf6884ca8ea661692f21dca28483b04b8 +tar+xz arch=linux-centos7-x86_64 \r\n[+]                  ^bzip2@1.0.6%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" +shared arch=linux-centos7-x86_64 \r\n[+]                  ^libxml2@2.9.4%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" ~python arch=linux-centos7-x86_64 \r\n[+]                      ^xz@5.2.3%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  arch=linux-centos7-x86_64 \r\n[+]                      ^zlib@1.2.11%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" +optimize+pic+shared arch=linux-centos7-x86_64 \r\n[+]                  ^tar@1.29%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  patches=08921fcbd732050c74ddf1de7d8ad95ffdbc09f8b4342456fa2f6a0dd02a957c,5c314db58d005043bf407abaf25eb9823b9032a22fd12a0b142d4bf548130fa4,d428578be7fb99b831eb61e53b8d88a859afe08b479a21238180899707d79ce4,e34d2470461037933737c0a60fbcc5d5ea905fefb6b414b4a2e88a440fcae23a arch=linux-centos7-x86_64 \r\n[+]              ^help2man@1.47.4%gcc@4.8.5 cflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cppflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\" cxxflags=\"-ftree-vectorize -O2 -march=core-avx2 -fPIC -mavx2\"  arch=linux-centos7-x86_64 \r\n\r\n[spackapps@eu-c7-042-05 scripts]$ \r\n```\r\n\r\nAny help is appreciated.\r\n\r\nBest regards\r\n\r\nSam",
    "performed_via_github_app": null
}