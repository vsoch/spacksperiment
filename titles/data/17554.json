{
    "url": "https://api.github.com/repos/spack/spack/issues/17554",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/17554/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/17554/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/17554/events",
    "html_url": "https://github.com/spack/spack/issues/17554",
    "id": 657962092,
    "node_id": "MDU6SXNzdWU2NTc5NjIwOTI=",
    "number": 17554,
    "title": "\"spack buildcache list\" breaks when a mirror lacks \"build_cache/index.json\"",
    "user": {
        "login": "andymwood",
        "id": 7825213,
        "node_id": "MDQ6VXNlcjc4MjUyMTM=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7825213?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/andymwood",
        "html_url": "https://github.com/andymwood",
        "followers_url": "https://api.github.com/users/andymwood/followers",
        "following_url": "https://api.github.com/users/andymwood/following{/other_user}",
        "gists_url": "https://api.github.com/users/andymwood/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/andymwood/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/andymwood/subscriptions",
        "organizations_url": "https://api.github.com/users/andymwood/orgs",
        "repos_url": "https://api.github.com/users/andymwood/repos",
        "events_url": "https://api.github.com/users/andymwood/events{/privacy}",
        "received_events_url": "https://api.github.com/users/andymwood/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 1433532775,
            "node_id": "MDU6TGFiZWwxNDMzNTMyNzc1",
            "url": "https://api.github.com/repos/spack/spack/labels/triage",
            "name": "triage",
            "color": "ed9793",
            "default": false,
            "description": "The issue needs to be prioritized"
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-07-16T08:10:27Z",
    "updated_at": "2020-07-17T16:04:06Z",
    "closed_at": "2020-07-17T16:04:06Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "<!-- Explain, in a clear and concise way, the command you ran and the result you were trying to achieve.\r\nExample: \"I ran `spack find` to list all the installed packages and ...\" -->\r\n\r\nIf a mirror lacks \"build_cache/index.json\", spack reports an error and prevents me from accessing the build_cache of any other mirrors. In particular, the source mirror that is now provided by default in spack v0.15.1 has no index.json and I have to remove that mirror to access any build cache's I've created myself.\r\n\r\n### Steps to reproduce the issue\r\n\r\nSet up a local mirror with a build cache:\r\n\r\n```console\r\n$ rm -rf spack/ mirror/ ~/.spack/\r\n$ git clone https://github.com/spack/spack.git\r\n$ . spack/share/spack/setup-env.sh\r\n$ spack install libsigsegv\r\n$ spack gpg init\r\n$ spack gpg create name name@mail\r\n$ spack buildcache create -d mirror --rebuild-index libsigsegv\r\n$ spack mirror add local mirror\r\n```\r\n\r\nBut I can't see the build cache in the mirror I've created:\r\n```console\r\n$ spack buildcache list\r\n==> Finding buildcaches at https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/build_cache\r\n==> Error: Failed to read index https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/build_cache/index.json\r\n```\r\n\r\nI can work around this by removing the default mirror. (I notice that `spack mirror remove spack-public` doesn't work.)\r\n```console\r\n$ rm spack/etc/spack/defaults/mirrors.yaml \r\n$ spack buildcache list\r\n==> Finding buildcaches at file:///home/vagrant/tmp/mirror/build_cache\r\n-- linux-opensuse_leap15-sandybridge / gcc@7.5.0 ----------------\r\nlibsigsegv@2.12\r\n```\r\n\r\n### Error Message\r\n\r\n<!-- If Spack reported an error, provide the error message. If it did not report an error but the output appears incorrect, provide the incorrect output. If there was no error message and no output but the result is incorrect, describe how it does not match what you expect. -->\r\n```console\r\n$ spack --debug --stacktrace buildcache list\r\nlib/spack/spack/cmd/__init__.py:122 ==> [2020-07-16-08:07:48.158605, 26001] Imported buildcache from built-in commands\r\nlib/spack/spack/cmd/__init__.py:122 ==> [2020-07-16-08:07:48.162069, 26001] Imported buildcache from built-in commands\r\nlib/spack/spack/config.py:805 ==> [2020-07-16-08:07:48.163214, 26001] Reading config file /home/vagrant/tmp/spack/etc/spack/defaults/mirrors.yaml\r\nlib/spack/spack/config.py:805 ==> [2020-07-16-08:07:48.164971, 26001] Reading config file /home/vagrant/.spack/mirrors.yaml\r\nlib/spack/spack/binary_distribution.py:876 ==> [2020-07-16-08:07:48.166383, 26001] Finding buildcaches at https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/build_cache\r\nlib/spack/spack/config.py:805 ==> [2020-07-16-08:07:48.166920, 26001] Reading config file /home/vagrant/tmp/spack/etc/spack/defaults/config.yaml\r\nlib/spack/spack/binary_distribution.py:885 ==> [2020-07-16-08:07:48.898070, 26001] Error: Failed to read index https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/build_cache/index.json\r\nlib/spack/spack/binary_distribution.py:886 ==> [2020-07-16-08:07:48.898294, 26001] HTTPError: HTTP Error 404: Not Found\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n```console\r\n$ spack debug report\r\n* **Spack:** 0.15.1\r\n* **Python:** 3.6.5\r\n* **Platform:** linux-opensuse_leap15-sandybridge\r\n```\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\n\r\n### Additional information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n- [x] I have run the failing commands in debug mode and reported the output\r\n\r\n<!-- We encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively!\r\n\r\nIf you want to ask a question about the tool (how to use it, what it can currently do, etc.), try the `#general` channel on our Slack first. We have a welcoming community and chances are you'll get your reply faster and without opening an issue.\r\n\r\nOther than that, thanks for taking the time to contribute to Spack! -->\r\n",
    "performed_via_github_app": null
}