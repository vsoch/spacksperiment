{
    "url": "https://api.github.com/repos/spack/spack/issues/3268",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/3268/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/3268/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/3268/events",
    "html_url": "https://github.com/spack/spack/issues/3268",
    "id": 210826211,
    "node_id": "MDU6SXNzdWUyMTA4MjYyMTE=",
    "number": 3268,
    "title": "ior: build error",
    "user": {
        "login": "fedepad",
        "id": 1518419,
        "node_id": "MDQ6VXNlcjE1MTg0MTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1518419?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/fedepad",
        "html_url": "https://github.com/fedepad",
        "followers_url": "https://api.github.com/users/fedepad/followers",
        "following_url": "https://api.github.com/users/fedepad/following{/other_user}",
        "gists_url": "https://api.github.com/users/fedepad/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/fedepad/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/fedepad/subscriptions",
        "organizations_url": "https://api.github.com/users/fedepad/orgs",
        "repos_url": "https://api.github.com/users/fedepad/repos",
        "events_url": "https://api.github.com/users/fedepad/events{/privacy}",
        "received_events_url": "https://api.github.com/users/fedepad/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2017-02-28T15:50:44Z",
    "updated_at": "2017-03-03T00:34:09Z",
    "closed_at": "2017-03-03T00:34:09Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Hi,\r\n\r\nrunning on Scientific Linux, in particular: \r\n1) Kernel version: 2.6.32-504.30.3.el6.x86_64\r\n2) System gcc: 4.4.7\r\n3) System Python: 2.6.6\r\n\r\nWhen I execute:\r\n`spack install ior +hdf5 +ncmpi`\r\nit fails during make() and this is what I get as screen output:\r\n\r\n> ==> Installing ior\r\n> ==> openmpi is already installed in /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/openmpi-2.0.2-tfjhl2ryjtawk3zv2tvcbalhivsnimsw\r\n> ==> Installing netcdf\r\n> ==> m4 is already installed in /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/m4-1.4.18-aek2urlgwvkl4svnnkmqdkmb5ocuszo7\r\n> ==> zlib is already installed in /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/zlib-1.2.11-sjoltdlk2wvrjjqi5nc52lxk6lt6cpwx\r\n> ==> Installing hdf5\r\n> ==> zlib is already installed in /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/zlib-1.2.11-sjoltdlk2wvrjjqi5nc52lxk6lt6cpwx\r\n> ==> openmpi is already installed in /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/openmpi-2.0.2-tfjhl2ryjtawk3zv2tvcbalhivsnimsw\r\n> ==> Fetching http://www.hdfgroup.org/ftp/HDF5/releases/hdf5-1.10/hdf5-1.10.0-patch1/src/hdf5-1.10.0-patch1.tar.gz\r\n> ######################################################################## 100,0%\r\n> ==> Staging archive: /gpfs/iowraptest/software_manager/spack_manager/spack/var/spack/stage/hdf5-1.10.0-patch1-jvhkxscq7ksvfovxv7y5hrmkueyj47yk/hdf5-1.10.0-patch1.tar.gz\r\n> ==> Created stage in /gpfs/iowraptest/software_manager/spack_manager/spack/var/spack/stage/hdf5-1.10.0-patch1-jvhkxscq7ksvfovxv7y5hrmkueyj47yk\r\n> ==> Ran patch() for hdf5\r\n> ==> Building hdf5 [AutotoolsPackage]\r\n> ==> Executing phase : 'autoreconf'\r\n> ==> Executing phase : 'configure'\r\n> ==> Executing phase : 'build'\r\n> ==> Executing phase : 'install'\r\n> ==> Successfully installed hdf5\r\n>   Fetch: 26.02s.  Build: 3m 3.62s.  Total: 3m 29.64s.\r\n> [+] /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/hdf5-1.10.0-patch1-jvhkxscq7ksvfovxv7y5hrmkueyj47yk\r\n> ==> Fetching http://www.gfd-dennou.org/arch/netcdf/unidata-mirror/netcdf-4.4.1.1.tar.gz\r\n> ######################################################################## 100,0%\r\n> ==> Staging archive: /gpfs/iowraptest/software_manager/spack_manager/spack/var/spack/stage/netcdf-4.4.1.1-pq4boqic7qbgwoyvp26ni5arisfhhdmf/netcdf-4.4.1.1.tar.gz\r\n> ==> Created stage in /gpfs/iowraptest/software_manager/spack_manager/spack/var/spack/stage/netcdf-4.4.1.1-pq4boqic7qbgwoyvp26ni5arisfhhdmf\r\n> ==> Ran patch() for netcdf\r\n> ==> Building netcdf [AutotoolsPackage]\r\n> ==> Executing phase : 'autoreconf'\r\n> ==> Executing phase : 'configure'\r\n> ==> Executing phase : 'build'\r\n> ==> Executing phase : 'install'\r\n> ==> Successfully installed netcdf\r\n>   Fetch: 4.26s.  Build: 16.56s.  Total: 20.82s.\r\n> [+] /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/netcdf-4.4.1.1-pq4boqic7qbgwoyvp26ni5arisfhhdmf\r\n> ==> hdf5 is already installed in /gpfs/iowraptest/software_manager/spack_manager/spack/opt/spack/linux-scientific6-x86_64/gcc-4.4.7/hdf5-1.10.0-patch1-jvhkxscq7ksvfovxv7y5hrmkueyj47yk\r\n> ==> Fetching https://github.com/LLNL/ior/archive/3.0.1.tar.gz\r\n> ######################################################################## 100,0%\r\n> ==> Staging archive: /gpfs/iowraptest/software_manager/spack_manager/spack/var/spack/stage/ior-3.0.1-cc72c33rnazgxe6pmblmhofq7acny5ct/3.0.1.tar.gz\r\n> ==> Created stage in /gpfs/iowraptest/software_manager/spack_manager/spack/var/spack/stage/ior-3.0.1-cc72c33rnazgxe6pmblmhofq7acny5ct\r\n> ==> No patches needed for ior\r\n> ==> Building ior [Package]\r\n> ==> Executing phase : 'install'\r\n> ==> Error: ProcessError: Command exited with status 2:\r\n>     'make' '-j8'\r\n> /gpfs/iowraptest/software_manager/spack_manager/spack/var/spack/repos/builtin/packages/ior/package.py:65, in install:\r\n>      45       def install(self, spec, prefix):\r\n>      46           os.system('./bootstrap')\r\n>      47   \r\n>      48           config_args = [\r\n>      49               'MPICC=%s' % spec['mpi'].prefix.bin + '/mpicc',\r\n>      50               '--prefix=%s' % prefix,\r\n>      51           ]\r\n>      52   \r\n>      53           if '+hdf5' in spec:\r\n>      54               config_args.append('--with-hdf5')\r\n>      55           else:\r\n>      56               config_args.append('--without-hdf5')\r\n>      57   \r\n>      58           if '+ncmpi' in spec:\r\n>      59               config_args.append('--with-ncmpi')\r\n>      60           else:\r\n>      61               config_args.append('--without-ncmpi')\r\n>      62   \r\n>      63           configure(*config_args)\r\n>      64   \r\n>   >> 65           make()\r\n>      66           make('install')\r\n\r\nI also attach the log. \r\n[spack-build-ior.txt](https://github.com/LLNL/spack/files/807296/spack-build-ior.txt)\r\nIt appears that pnetcdf.h (Parallel NetCDF) is not found. A quick hack would be to include in the ior ncmpi which shouldn't be the case as the variant +ncmpi should build the parallel version of netcdf because it's netcdf+mpi...\r\nAfter doing that just to check, the errors on NCMPI disappear but these two errors still remain:\r\n\r\n```\r\naiori-HDF5.c:552: error: too few arguments to function \u2018H5Dcreate2\u2019\r\naiori-HDF5.c:555: error: too few arguments to function \u2018H5Dopen2\u2019\r\n```\r\nThese errors appear to be related to the fact that IOR is using old HDF5 1.6 style so that should be enabled with:\r\n`\"-DH5_USE_16_API`\r\nalthough I think there should be already a define in the IOR sources and solved by:\r\nhttps://github.com/LLNL/ior/commit/6a7ddfe60c992121fb9389a1724bb7f7b884f3c5\r\n\r\nThis problem is mentioned in the following:\r\nhttp://hdf-forum.184993.n3.nabble.com/Compling-Flash-on-hdf5-1-8-4-patch1-td895571.html\r\n\r\nIs there something I'm missing here?\r\n",
    "performed_via_github_app": null
}