{
    "url": "https://api.github.com/repos/spack/spack/issues/5322",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/5322/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/5322/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/5322/events",
    "html_url": "https://github.com/spack/spack/pull/5322",
    "id": 256440835,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTQwMTcwODc0",
    "number": 5322,
    "title": "Improve PDToolkit support for different compilers",
    "user": {
        "login": "pramodskumbhar",
        "id": 27898197,
        "node_id": "MDQ6VXNlcjI3ODk4MTk3",
        "avatar_url": "https://avatars.githubusercontent.com/u/27898197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pramodskumbhar",
        "html_url": "https://github.com/pramodskumbhar",
        "followers_url": "https://api.github.com/users/pramodskumbhar/followers",
        "following_url": "https://api.github.com/users/pramodskumbhar/following{/other_user}",
        "gists_url": "https://api.github.com/users/pramodskumbhar/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/pramodskumbhar/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/pramodskumbhar/subscriptions",
        "organizations_url": "https://api.github.com/users/pramodskumbhar/orgs",
        "repos_url": "https://api.github.com/users/pramodskumbhar/repos",
        "events_url": "https://api.github.com/users/pramodskumbhar/events{/privacy}",
        "received_events_url": "https://api.github.com/users/pramodskumbhar/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2017-09-09T14:01:30Z",
    "updated_at": "2017-09-10T23:54:28Z",
    "closed_at": "2017-09-10T23:16:50Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/5322",
        "html_url": "https://github.com/spack/spack/pull/5322",
        "diff_url": "https://github.com/spack/spack/pull/5322.diff",
        "patch_url": "https://github.com/spack/spack/pull/5322.patch"
    },
    "body": "PDT dependency of TAU profiler doesn't use `CC`, `CXX` eb variables and need command line argument for compiler identification: \r\n\r\n```\r\n$ ./configure --help\r\nProgram Database Toolkit (PDT) Configuration\r\n--------------------------------------------\r\nLooks like an x86_64 machine...\r\nLooking for C++ compilers ... done\r\nUsage: ./configure [-KAI|-KCC|-GNU|-CC|-c++|-cxx|-xlC|-pgCC|-icpc|-ecpc]\r\n                   [-arch=ibm64|ibm64linux|solaris2-64|sunx86_64|IRIXO32|\r\n                    IRIXN32|IRIX64|ia64|i386_linux|crayxmt|arm64_linux|ibm64linux]\r\n                   [-help]\r\n                   [-compdir=<compdir>]\r\n                   [-enable-old-headers]\r\n                   [-useropt=<options>]\r\n                   [-prefix=<dir>]\r\n                   [-exec-prefix=<dir>]\r\n```\r\n\r\nIf we don't pass compiler id then it uses gcc and result in link time errors while building tau: \r\n\r\n```\r\nchecking whether gcc and cc understand -c and -o together... pgc++    -O2 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib64 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/mpich-3.2-4hf64twr/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib -I../include -DPGI -DTAU_DOT_H_LESS_HEADERS   -w         -DTAU_USE_SIZE_INSTEAD_OF_SIZEOF  -DTAU_DYNINST -DTAU_DYNINST41PLUS  -I/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/include -c tau_selective.dyn.cpp -o tau_selective_dyn.o\r\npgc++   -O2 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib64 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/mpich-3.2-4hf64twr/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib -c -o ompragma_f.o ompragma_f.cc\r\npgc++   -O2 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib64 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/mpich-3.2-4hf64twr/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib -c -o ompregion.o ompregion.cc\r\npgc++    -O2 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib64 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/mpich-3.2-4hf64twr/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib -I../include -DPGI -DTAU_DOT_H_LESS_HEADERS   -w         -DTAU_USE_SIZE_INSTEAD_OF_SIZEOF  -DTAU_DYNINST -DTAU_DYNINST41PLUS -I/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/include -c tau_instrument.dyn.cpp -o tau_instrument.dyn.o\r\npgc++   -O2 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/tau-2.26.3-xmerxzzw/lib64 -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/mpich-3.2-4hf64twr/lib -Wl,-rpath,/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib -c -o handler.o handler.cc\r\n/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib/libpdb.a(pdbMisc.o): In function `_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE12_M_constructIPcEEvT_S7_St20forward_iterator_tag.isra.179':\r\npdbMisc.cc:(.text+0x6b): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_create(unsigned long&, unsigned long)'\r\n/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib/libpdb.a(pdbMisc.o): In function `_GLOBAL__sub_I__ZN3PDBC2EPc':\r\npdbMisc.cc:(.text.startup+0x2d): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string()'\r\n/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib/libpdb.a(pdbItem.o): In function `_ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE12_M_constructIPcEEvT_S7_St20forward_iterator_tag.isra.62':\r\npdbItem.cc:(.text+0x6b): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_create(unsigned long&, unsigned long)'\r\n/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib/libpdb.a(pdbItem.o): In function `pdbItem::print(std::ostream&) const':\r\npdbItem.cc:(.text+0x13b): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::compare(char const*) const'\r\n/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib/libpdb.a(pdbItem.o): In function `pdbItem::process(PDB*)':\r\npdbItem.cc:(.text+0x1c96): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::rfind(char const*, unsigned long, unsigned long) const'\r\npdbItem.cc:(.text+0x1ced): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_append(char const*, unsigned long)'\r\npdbItem.cc:(.text+0x1d0c): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_assign(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'\r\npdbItem.cc:(.text+0x1d89): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_append(char const*, unsigned long)'\r\npdbItem.cc:(.text+0x1da8): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_assign(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'\r\npdbItem.cc:(.text+0x1de8): undefined reference to `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_assign(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)'\r\n/gpfs/bbp.cscs.ch/scratch/gss/bgq/kumbhar-adm/SPACK_HOME/install_home/bbpviz/install/linux-rhel6-x86_64/pgi-17.4/pdt-3.24-rmtfuok7/lib/libpdb.a(pdbItem.o): In function `std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > std::operator+<char, std::char_traits<char>, std::allocator<char> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::__cx\r\n```\r\n\r\nThis patch fix this. Tested with Intel and PGI compilers.",
    "performed_via_github_app": null
}