{
    "url": "https://api.github.com/repos/spack/spack/issues/16075",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/16075/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/16075/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/16075/events",
    "html_url": "https://github.com/spack/spack/issues/16075",
    "id": 600469435,
    "node_id": "MDU6SXNzdWU2MDA0Njk0MzU=",
    "number": 16075,
    "title": "Installation issue: gettext %gcc",
    "user": {
        "login": "LDAmorim",
        "id": 15057096,
        "node_id": "MDQ6VXNlcjE1MDU3MDk2",
        "avatar_url": "https://avatars.githubusercontent.com/u/15057096?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/LDAmorim",
        "html_url": "https://github.com/LDAmorim",
        "followers_url": "https://api.github.com/users/LDAmorim/followers",
        "following_url": "https://api.github.com/users/LDAmorim/following{/other_user}",
        "gists_url": "https://api.github.com/users/LDAmorim/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/LDAmorim/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/LDAmorim/subscriptions",
        "organizations_url": "https://api.github.com/users/LDAmorim/orgs",
        "repos_url": "https://api.github.com/users/LDAmorim/repos",
        "events_url": "https://api.github.com/users/LDAmorim/events{/privacy}",
        "received_events_url": "https://api.github.com/users/LDAmorim/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 446614839,
            "node_id": "MDU6TGFiZWw0NDY2MTQ4Mzk=",
            "url": "https://api.github.com/repos/spack/spack/labels/macOS",
            "name": "macOS",
            "color": "c5def5",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2020-04-15T17:30:27Z",
    "updated_at": "2020-04-20T22:57:36Z",
    "closed_at": "2020-04-15T18:13:08Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Hi,\r\n\r\nI am trying to install the package `gettext` (for python) with gcc@3.9.0 in a macOS Catalina 10.15.4 system.\r\nAnd I seems to me that I am getting an error because a function `_iconv_ostream_create` is called but not defined.\r\nI tried to understand from similar issues what I could be try to fix this.\r\nBut I can't even fix the warnings (I don't have a `.libs/` folder) and I tried to do something similar to https://github.com/att/ast/issues/932 by copying  `/usr/lib/libiconv.2.dylib` and `/usr/lib/libiconv.dylib` to my clang and gcc spack installed `libiconv` package lib (this actually fixed issues while building Geant4 and other packages).\r\n\r\nDo you have any suggestion to what I might be doing wrong?\r\n\r\nThanks,\r\nDiana\r\n\r\n### Steps to reproduce the issue\r\n```console\r\n$ spack install gettext %gcc arch=darwin-catalina-skylake\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/libiconv-1.16-drpl5la7fkm424n7i3oqv557wgdz4crj\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/pkgconf-1.6.3-ugp6molpipqm5jb2swahknwtvevycv64\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/xz-5.2.5-d7cthiafbsg35hdy5c7b3qekw2xaj2jd\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/zlib-1.2.11-not6kyiw6z6oanwcf2i3qbkjxfzekn6k\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/diffutils-3.7-jqqf56onl44ldkv7c72sydlpalk5bzfo\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/tar-1.32-djfctqtrby2iyut2zta6ukzl6fz7ovor\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/ncurses-6.2-4geakcqmv7ovy6e7wjm37wujh4kkyxcm\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/libxml2-2.9.9-ifgngzx6bhhe7cj4jxtwmguwses5oohy\r\n[+] /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/bzip2-1.0.8-ztd7zf46dsa56iet322mlrtvcecwxtkc\r\n==> 37107: Installing gettext\r\n==> Fetching https://ftpmirror.gnu.org/gettext/gettext-0.20.1.tar.xz\r\n#################################################################################################################################################### 100.0%\r\n==> Staging archive: /var/folders/5p/x7ftfty12yndrs3p6ntlk1jc0000gp/T/LDianaAmorim/spack-stage/spack-stage-gettext-0.20.1-id4usuww4umeajzkfakqvyftve2eib7g/gettext-0.20.1.tar.xz\r\n==> Created stage in /var/folders/5p/x7ftfty12yndrs3p6ntlk1jc0000gp/T/LDianaAmorim/spack-stage/spack-stage-gettext-0.20.1-id4usuww4umeajzkfakqvyftve2eib7g\r\n==> No patches needed for gettext\r\n==> 37107: gettext: Building gettext [AutotoolsPackage]\r\n==> 37107: gettext: Executing phase: 'autoreconf'\r\n==> 37107: gettext: Executing phase: 'configure'\r\n==> 37107: gettext: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j8'\r\n\r\n8 errors found in build log:\r\n     5016    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib: file: .libs/libxml_rpl.a(rpl_la-xmlwriter.o) h\r\n             as no symbols\r\n     5017    /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ranlib: file: .libs/libxml_rpl.a(rpl_la-xpointer.o) ha\r\n             s no symbols\r\n     5018    libtool: link: ( cd \".libs\" && rm -f \"libxml_rpl.la\" && ln -s \"../libxml_rpl.la\" \"libxml_rpl.la\" )\r\n     5019    /bin/sh ../libtool  --tag=CC   --mode=link /Users/LDianaAmorim/Documents/opt/spack/lib/spack/env/gcc/gcc  -g -O2  -no-undefined            -l\r\n             termcap -no-undefined -export-symbols libtextstyle.sym -version-info 0:0:0 -rpath /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-ca\r\n             talina-skylake/gcc-9.3.0/gettext-0.20.1-id4usuww4umeajzkfakqvyftve2eib7g/lib -L/Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catal\r\n             ina-skylake/gcc-9.3.0/libxml2-2.9.9-ifgngzx6bhhe7cj4jxtwmguwses5oohy/lib -Wl,-rpath,/Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-\r\n             catalina-skylake/gcc-9.3.0/libxml2-2.9.9-ifgngzx6bhhe7cj4jxtwmguwses5oohy/lib -o libtextstyle.la -rpath /Users/LDianaAmorim/Documents/opt/spa\r\n             ck/opt/spack/darwin-catalina-skylake/gcc-9.3.0/gettext-0.20.1-id4usuww4umeajzkfakqvyftve2eib7g/lib gl_array_list.lo binary-io.lo c-ctype.lo c\r\n             -strcasecmp.lo c-strncasecmp.lo concat-filename.lo dirname-lgpl.lo basename-lgpl.lo stripslash.lo exitfail.lo fatal-signal.lo fd-hook.lo fd-o\r\n             stream.lo file-ostream.lo full-write.lo getprogname.lo hash.lo html-ostream.lo html-styled-ostream.lo iconv-ostream.lo gl_list.lo math.lo mem\r\n             ory-ostream.lo noop-styled-ostream.lo ostream.lo safe-read.lo safe-write.lo sig-handler.lo styled-ostream.lo term-ostream.lo term-style-contr\r\n             ol.lo term-styled-ostream.lo unistd.lo unistr/u8-mbtouc.lo unistr/u8-mbtouc-aux.lo xmalloc.lo xstrdup.lo xconcat-filename.lo gl_xlist.lo xsiz\r\n             e.lo xvasprintf.lo xasprintf.lo color.lo misc.lo version.lo asnprintf.lo error.lo obstack.lo printf-args.lo printf-parse.lo strerror.lo strer\r\n             ror-override.lo vasnprintf.lo libcroco_rpl.la libglib_rpl.la libxml_rpl.la\r\n     5020    libtool: link: sed 's|^|_|' < libtextstyle.sym > .libs/libtextstyle-symbols.expsym\r\n     5021    libtool: link: /Users/LDianaAmorim/Documents/opt/spack/lib/spack/env/gcc/gcc -dynamiclib  -o .libs/libtextstyle.0.dylib  .libs/gl_array_list.\r\n             o .libs/binary-io.o .libs/c-ctype.o .libs/c-strcasecmp.o .libs/c-strncasecmp.o .libs/concat-filename.o .libs/dirname-lgpl.o .libs/basename-lg\r\n             pl.o .libs/stripslash.o .libs/exitfail.o .libs/fatal-signal.o .libs/fd-hook.o .libs/fd-ostream.o .libs/file-ostream.o .libs/full-write.o .lib\r\n             s/getprogname.o .libs/hash.o .libs/html-ostream.o .libs/html-styled-ostream.o .libs/iconv-ostream.o .libs/gl_list.o .libs/math.o .libs/memory\r\n             -ostream.o .libs/noop-styled-ostream.o .libs/ostream.o .libs/safe-read.o .libs/safe-write.o .libs/sig-handler.o .libs/styled-ostream.o .libs/\r\n             term-ostream.o .libs/term-style-control.o .libs/term-styled-ostream.o .libs/unistd.o unistr/.libs/u8-mbtouc.o unistr/.libs/u8-mbtouc-aux.o .l\r\n             ibs/xmalloc.o .libs/xstrdup.o .libs/xconcat-filename.o .libs/gl_xlist.o .libs/xsize.o .libs/xvasprintf.o .libs/xasprintf.o .libs/color.o .lib\r\n             s/misc.o .libs/version.o .libs/asnprintf.o .libs/error.o .libs/obstack.o .libs/printf-args.o .libs/printf-parse.o .libs/strerror.o .libs/stre\r\n             rror-override.o .libs/vasnprintf.o   -Wl,-force_load,./.libs/libcroco_rpl.a -Wl,-force_load,./.libs/libglib_rpl.a -Wl,-force_load,./.libs/lib\r\n             xml_rpl.a  -ltermcap -L/Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/libxml2-2.9.9-ifgngzx6bhhe7cj4jxtw\r\n             mguwses5oohy/lib  -g -O2 -Wl,-rpath -Wl,/Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/libxml2-2.9.9-ifg\r\n             ngzx6bhhe7cj4jxtwmguwses5oohy/lib   -install_name  /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-skylake/gcc-9.3.0/gettex\r\n             t-0.20.1-id4usuww4umeajzkfakqvyftve2eib7g/lib/libtextstyle.0.dylib -compatibility_version 1 -current_version 1.0 -Wl,-single_module -Wl,-expo\r\n             rted_symbols_list,.libs/libtextstyle-symbols.expsym\r\n  >> 5022    Undefined symbols for architecture x86_64:\r\n     5023      \"_iconv_ostream_create\", referenced from:\r\n     5024         -exported_symbol[s_list] command line option\r\n     5025    ld: symbol(s) not found for architecture x86_64\r\n  >> 5026    collect2: error: ld returned 1 exit status\r\n  >> 5027    make[5]: *** [libtextstyle.la] Error 1\r\n  >> 5028    make[4]: *** [all] Error 2\r\n  >> 5029    make[3]: *** [all-recursive] Error 1\r\n  >> 5030    make[2]: *** [all] Error 2\r\n  >> 5031    make[1]: *** [all-recursive] Error 1\r\n  >> 5032    make: *** [all] Error 2\r\n\r\nSee build log for details:\r\n  /var/folders/5p/x7ftfty12yndrs3p6ntlk1jc0000gp/T/LDianaAmorim/spack-stage/spack-stage-gettext-0.20.1-id4usuww4umeajzkfakqvyftve2eib7g/spack-build-out.txt\r\n```\r\n\r\n### Information on your system\r\n\r\n```console\r\n$ spack debug report\r\n* **Spack:** 0.14.1-620-723fd5a10\r\n* **Python:** 3.7.3\r\n* **Platform:** darwin-catalina-skylake\r\n```\r\n\r\nMy `/.spack/darwin/packages.yaml` is :\r\n```vim\r\npackages:\r\n  intel-mkl:\r\n    paths:\r\n      intel-mkl@2020.1.216 arch=darwin-catalina-x86_64: /opt/intel\r\n  cmake:\r\n    paths:\r\n      cmake@3.17.0 arch=darwin-catalina-x86_64: /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-x86_64/clang-11.0.3-apple/cmake-3.17.0-6exaq5d4lp7sxf77nhk6kfkuajiy3qwm\r\n  all:\r\n    providers:\r\n      mpi: [mpich, openmpi]\r\n```\r\n\r\nMy `/.spack/var/darwin/compilers.yaml` is:\r\n```vim\r\nLDianaAmorim@LDianaAmorim-M30 ~ % vi ~/.spack/darwin/packages.yaml\r\nLDianaAmorim@LDianaAmorim-M30 ~ % vi ~/.spack/darwin/compilers.yaml \r\n\r\ncompilers:\r\n- compiler:\r\n    spec: clang@11.0.3-apple\r\n    paths:\r\n      cc: /usr/bin/clang\r\n      cxx: /usr/bin/clang++\r\n      f77:\r\n      fc:\r\n    flags: {}\r\n    operating_system: catalina\r\n    target: x86_64\r\n    modules: []\r\n    environment: {unset: []}\r\n    extra_rpaths: []\r\n- compiler:\r\n    spec: gcc@9.3.0\r\n    paths:\r\n      cc: /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-x86_64/clang-11.0.3-apple/gcc-9.3.0-xmd4ztofmwdhv56ho452xzv6uz7nbwyn/bin/gcc\r\n      cxx: /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-x86_64/clang-11.0.3-apple/gcc-9.3.0-xmd4ztofmwdhv56ho452xzv6uz7nbwyn/bin/g++\r\n      f77: /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-x86_64/clang-11.0.3-apple/gcc-9.3.0-xmd4ztofmwdhv56ho452xzv6uz7nbwyn/bin/gfortran\r\n      fc: /Users/LDianaAmorim/Documents/opt/spack/opt/spack/darwin-catalina-x86_64/clang-11.0.3-apple/gcc-9.3.0-xmd4ztofmwdhv56ho452xzv6uz7nbwyn/bin/gfortran\r\n    flags: {}\r\n    operating_system: catalina\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []  \r\n```\r\n\r\n### Additional information\r\n[spack-build-env.txt](https://github.com/spack/spack/files/4482748/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/4482749/spack-build-out.txt)\r\n\r\n### General information\r\n\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "performed_via_github_app": null
}