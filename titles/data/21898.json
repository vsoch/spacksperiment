{
    "url": "https://api.github.com/repos/spack/spack/issues/21898",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/21898/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/21898/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/21898/events",
    "html_url": "https://github.com/spack/spack/issues/21898",
    "id": 815259853,
    "node_id": "MDU6SXNzdWU4MTUyNTk4NTM=",
    "number": 21898,
    "title": "Installation issue: minizip",
    "user": {
        "login": "cessenat",
        "id": 40771352,
        "node_id": "MDQ6VXNlcjQwNzcxMzUy",
        "avatar_url": "https://avatars.githubusercontent.com/u/40771352?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cessenat",
        "html_url": "https://github.com/cessenat",
        "followers_url": "https://api.github.com/users/cessenat/followers",
        "following_url": "https://api.github.com/users/cessenat/following{/other_user}",
        "gists_url": "https://api.github.com/users/cessenat/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/cessenat/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/cessenat/subscriptions",
        "organizations_url": "https://api.github.com/users/cessenat/orgs",
        "repos_url": "https://api.github.com/users/cessenat/repos",
        "events_url": "https://api.github.com/users/cessenat/events{/privacy}",
        "received_events_url": "https://api.github.com/users/cessenat/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-02-24T08:49:47Z",
    "updated_at": "2021-03-20T14:51:04Z",
    "closed_at": "2021-03-20T14:51:04Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "minizip does not link to static ./../../libz.a.\r\nI do not fully understand the logic, so I cannot correct it.\r\n```console\r\n$ spack spec minizip\r\nInput spec\r\n--------------------------------\r\nminizip\r\n\r\nConcretized\r\n--------------------------------\r\n==> Warning: gcc@7.5.0 cannot build optimized binaries for \"zen2\". Using best target possible: \"zen\"\r\nminizip@1.2.11%gcc@7.5.0 patches=7f8df109299dd8e9dc01d6ebe8e95c6ffb41cabc592a5746a0d05c7faade0450,be83617463cefc747d14858eb70f13f0ccccbbeee14191ea3c874c78bd570243 arch=linux-ubuntu18.04-zen\r\n    ^autoconf@2.69%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n        ^m4@1.4.18%gcc@7.5.0+sigsegv patches=3877ab548f88597ab2327a2230ee048d2d07ace1062efe81fc92e91b7f39cd00,fc9b61654a3ba1a8d6cd78ce087e7c96366c290bc8d2c299f09828d793b853c8 arch=linux-ubuntu18.04-zen\r\n            ^libsigsegv@2.12%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n        ^perl@5.32.1%gcc@7.5.0+cpanm+shared+threads arch=linux-ubuntu18.04-zen\r\n            ^berkeley-db@18.1.40%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n            ^gdbm@1.18.1%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n                ^readline@8.0%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n                    ^ncurses@6.2%gcc@7.5.0~symlinks+termlib arch=linux-ubuntu18.04-zen\r\n                        ^pkgconf@1.7.3%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n    ^automake@1.16.3%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n    ^libtool@2.4.6%gcc@7.5.0 arch=linux-ubuntu18.04-zen\r\n    ^zlib@1.2.11%gcc@7.5.0+optimize+pic+shared arch=linux-ubuntu18.04-zen\r\n\r\n$ spack install minizip\r\n==> Warning: gcc@7.5.0 cannot build optimized binaries for \"zen2\". Using best target possible: \"zen\"\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/libsigsegv-2.12-l4tbfmivrfs5zuul6ldtmtuu67nzs6sd\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/berkeley-db-18.1.40-sadpffsvdw4oet2g6akzvchxofsz3u52\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/pkgconf-1.7.3-gkazwxam46qsvgcimw3dg7q56ug725w3\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/zlib-1.2.11-egwcgg2m23u6kiqdrywuxn5tansov3pp\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/m4-1.4.18-i63xbkmc3xwkmz5efawvos4gtby3incc\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/ncurses-6.2-emhiiqvj3auacuw6pebxdpxckml47zed\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/libtool-2.4.6-lkpafhzoslainb6ivsjm64d4voctnrjz\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/readline-8.0-4vxgclcoev7s22lxj3rx5xx3m6w3iffh\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/gdbm-1.18.1-35ah4rucwu7rcliu7dsaovavha36sg2p\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/perl-5.32.1-hsbuwsoplwg5p75t3bayfvuhjachvt75\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/autoconf-2.69-2cb3n4p5gxpgnitmkfuanhr2kqz2sb55\r\n[+] /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/automake-1.16.3-wapg7rl6vmirb2ym5oxnmsl2bvty5qof\r\n==> Installing minizip-1.2.11-hivf2d5bgkl4dakzs7zn3iyrcwloddgg\r\n==> No binary for minizip-1.2.11-hivf2d5bgkl4dakzs7zn3iyrcwloddgg found: installing from source\r\n==> Using cached archive: /home/cessenat/Softs/spack/var/spack/cache/_source-cache/archive/c3/c3e5e9fdd5004dcb542feda5ee4f0ff0744628baf8ed2dd5d66f8ca1197cb1a1.tar.gz\r\n==> minizip: Executing phase: 'autoreconf'\r\n==> minizip: Executing phase: 'configure'\r\n==> minizip: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j2'\r\n\r\n3 errors found in build log:\r\n     205    /bin/bash ./libtool  --tag=CC   --mode=link /home/cessenat/Softs/spack/lib/spack/env/gcc/gcc  -g -O2 ./../../libz.a -version-info 1:0:0  -o l\r\n            ibminizip.la -rpath /home/cessenat/Softs/spack/opt/spack/linux-ubuntu18.04-zen/gcc-7.5.0/minizip-1.2.11-hivf2d5bgkl4dakzs7zn3iyrcwloddgg/lib \r\n            ioapi.lo mztools.lo unzip.lo zip.lo\r\n     206    \r\n     207    *** Warning: Linking the shared library libminizip.la against the\r\n     208    *** static library ./../../libz.a is not portable!\r\n     209    libtool: link: /home/cessenat/Softs/spack/lib/spack/env/gcc/gcc -shared  -fPIC -DPIC  .libs/ioapi.o .libs/mztools.o .libs/unzip.o .libs/zip.o\r\n               ./../../libz.a  -g -O2   -Wl,-soname -Wl,libminizip.so.1 -o .libs/libminizip.so.1.0.0\r\n     210    /usr/bin/ld: ./../../libz.a(deflate.o): relocation R_X86_64_PC32 against symbol `z_errmsg' can not be used when making a shared object; recom\r\n            pile with -fPIC\r\n  >> 211    /usr/bin/ld: final link failed: Bad value\r\n  >> 212    collect2: error: ld returned 1 exit status\r\n     213    Makefile:525: recipe for target 'libminizip.la' failed\r\n  >> 214    make: *** [libminizip.la] Error 1\r\n\r\nSee build log for details:\r\n  /tmp/cessenat/spack-stage/spack-stage-minizip-1.2.11-hivf2d5bgkl4dakzs7zn3iyrcwloddgg/spack-build-out.txt\r\n```\r\n$ spack debug report\r\n* **Spack:** 0.16.0-1079-af988fc32d\r\n* **Python:** 3.8.7\r\n* **Platform:** linux-ubuntu18.04-zen2\r\n* **Concretizer:** original\r\n\r\n* [spack-build-out.txt](https://github.com/spack/spack/files/6034601/spack-build-out.txt)\r\n* [spack-build-env.txt](\r\n[spack-build-env.txt](https://github.com/spack/spack/files/6034606/spack-build-env.txt)\r\n)\r\n\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "performed_via_github_app": null
}