{
    "url": "https://api.github.com/repos/spack/spack/issues/12143",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/12143/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/12143/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/12143/events",
    "html_url": "https://github.com/spack/spack/issues/12143",
    "id": 473112976,
    "node_id": "MDU6SXNzdWU0NzMxMTI5NzY=",
    "number": 12143,
    "title": "libxml2.so link failure against libz.so looking for gzopen64@ZLIB_1.2.3.3",
    "user": {
        "login": "bartlettroscoe",
        "id": 1959736,
        "node_id": "MDQ6VXNlcjE5NTk3MzY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1959736?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bartlettroscoe",
        "html_url": "https://github.com/bartlettroscoe",
        "followers_url": "https://api.github.com/users/bartlettroscoe/followers",
        "following_url": "https://api.github.com/users/bartlettroscoe/following{/other_user}",
        "gists_url": "https://api.github.com/users/bartlettroscoe/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bartlettroscoe/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bartlettroscoe/subscriptions",
        "organizations_url": "https://api.github.com/users/bartlettroscoe/orgs",
        "repos_url": "https://api.github.com/users/bartlettroscoe/repos",
        "events_url": "https://api.github.com/users/bartlettroscoe/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bartlettroscoe/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 512483297,
            "node_id": "MDU6TGFiZWw1MTI0ODMyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-low",
            "name": "impact-low",
            "color": "fef2c0",
            "default": false,
            "description": ""
        },
        {
            "id": 1651822417,
            "node_id": "MDU6TGFiZWwxNjUxODIyNDE3",
            "url": "https://api.github.com/repos/spack/spack/labels/snl-atdm",
            "name": "snl-atdm",
            "color": "e20ddb",
            "default": false,
            "description": "Issues for SNL ATDM usage of spack"
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "scheibelp",
            "id": 1659704,
            "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scheibelp",
            "html_url": "https://github.com/scheibelp",
            "followers_url": "https://api.github.com/users/scheibelp/followers",
            "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
            "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
            "organizations_url": "https://api.github.com/users/scheibelp/orgs",
            "repos_url": "https://api.github.com/users/scheibelp/repos",
            "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scheibelp/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 10,
    "created_at": "2019-07-25T23:36:03Z",
    "updated_at": "2021-02-23T01:01:00Z",
    "closed_at": "2019-08-05T17:42:34Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "**snl-atdm-issue**\r\n\r\nCC: @becker33, @fryeguy52\r\n\r\nWhen trying to link Trilinos with against packages built with Spack with shared libs on an SNL COE RHEL6 machine we get the link errors in Trilinos like:\r\n\r\n`FAILED: packages/seacas/libraries/ioss/src/main/cth_pressure_map`\r\n...\r\n`/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/libxml2-2.9.8-qckwa5f4brssbbwbbtxe7tvdy4dnhwlw/lib/libxml2.so.2: undefined reference to 'gzopen64@ZLIB_1.2.3.3'`\r\n\r\nThe full link line in Trilinos for this was:\r\n\r\n<details>\r\n<summary><b>FULL LINK LINE</b> (click to expand)</summary>\r\n\r\n`/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/openmpi-1.10.1-x2ipjvmrhhgydtcpz5i6s2ln6zjuzvqj/bin/mpicxx  --std=c++11 -g -fopenmp     -O3 -DNDEBUG   packages/seacas/libraries/ioss/src/main/CMakeFiles/cth_pressure_map.dir/cth_pressure_map.C.o packages/seacas/libraries/ioss/src/main/CMakeFiles/cth_pressure_map.dir/vector3d.C.o  -o packages/seacas/libraries/ioss/src/main/cth_pressure_map  -Wl,-rpath,/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/netcdf-4.4.1-zyizihnvwgg6u7yt5pldcj4vfpmqt7ki/lib:/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/hdf5-1.8.21-tmyizpmttnq3d3lpjq3usvuhksngh3zw/lib:/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/zlib-1.2.11-aqhxxoj2tgtjgdkqpxtdyzo6sfwsi6vg/lib:/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/metis-5.1.0-ui6om2qpphok7c5uqdiwqle6om7funue/lib:/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/parmetis-4.0.3-rpa6ngvxiacewkq3twiic2pxh5ea64r6/lib::::::::::::::: packages/seacas/libraries/ioss/src/main/libio_info_lib.a packages/seacas/libraries/ioss/src/init/libIonit.a packages/seacas/libraries/ioss/src/transform/libIotr.a packages/seacas/libraries/ioss/src/heartbeat/libIohb.a packages/seacas/libraries/ioss/src/gen_struc/libIogs.a packages/seacas/libraries/ioss/src/generated/libIogn.a packages/seacas/libraries/ioss/src/visualization/libIovs.a packages/seacas/libraries/ioss/src/cgns/libIocgns.a packages/seacas/libraries/ioss/src/pamgen/libIopg.a packages/seacas/libraries/ioss/src/exo_fac/libIoexo_fac.a packages/seacas/libraries/ioss/src/exo_par/libIopx.a packages/seacas/libraries/ioss/src/exo_fpp/libIofx.a packages/seacas/libraries/ioss/src/exodus/libIoex.a packages/seacas/libraries/ioss/src/libIoss.a packages/seacas/libraries/exodus/libexodus.a /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/netcdf-4.4.1-zyizihnvwgg6u7yt5pldcj4vfpmqt7ki/lib/libnetcdf.so /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/hdf5-1.8.21-tmyizpmttnq3d3lpjq3usvuhksngh3zw/lib/libhdf5_hl.so /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/hdf5-1.8.21-tmyizpmttnq3d3lpjq3usvuhksngh3zw/lib/libhdf5.so /usr/lib64/libdl.so /usr/lib64/libm.so /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/parallel-netcdf-1.11.0-yo2opthsskufdzqep2tgb56ztn2kdya5/lib/libpnetcdf.a packages/pamgen/src/libpamgen_extras.a packages/pamgen/src/libpamgen.a packages/zoltan/src/libzoltan.a -lm packages/kokkos/algorithms/src/libkokkosalgorithms.a packages/kokkos/containers/src/libkokkoscontainers.a packages/kokkos/core/src/libkokkoscore.a /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/cgns-snl-atdm-ep36qaokeela4hyhnwypxehgx5dax4fq/lib/libcgns.a -L/home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/hdf5-1.8.21-tmyizpmttnq3d3lpjq3usvuhksngh3zw/lib -lz /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/hdf5-1.8.21-tmyizpmttnq3d3lpjq3usvuhksngh3zw/lib/libhdf5_hl.a /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/hdf5-1.8.21-tmyizpmttnq3d3lpjq3usvuhksngh3zw/lib/libhdf5.a /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/zlib-1.2.11-aqhxxoj2tgtjgdkqpxtdyzo6sfwsi6vg/lib/libz.so -ldl /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/metis-5.1.0-ui6om2qpphok7c5uqdiwqle6om7funue/lib/libmetis.so /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/parmetis-4.0.3-rpa6ngvxiacewkq3twiic2pxh5ea64r6/lib/libparmetis.so`\r\n\r\n</details>\r\n\r\nThe spack build specs for these packages was:\r\n\r\n```\r\n[+]  qckwa5f              ^libxml2@2.9.8%gcc@7.2.0~python arch=linux-rhel6-x86_64 \r\n[+]  pnczpyw                  ^libiconv@1.15%gcc@7.2.0 arch=linux-rhel6-x86_64 \r\n[+]  cptljw3                  ^pkgconf@1.5.4%gcc@7.2.0 cppflags=\"-fPIC\"  arch=linux-rhel6-x86_64 \r\n[+]  4mfrw3e                  ^xz@5.2.4%gcc@7.2.0 arch=linux-rhel6-x86_64 \r\n[+]  aqhxxoj                  ^zlib@1.2.11%gcc@7.2.0+optimize+pic+shared arch=linux-rhel6-x86_64 \r\n```\r\n\r\nThe generated 'libxml2.so' library showed:\r\n\r\n```\r\n$ nm /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/libxml2-2.9.8-qckwa5f4brssbbwbbtxe7tvdy4dnhwlw/lib/libxml2.so.2 | grep gzopen\r\n                 U gzopen64@@ZLIB_1.2.3.3\r\n```\r\n\r\nThe generated 'libz.so' library showed:\r\n\r\n```\r\n$ nm  /home/rabartl/Spack.base7/atdm-spack/spack/opt/spack/linux-rhel6-x86_64/gcc-7.2.0/zlib-1.2.11-aqhxxoj2tgtjgdkqpxtdyzo6sfwsi6vg/lib/libz.so | grep gzopen\r\n000000000000d5a0 T gzopen\r\n000000000000d590 T gzopen64\r\n000000000000d590 t gzopen64.localalias.1\r\n```\r\n\r\nSo 'libz.so' defines the symbol `gzopen64` and 'libxml2.so' is looking for the symbol `gzopen64@@ZLIB_1.2.3.3`.   What is that?  I have never seen a linker symbol like that.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "performed_via_github_app": null
}