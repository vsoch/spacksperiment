{
    "url": "https://api.github.com/repos/spack/spack/issues/10947",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/10947/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/10947/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/10947/events",
    "html_url": "https://github.com/spack/spack/issues/10947",
    "id": 423402534,
    "node_id": "MDU6SXNzdWU0MjM0MDI1MzQ=",
    "number": 10947,
    "title": "support for dry run (spack spec --dry-run <spec>)",
    "user": {
        "login": "shahzebsiddiqui",
        "id": 12942230,
        "node_id": "MDQ6VXNlcjEyOTQyMjMw",
        "avatar_url": "https://avatars.githubusercontent.com/u/12942230?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shahzebsiddiqui",
        "html_url": "https://github.com/shahzebsiddiqui",
        "followers_url": "https://api.github.com/users/shahzebsiddiqui/followers",
        "following_url": "https://api.github.com/users/shahzebsiddiqui/following{/other_user}",
        "gists_url": "https://api.github.com/users/shahzebsiddiqui/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/shahzebsiddiqui/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/shahzebsiddiqui/subscriptions",
        "organizations_url": "https://api.github.com/users/shahzebsiddiqui/orgs",
        "repos_url": "https://api.github.com/users/shahzebsiddiqui/repos",
        "events_url": "https://api.github.com/users/shahzebsiddiqui/events{/privacy}",
        "received_events_url": "https://api.github.com/users/shahzebsiddiqui/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908756,
            "node_id": "MDU6TGFiZWw3MzkwODc1Ng==",
            "url": "https://api.github.com/repos/spack/spack/labels/feature",
            "name": "feature",
            "color": "84b6eb",
            "default": false,
            "description": null
        },
        {
            "id": 466955297,
            "node_id": "MDU6TGFiZWw0NjY5NTUyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/proposal",
            "name": "proposal",
            "color": "0e8a16",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2019-03-20T18:14:35Z",
    "updated_at": "2021-07-30T13:48:09Z",
    "closed_at": "2021-07-30T13:48:09Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Easybuild has this awesome feature Extended Dry Run https://easybuild.readthedocs.io/en/latest/Extended_dry_run.html which is useful for troubleshooting a software without installing it. It reports details for entire build + install + module generation process without installing the software\r\n\r\n### Rationale\r\n\r\nHaving a feature like ``spack spec --dry-run <spec>`` with short option ``spack spec -d <spec>`` would be cool.\r\n\r\n\r\n### Description\r\n\r\nThere isn't a command option in ``spack spec`` or ``spack install`` that really represents this information provided by easybuild. Not sure if it makes sense to have this option as part of ``spack install -d``  or ``spack spec -d``\r\n\r\n\r\n### Additional information\r\nHere is output of extended dry run for bzip2\r\n\r\n```\r\n[siddis14@hpccpu202 ~]$ eb bzip2-1.0.6.eb -x\r\n== temporary log file in case of crash /tmp/eb-JzrNM1/easybuild-wV40w9.log\r\n\r\nWARNING: Found one or more non-allowed loaded (EasyBuild-generated) modules in current environment:\r\n* Anaconda2/5.3.0\r\n\r\nThis is not recommended since it may affect the installation procedure(s) performed by EasyBuild.\r\n\r\nTo make EasyBuild allow particular loaded modules, use the --allow-loaded-modules configuration option.\r\nTo specify action to take when loaded modules are detected, use --detect-loaded-modules={error,ignore,purge,unload,warn}.\r\n\r\nSee http://easybuild.readthedocs.io/en/latest/Detecting_loaded_modules.html for more information.\r\n\r\n\r\n== processing EasyBuild easyconfig /clust/app/easybuild/2019/commons/software/EasyBuild/3.8.1/lib/python2.7/site-packages/easybuild_easyconfigs-3.8.1-py2.7.egg/easybuild/easyconfigs/b/bzip2/bzip2-1.0.6.eb\r\n\r\nImportant note: the actual build & install procedure that will be performed may diverge\r\n(slightly) from what is outlined below, due to conditions in the easyblock which are\r\nincorrectly handled in a dry run.\r\nAny errors that may occur are ignored and reported as warnings, on a per-step basis.\r\nPlease be aware of this, and only use the information below for quick debugging purposes.\r\n\r\n*** DRY RUN using 'EB_bzip2' easyblock (easybuild.easyblocks.bzip2 @ /clust/app/easybuild/2019/commons/software/EasyBuild/3.8.1/lib/python2.7/site-packages/easybuild_easyblocks-3.8.1-py2.7.egg/easybuild/easyblocks/b/bzip2.pyo) ***\r\n\r\n== building and installing bzip2/1.0.6...\r\nfetching files... [DRY RUN]\r\n\r\n[fetch_step method]\r\nAvailable download URLs for sources/patches:\r\n  * https://fossies.org/linux/misc//$source\r\n\r\nList of sources:\r\n  * bzip2-1.0.6.tar.gz will be downloaded to /home/siddis14/.local/easybuild/sources/b/bzip2/bzip2-1.0.6.tar.gz\r\n\r\nList of patches:\r\n(none)\r\nfile written: /home/siddis14/.local/easybuild/sources/generic/eb_v3.8.1/ConfigureMake/config.guess\r\n\r\n!!!\r\n!!! WARNING: ignoring error \"Failed to read /home/siddis14/.local/easybuild/sources/generic/eb_v3.8.1/ConfigureMake/config.guess: [Errno 2] No such file or directory: '/home/siddis14/.local/easybuild/sources/generic/eb_v3.8.1/ConfigureMake/config.guess'\"\r\n!!!\r\n\r\n\r\ncreating build dir, resetting environment... [DRY RUN]\r\n\r\n[check_readiness_step method]\r\n\r\n[make_builddir method]\r\n\r\n[reset_changes method]\r\n\r\n[handle_iterate_opts method]\r\n\r\nunpacking... [DRY RUN]\r\n\r\n[checksum_step method]\r\n* expected checksum for bzip2-1.0.6.tar.gz: a2848f34fcd5d6cf47def00461fcb528a0484d8edef8208d6d2e2909dc61d9cd\r\n\r\n[extract_step method]\r\n  running command \"tar xzf /home/siddis14/.local/easybuild/sources/b/bzip2/bzip2-1.0.6.tar.gz\"\r\n  (in /home/siddis14/.local/easybuild/build/bzip2/1.0.6/dummy-dummy)\r\n\r\npatching... [DRY RUN]\r\n\r\n[patch_step method]\r\n\r\npreparing... [DRY RUN]\r\n\r\n[prepare_step method]\r\nDefining build environment, based on toolchain (options) and specified dependencies...\r\n\r\n(no modules are loaded for a dummy-dummy toolchain)\r\n\r\nFull list of loaded modules:\r\n  1) eb/2019\r\n  2) Anaconda2/5.3.0\r\n  3) EasyBuild/3.8.1\r\n\r\n\r\nconfiguring... [DRY RUN]\r\n\r\n[configure_step method]\r\n\r\nbuilding... [DRY RUN]\r\n\r\n[build_step method]\r\n  running command \"make -j 40 CC=gcc CFLAGS='-Wall -Winline -O3 -fPIC -g $(BIGFILES)'\"\r\n  (in /home/siddis14/.local/easybuild/build/bzip2/1.0.6/dummy-dummy/bzip2-1.0.6)\r\n\r\ntesting... [DRY RUN]\r\n\r\n[test_step method]\r\n\r\ninstalling... [DRY RUN]\r\n\r\n[stage_install_step method]\r\n\r\n[make_installdir method]\r\n\r\n[install_step method]\r\n  running command \"make install  PREFIX=/home/siddis14/.local/easybuild/software/bzip2/1.0.6\"\r\n  (in /home/siddis14/.local/easybuild/build/bzip2/1.0.6/dummy-dummy/bzip2-1.0.6)\r\n  running command \"make -f Makefile-libbz2_so CC=gcc CFLAGS='-Wall -Winline -O3 -fPIC -g $(BIGFILES)'\"\r\n  (in /home/siddis14/.local/easybuild/build/bzip2/1.0.6/dummy-dummy/bzip2-1.0.6)\r\n\r\n!!!\r\n!!! WARNING: ignoring error \"Creating symlink for libbz2.so failed: [Errno 2] No such file or directory: '/home/siddis14/.local/easybuild/software/bzip2/1.0.6/lib'\"\r\n!!!\r\n\r\n\r\ntaking care of extensions... [DRY RUN]\r\n\r\n[extensions_step method]\r\n\r\npostprocessing... [DRY RUN]\r\n\r\n[post_install_step method]\r\n\r\nsanity checking... [DRY RUN]\r\n\r\n[sanity_check_step method]\r\nSanity check paths - file ['files']\r\n  * bin/bunzip2\r\n  * bin/bzcat\r\n  * bin/bzdiff\r\n  * bin/bzgrep\r\n  * bin/bzip2\r\n  * bin/bzip2recover\r\n  * bin/bzmore\r\n  * include/bzlib.h\r\n  * lib/libbz2.a\r\n  * lib/libbz2.so\r\n  * lib/libbz2.so.1.0.6\r\nSanity check paths - (non-empty) directory ['dirs']\r\n  (none)\r\nSanity check commands\r\n  (none)\r\n\r\ncleaning up... [DRY RUN]\r\n\r\n[cleanup_step method]\r\n\r\n!!!\r\n!!! WARNING: ignoring error \"Cleaning up builddir /home/siddis14/.local/easybuild/build/bzip2/1.0.6/dummy-dummy failed: [Errno 2] No such file or directory: '/home/siddis14/.local/easybuild/build'\"\r\n!!!\r\n\r\n\r\ncreating module... [DRY RUN]\r\n\r\n[make_module_step method]\r\nList of paths that would be searched and added to module file:\r\n\r\n $ACLOCAL_PATH: share/aclocal\r\n $CLASSPATH: *.jar\r\n $CPATH: include\r\n $LD_LIBRARY_PATH: lib, lib32, lib64\r\n $LIBRARY_PATH: lib, lib32, lib64\r\n $MANPATH: man, share/man\r\n $PATH: bin, sbin\r\n $PKG_CONFIG_PATH: lib/pkgconfig, lib32/pkgconfig, lib64/pkgconfig, share/pkgconfig\r\n\r\nGenerating module file /home/siddis14/.local/easybuild/modules/all/bzip2/1.0.6.lua, with contents:\r\n\r\n    help([==[\r\n\r\n    Description\r\n    ===========\r\n    bzip2 is a freely available, patent free, high-quality data compressor. It typically\r\n    compresses files to within 10% to 15% of the best available techniques (the PPM family of statistical\r\n    compressors), whilst being around twice as fast at compression and six times faster at decompression.\r\n\r\n\r\n    More information\r\n    ================\r\n     - Homepage: https://sourceware.org/bzip2\r\n    ]==])\r\n\r\n    whatis([==[Description: bzip2 is a freely available, patent free, high-quality data compressor. It typically\r\n    compresses files to within 10% to 15% of the best available techniques (the PPM family of statistical\r\n    compressors), whilst being around twice as fast at compression and six times faster at decompression.]==])\r\n    whatis([==[Homepage: https://sourceware.org/bzip2]==])\r\n\r\n    local root = \"/home/siddis14/.local/easybuild/software/bzip2/1.0.6\"\r\n\r\n    conflict(\"bzip2\")\r\n\r\n    -- note: glob patterns are not expanded and existence checks for paths are skipped for the statements below due to dry run\r\n    prepend_path(\"ACLOCAL_PATH\", pathJoin(root, \"share/aclocal\"))\r\n    prepend_path(\"CLASSPATH\", pathJoin(root, \"*.jar\"))\r\n    prepend_path(\"CPATH\", pathJoin(root, \"include\"))\r\n    prepend_path(\"LD_LIBRARY_PATH\", pathJoin(root, \"lib\"))\r\n    prepend_path(\"LD_LIBRARY_PATH\", pathJoin(root, \"lib32\"))\r\n    prepend_path(\"LD_LIBRARY_PATH\", pathJoin(root, \"lib64\"))\r\n    prepend_path(\"LIBRARY_PATH\", pathJoin(root, \"lib\"))\r\n    prepend_path(\"LIBRARY_PATH\", pathJoin(root, \"lib32\"))\r\n    prepend_path(\"LIBRARY_PATH\", pathJoin(root, \"lib64\"))\r\n    prepend_path(\"MANPATH\", pathJoin(root, \"man\"))\r\n    prepend_path(\"MANPATH\", pathJoin(root, \"share/man\"))\r\n    prepend_path(\"PATH\", pathJoin(root, \"bin\"))\r\n    prepend_path(\"PATH\", pathJoin(root, \"sbin\"))\r\n    prepend_path(\"PKG_CONFIG_PATH\", pathJoin(root, \"lib/pkgconfig\"))\r\n    prepend_path(\"PKG_CONFIG_PATH\", pathJoin(root, \"lib32/pkgconfig\"))\r\n    prepend_path(\"PKG_CONFIG_PATH\", pathJoin(root, \"lib64/pkgconfig\"))\r\n    prepend_path(\"PKG_CONFIG_PATH\", pathJoin(root, \"share/pkgconfig\"))\r\n    setenv(\"EBROOTBZIP2\", root)\r\n    setenv(\"EBVERSIONBZIP2\", \"1.0.6\")\r\n    setenv(\"EBDEVELBZIP2\", pathJoin(root, \"easybuild/bzip2-1.0.6-easybuild-devel\"))\r\n\r\n    -- Built with EasyBuild version 3.8.1\r\n\r\n\r\npermissions... [DRY RUN]\r\n\r\n[permissions_step method]\r\n\r\npackaging... [DRY RUN]\r\n\r\n[package_step method]\r\n\r\n== COMPLETED: Installation ended successfully\r\n\r\nImportant note: the actual build & install procedure that will be performed may diverge\r\n(slightly) from what is outlined above, due to conditions in the easyblock which are\r\nincorrectly handled in a dry run.\r\nAny errors that may occur are ignored and reported as warnings, on a per-step basis.\r\nPlease be aware of this, and only use the information above for quick debugging purposes.\r\n\r\n\r\n!!!\r\n!!! WARNING: One or more errors were ignored, see warnings above\r\n!!!\r\n\r\n== Build succeeded for 1 out of 1\r\n== Temporary log file(s) /tmp/eb-JzrNM1/easybuild-wV40w9.log* have been removed.\r\n== Temporary directory /tmp/eb-JzrNM1 has been removed.\r\n```\r\n\r\n\r\n-----\r\n\r\n\r\nIf you want to ask a question about the tool (how to use it, what it can currently do, etc.), try the `#general` channel on our Slack first. We have a welcoming community and chances are you'll get your reply faster and without opening an issue.\r\n\r\nOther than that, thanks for taking the time to contribute to Spack!",
    "performed_via_github_app": null
}