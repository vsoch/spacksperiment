{
    "url": "https://api.github.com/repos/spack/spack/issues/12563",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/12563/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/12563/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/12563/events",
    "html_url": "https://github.com/spack/spack/issues/12563",
    "id": 484788933,
    "node_id": "MDU6SXNzdWU0ODQ3ODg5MzM=",
    "number": 12563,
    "title": "Installation issue: mfem@3.4.0 cannot find hypre's lapack dependency if hypre is in packages.yaml",
    "user": {
        "login": "goxberry",
        "id": 321479,
        "node_id": "MDQ6VXNlcjMyMTQ3OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/321479?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/goxberry",
        "html_url": "https://github.com/goxberry",
        "followers_url": "https://api.github.com/users/goxberry/followers",
        "following_url": "https://api.github.com/users/goxberry/following{/other_user}",
        "gists_url": "https://api.github.com/users/goxberry/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/goxberry/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/goxberry/subscriptions",
        "organizations_url": "https://api.github.com/users/goxberry/orgs",
        "repos_url": "https://api.github.com/users/goxberry/repos",
        "events_url": "https://api.github.com/users/goxberry/events{/privacy}",
        "received_events_url": "https://api.github.com/users/goxberry/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "scheibelp",
            "id": 1659704,
            "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scheibelp",
            "html_url": "https://github.com/scheibelp",
            "followers_url": "https://api.github.com/users/scheibelp/followers",
            "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
            "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
            "organizations_url": "https://api.github.com/users/scheibelp/orgs",
            "repos_url": "https://api.github.com/users/scheibelp/repos",
            "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scheibelp/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 2,
    "created_at": "2019-08-24T07:23:26Z",
    "updated_at": "2019-08-30T21:05:08Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install --verbose mfem@3.4.0+libunwind+netcdf+shared\r\n==> apple-libunwind@35.3 : externally installed in /usr\r\n==> apple-libunwind@35.3 : already registered in DB\r\n==> hypre@2.17.0 : externally installed in /usr/local/opt/hypre\r\n==> hypre@2.17.0 : already registered in DB\r\n==> cmake@3.15.2 : externally installed in /usr/local/opt/cmake\r\n==> cmake@3.15.2 : already registered in DB\r\n==> metis is already installed in /Users/goxberry/repos/spack/opt/spack/darwin-mojave-x86_64/clang-10.0.1-apple/metis-5.1.0-3ey7d524jlwosi24e5ogezffennzegwu\r\n==> netcdf@4.6.3 : externally installed in /usr/local/opt/netcdf\r\n==> netcdf@4.6.3 : already registered in DB\r\n==> openmpi@4.0.1 : externally installed in /usr/local/opt/open-mpi\r\n==> openmpi@4.0.1 : already registered in DB\r\n==> zlib@1.2.11 : externally installed in /usr/local/opt/zlib\r\n==> zlib@1.2.11 : already registered in DB\r\n==> Installing mfem\r\n==> Searching for binary cache of mfem\r\n==> Finding buildcaches in /Users/goxberry/repos/spack/var/spack/mirrors/coinhsl-mirror/build_cache\r\n==> No binary for mfem found: installing from source\r\n==> Fetching file:///Users/goxberry/repos/spack/var/spack/mirrors/coinhsl-mirror/mfem/mfem-3.4.0.tar.gz\r\ncurl: (37) Couldn't open file /Users/goxberry/repos/spack/var/spack/mirrors/coinhsl-mirror/mfem/mfem-3.4.0.tar.gz\r\n==> Fetching from file:///Users/goxberry/repos/spack/var/spack/mirrors/coinhsl-mirror/mfem/mfem-3.4.0.tar.gz failed.\r\n==> Fetching https://bit.ly/mfem-3-4\r\n######################################################################## 100.0%\r\n==> Staging archive: /var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/mfem-3.4.0-utpx77ueh2yll3tp3a44chnemu42hkhk/mfem-3-4\r\n==> Created stage in /var/folders/xj/ctmn01vn1gd8m89npx4ht9h40000gn/T/spack-stage/goxberry/mfem-3.4.0-utpx77ueh2yll3tp3a44chnemu42hkhk\r\n==> Applied patch /Users/goxberry/repos/spack/var/spack/repos/builtin/packages/mfem/mfem-3.4.patch\r\n==> Building mfem [Package]\r\n==> Executing phase: 'configure'\r\n==> Error: KeyError: u'No spec with name lapack in hypre@2.17.0%clang@10.0.1-apple~debug+int64+internal-superlu+mpi~shared~superlu-dist arch=darwin-mojave-x86_64'\r\n\r\n/Users/goxberry/repos/spack/var/spack/repos/builtin/packages/mfem/package.py:284, in configure:\r\n        281            options += ['MPICXX=%s' % spec['mpi'].mpicxx]\r\n        282            hypre = spec['hypre']\r\n        283            # The hypre package always links with 'blas' and 'lapack'.\r\n  >>    284            all_hypre_libs = hypre.libs + hypre['lapack'].libs + \\\r\n        285                hypre['blas'].libs\r\n        286            options += [\r\n        287                'HYPRE_OPT=-I%s' % hypre.prefix.include,\r\n```\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n\r\nI'm running macOS 10.14.6, attempting to build with Apple Clang 10.0.1.\r\n\r\nand, if relevant, post or attach:\r\n\r\n- `packages.yaml`\r\n```yaml\r\npackages:\r\n  cmake:\r\n    paths:\r\n      cmake@3.15.2 %clang@10.0.1-apple: /usr/local/opt/cmake\r\n  hypre:\r\n    paths:\r\n      hypre@2.17.0+int64+internal-superlu+mpi~shared~superlu-dist: /usr/local/opt/hypre\r\n  netcdf:\r\n    paths:\r\n      netcdf@4.6.3+hdf4~mpi~parallel-netcdf %clang@10.0.1-apple: /usr/local/opt/netcdf\r\n  openblas:\r\n    paths:\r\n      openblas@0.3.7 %clang@10.0.1-apple: /usr/local/opt/openblas\r\n  openmpi:\r\n    paths:\r\n      openmpi@4.0.1+cxx_exceptions %clang@10.0.1-apple: /usr/local/opt/open-mpi\r\n  zlib:\r\n    paths:\r\n      zlib@1.2.11 %clang@10.0.1-apple: /usr/local/opt/zlib\r\n  all:\r\n    compiler: [clang@10.0.1-apple, clang, gcc]\r\n    providers:\r\n      awk: [gawk]\r\n      blas: [openblas, atlas, intel-mkl, netlib-lapack]\r\n      daal: [intel-daal]\r\n      elf: [libelf, elftoolchain, elfutils]\r\n      golang: [gcc]\r\n      gl: [opengl, mesa]\r\n      ipp: [intel-ipp]\r\n      java: [jdk]\r\n      lapack: [openblas, atlas, intel-mkl, netlib-lapack]\r\n      mkl: [intel-mkl]\r\n      mpe: [mpe2]\r\n      mpi: [openmpi, mpich, intel-mpi]\r\n      opencl: [pocl]\r\n      openfoam: [openfoam-com, openfoam-org, foam-extend]\r\n      pil: [py-pillow]\r\n      pkgconfig: [pkgconf, pkg-config]\r\n      scalapack: [netlib-scalapack, intel-mkl]\r\n      szip: [libszip, libaec]\r\n      tbb: [intel-tbb]\r\n      jpeg: [libjpeg-turbo, libjpeg]\r\n      cmake: [cmake%clang]\r\n    paths: {}\r\n    modules: {}\r\n    buildable: true\r\n    version: []\r\n```\r\n\r\n### Additional information\r\n\r\nThis error does not occur if I remove `hypre` from my `packages.yaml` and build `hypre` in Spack from source.",
    "performed_via_github_app": null
}