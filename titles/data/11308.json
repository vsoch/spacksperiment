{
    "url": "https://api.github.com/repos/spack/spack/issues/11308",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/11308/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/11308/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/11308/events",
    "html_url": "https://github.com/spack/spack/issues/11308",
    "id": 437681034,
    "node_id": "MDU6SXNzdWU0Mzc2ODEwMzQ=",
    "number": 11308,
    "title": "Installation sucessful but spack install result in InstallError: exception",
    "user": {
        "login": "vkallesh",
        "id": 10962922,
        "node_id": "MDQ6VXNlcjEwOTYyOTIy",
        "avatar_url": "https://avatars.githubusercontent.com/u/10962922?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/vkallesh",
        "html_url": "https://github.com/vkallesh",
        "followers_url": "https://api.github.com/users/vkallesh/followers",
        "following_url": "https://api.github.com/users/vkallesh/following{/other_user}",
        "gists_url": "https://api.github.com/users/vkallesh/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/vkallesh/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/vkallesh/subscriptions",
        "organizations_url": "https://api.github.com/users/vkallesh/orgs",
        "repos_url": "https://api.github.com/users/vkallesh/repos",
        "events_url": "https://api.github.com/users/vkallesh/events{/privacy}",
        "received_events_url": "https://api.github.com/users/vkallesh/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 512483297,
            "node_id": "MDU6TGFiZWw1MTI0ODMyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-low",
            "name": "impact-low",
            "color": "fef2c0",
            "default": false,
            "description": ""
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "scheibelp",
            "id": 1659704,
            "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scheibelp",
            "html_url": "https://github.com/scheibelp",
            "followers_url": "https://api.github.com/users/scheibelp/followers",
            "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
            "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
            "organizations_url": "https://api.github.com/users/scheibelp/orgs",
            "repos_url": "https://api.github.com/users/scheibelp/repos",
            "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scheibelp/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 2,
    "created_at": "2019-04-26T13:46:06Z",
    "updated_at": "2019-07-19T23:42:56Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "### Summary\r\nI ran spack install, below observations were seen:\r\n\r\n1) spack install is not installing to default location of spack/opt path (when make('install') entry under package.py) instead failing with permission error while installing /usr/ path  - Which is not not right\r\n\r\n2) If install prefix option is given then Installation sucessful but spack install output result in InstallError: exception\r\n\r\nNote: I passed local mirror code path as input for spack create command\r\n\r\nExpected Result\r\ninstall package under spack/opt/... directory\r\n\r\nActual Result\r\n==> Error: InstallError: Install failed for blis.  Nothing was installed!\r\n\r\n/home/spack_user/GP/spack/lib/spack/spack/package.py:1774, in sanity_check_prefix:\r\n       1771        installed.difference_update(\r\n       1772            spack.store.layout.hidden_file_paths)\r\n       1773        if not installed:\r\n  >>   1774            raise InstallError(\r\n       1775                \"Install failed for %s.  Nothing was installed!\" % self.name)\r\n\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack create -t generic -f file:///home/amd/spack-mirror-2019-04-21/blis/blis_0.5.2.tar.gz\r\n\r\n$ spack install blis@0.5.2 %gcc@7.3.0\r\n...\r\n```\r\n\r\n### Error Message\r\n\r\nIf Spack reported an error, provide the error message. If it did not report an error\r\nbut the output appears incorrect, provide the incorrect output. If there was no error\r\nmessage and no output but the result is incorrect, describe how it does not match\r\nwhat you expect. To provide more information you might re-run the commands with \r\nthe additional -d/--stacktrace flags:\r\n```console\r\n$ spack -d --stacktrace install blis@0.5.2 %gcc@7.3.0\r\n\r\nlib/spack/spack/package.py:1534 ==> [2019-04-26-19:08:11.565849] Executing phase: 'install'\r\nlib/spack/llnl/util/lock.py:334 ==> [2019-04-26-19:08:21.988505] WRITE LOCK: /home/spack_user/GP/spack/opt/spack/.spack-db/prefix_lock[2403057116419638959:1] [Released]\r\nlib/spack/llnl/util/lock.py:334 ==> [2019-04-26-19:08:21.988762] WRITE LOCK: /home/spack_user/GP/spack/var/spack/stage/.lock[3669865094975467777:1] [Released]\r\nlib/spack/spack/error.py:55 ==> [2019-04-26-19:08:21.990850] Error: InstallError: Install failed for blis.  Nothing was installed!\r\n\r\n/home/spack_user/GP/spack/lib/spack/spack/package.py:1774, in sanity_check_prefix:\r\n       1771        installed.difference_update(\r\n       1772            spack.store.layout.hidden_file_paths)\r\n       1773        if not installed:\r\n  >>   1774            raise InstallError(\r\n       1775                \"Install failed for %s.  Nothing was installed!\" % self.name)\r\n\r\nSee build log for details:\r\n  /home/spack_user/GP/spack/var/spack/stage/blis-0.5.2-ikzl63sokwgv7jkzwrakhqauyuznh267/spack-build.out\r\nTraceback (most recent call last):\r\n  File \"/home/spack_user/GP/spack/lib/spack/spack/build_environment.py\", line 767, in child_process\r\n    return_value = function()\r\n  File \"/home/spack_user/GP/spack/lib/spack/spack/package.py\", line 1539, in build_process\r\n    phase(self.spec, self.prefix)\r\n  File \"/home/spack_user/GP/spack/lib/spack/spack/package.py\", line 106, in phase_wrapper\r\n    callback(instance)\r\n  File \"/home/spack_user/GP/spack/lib/spack/spack/package.py\", line 1775, in sanity_check_prefix\r\n    \"Install failed for %s.  Nothing was installed!\" % self.name)\r\nInstallError: Install failed for blis.  Nothing was installed!\r\n\r\n...\r\n```\r\nthat activate the full debug output. \r\n\r\n\r\n### Information on your system\r\n\r\nThis includes:\r\n\r\n 1. which platform you are using\r\nspack_user@trukvm23p10:~$ uname -a\r\nLinux trukvm23p10 4.15.0-46-generic #49~16.04.1-Ubuntu SMP Tue Feb 12 17:45:24 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\nspack_user@trukvm23p10:~$\r\n\r\n 2. any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.)\r\nSource code path: https://github.com/amd/blis\r\n\r\npackage.py contents:\r\nfrom spack import *\r\n\r\n\r\nclass Blis(Package):\r\n    \"\"\"blis package\"\"\"\r\n\r\n    # FIXME: Add a proper url for your package's homepage here.\r\n    homepage = \"http://www.example.com\"\r\n    url      = \"file:///home/spack_user/spack_mirror/blis/blis_0.5.2.tar.gz\"\r\n\r\n    version('0.5.2', sha256='a796642c355271a1f03493adf1aa71a0e7111214f5d861488b6afa6cae64d72c')\r\n\r\n    # FIXME: Add dependencies if required.\r\n    # depends_on('foo')\r\n\r\n    def install(self, spec, prefix):\r\n        # FIXME: Unknown build system\r\n        configure('--prefix=/home/spack_user/GP/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/blis-0.5.2-a796642c355271a1f03493adf1aa71a0e7111214f5d861488b6afa6cae64d72c','CFLAGS=-Wno-error=maybe-uninitialized', ' auto')\r\n        make()\r\n        make('install')\r\n\r\n\r\n-----\r\n\r\nWe encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively!\r\n\r\nIf you want to ask a question about the tool (how to use it, what it can currently do, etc.), try the `#general` channel on our Slack first. We have a welcoming community and chances are you'll get your reply faster and without opening an issue.\r\n\r\nOther than that, thanks for taking the time to contribute to Spack!\r\n",
    "performed_via_github_app": null
}