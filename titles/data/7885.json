{
    "url": "https://api.github.com/repos/spack/spack/issues/7885",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/7885/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/7885/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/7885/events",
    "html_url": "https://github.com/spack/spack/issues/7885",
    "id": 317364629,
    "node_id": "MDU6SXNzdWUzMTczNjQ2Mjk=",
    "number": 7885,
    "title": "Problem installing flang",
    "user": {
        "login": "aprokop",
        "id": 7297887,
        "node_id": "MDQ6VXNlcjcyOTc4ODc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/7297887?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/aprokop",
        "html_url": "https://github.com/aprokop",
        "followers_url": "https://api.github.com/users/aprokop/followers",
        "following_url": "https://api.github.com/users/aprokop/following{/other_user}",
        "gists_url": "https://api.github.com/users/aprokop/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/aprokop/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/aprokop/subscriptions",
        "organizations_url": "https://api.github.com/users/aprokop/orgs",
        "repos_url": "https://api.github.com/users/aprokop/repos",
        "events_url": "https://api.github.com/users/aprokop/events{/privacy}",
        "received_events_url": "https://api.github.com/users/aprokop/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 654034395,
            "node_id": "MDU6TGFiZWw2NTQwMzQzOTU=",
            "url": "https://api.github.com/repos/spack/spack/labels/clang",
            "name": "clang",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "scheibelp",
            "id": 1659704,
            "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scheibelp",
            "html_url": "https://github.com/scheibelp",
            "followers_url": "https://api.github.com/users/scheibelp/followers",
            "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
            "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
            "organizations_url": "https://api.github.com/users/scheibelp/orgs",
            "repos_url": "https://api.github.com/users/scheibelp/repos",
            "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scheibelp/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 9,
    "created_at": "2018-04-24T19:32:01Z",
    "updated_at": "2018-06-07T01:28:26Z",
    "closed_at": "2018-06-07T01:28:26Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "@junghans \r\n\r\n### Expected Result\r\n\r\n`$ spack install flang` completes\r\n\r\n### Actual Result\r\n\r\nWhat happened instead\r\n```\r\n<snip>\r\n==> Successfully installed llvm\r\n  Fetch: 24.09s.  Build: 15m 56.54s.  Total: 16m 20.63s.\r\n[+] /scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6\r\n==> Installing flang\r\n==> Trying to clone git repository: https://github.com/flang-compiler/flang on branch master\r\n==> No checksum needed when fetching with git\r\n==> Already staged flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o in /scratch/spack/var/spack/stage/flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o\r\n==> No patches needed for flang\r\n==> Building flang [CMakePackage]\r\n==> Executing phase: 'cmake'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    'cmake' '/scratch/spack/var/spack/stage/flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o/flang' '-G' 'Unix Makefiles' '-DCMAKE_INSTALL_PREFIX:PATH=/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o' '-DCMAKE_BUILD_TYPE:STRING=RelWithDebInfo' '-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH:BOOL=FALSE' '-DCMAKE_INSTALL_RPATH:STRING=/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o/lib:/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o/lib64:/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/lib:/usr/lib' '-DCMAKE_PREFIX_PATH:STRING=/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6' '-DWITH_WERROR=OFF' '-DCMAKE_C_COMPILER=/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/bin/clang' '-DCMAKE_CXX_COMPILER=/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/bin/clang++' '-DCMAKE_Fortran_COMPILER=/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/bin/flang' '-DFLANG_LIBOMP=/scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/lib/libomp.so'\r\n\r\n1 error found in build log:\r\n     [ ... ]\r\n     47    -- Found assembler: /scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/bin/clang\r\n     48    -- The Fortran compiler identification is unknown\r\n     49    -- Detecting Fortran compiler ABI info\r\n     50    -- Detecting Fortran compiler ABI info - failed\r\n     51    -- Checking whether /scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/bin/flang supports Fortran 90\r\n     52    -- Checking whether /scratch/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/llvm-5.0.0-i66qkkvc7d6pnsdx5vjamnxuicye44b6/bin/flang supports Fortran 90 -- no\r\n  >> 53    CMake Error: The following variables are used in this project, but they are set to NOTFOUND.\r\n     54    Please set them or make sure they are set and tested correctly in the CMake files:\r\n     55    LIBPGMATH\r\n     56        linked by target \"flangrti_shared\" in directory /scratch/spack/var/spack/stage/flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o/flang/runtime/flangrti\r\n     57    \r\n     58    -- Configuring incomplete, errors occurred!\r\n     59    See also \"/tmp/root/spack-stage/spack-stage-Bny4m0/flang/spack-build/CMakeFiles/CMakeOutput.log\".\r\n\r\nSee build log for details:\r\n  /scratch/spack/var/spack/stage/flang-develop-i6oboxtz3nbcsdlzxy4jfdo5nchv5o3o/flang/spack-build.out\r\n\r\n```\r\n\r\n### Steps to reproduce the issue\r\n\r\nCan just run `docker build` with the following Dockerfile:\r\n```\r\nFROM ubuntu:16.04\r\n\r\nARG NPROC=14\r\n\r\nRUN apt-get update && apt-get install -y \r\n        build-essential \\\r\n        gfortran \\\r\n        libopenmpi-dev \\\r\n        curl \\\r\n        cmake \\\r\n        git \\\r\n        wget \\\r\n        vim \\\r\n        autoconf \\\r\n        lcov \\\r\n        valgrind \\\r\n        libssl-dev \\\r\n        libpng-dev \\\r\n        libfreetype6-dev \\\r\n        libxft-dev \\\r\n        libsqlite3-dev \\\r\n        libbz2-dev \\\r\n        libatlas-base-dev \\\r\n        zlib1g-dev \\\r\n        python2.7-dev \\\r\n        tmux \\\r\n        unzip \\\r\n        environment-modules \\\r\n        && \\\r\n    apt-get clean && \\\r\n    rm -rf /var/lib/apt/lists/* && \\\r\n    ln -s /usr/bin/python2.7 /usr/bin/python\r\n\r\nENV PREFIX=/scratch\r\nRUN mkdir -p ${PREFIX} && \\\r\n    cd ${PREFIX} && \\\r\n    mkdir archive && \\\r\n    mkdir source && \\\r\n    mkdir build && \\\r\n    mkdir install\r\n\r\nENV HOME=/root\r\n\r\nENV SPACK_ROOT=${PREFIX}/spack\r\n\r\n# Install Spack (specific hash)\r\nRUN export SPACK_HASH=041aa143db6964575625f1849de639541efb83a5 && \\\r\n    export SPACK_URL=\"https://github.com/spack/spack/archive/${SPACK_HASH}.tar.gz\" && \\\r\n    export SPACK_INSTALL_DIR=\"${SPACK_ROOT}\" && \\\r\n    export SPACK_ARCHIVE=\"${PREFIX}/archive/spack-${SPACK_HASH}.tar.gz\" && \\\r\n    wget --quiet ${SPACK_URL} --output-document=${SPACK_ARCHIVE} && \\\r\n    mkdir -p ${SPACK_INSTALL_DIR} && \\\r\n    tar -xf ${SPACK_ARCHIVE} -C ${SPACK_INSTALL_DIR} --strip-components=1 && \\\r\n    rm -rf ${SPACK_ARCHIVE} && \\\r\n    mkdir -p ${HOME}/.spack\r\n\r\n# Load Spack\r\nENV PATH=\"${SPACK_ROOT}/bin:${PATH}\"\r\nRUN echo \"source $SPACK_ROOT/share/spack/setup-env.sh\" >> ${HOME}/.bashrc\r\nRUN echo \"source /usr/share/modules/init/bash\"         >> ${HOME}/.bashrc\r\n\r\n# Install flang\r\nRUN spack spec -I flang && spack install flang && spack clean -a\r\n```\r\n\r\n### Information on your system\r\n\r\nUbuntu 16.04 in Docker\r\n",
    "performed_via_github_app": null
}