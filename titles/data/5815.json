{
    "url": "https://api.github.com/repos/spack/spack/issues/5815",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/5815/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/5815/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/5815/events",
    "html_url": "https://github.com/spack/spack/issues/5815",
    "id": 266651466,
    "node_id": "MDU6SXNzdWUyNjY2NTE0NjY=",
    "number": 5815,
    "title": "libxml2 fails with Intel 16.0.2",
    "user": {
        "login": "certik",
        "id": 20568,
        "node_id": "MDQ6VXNlcjIwNTY4",
        "avatar_url": "https://avatars.githubusercontent.com/u/20568?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/certik",
        "html_url": "https://github.com/certik",
        "followers_url": "https://api.github.com/users/certik/followers",
        "following_url": "https://api.github.com/users/certik/following{/other_user}",
        "gists_url": "https://api.github.com/users/certik/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/certik/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/certik/subscriptions",
        "organizations_url": "https://api.github.com/users/certik/orgs",
        "repos_url": "https://api.github.com/users/certik/repos",
        "events_url": "https://api.github.com/users/certik/events{/privacy}",
        "received_events_url": "https://api.github.com/users/certik/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2017-10-18T21:41:10Z",
    "updated_at": "2017-10-19T06:32:38Z",
    "closed_at": "2017-10-19T06:32:38Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I am now trying to build `amrex` on another machine. I setup spack for intel compilers (to load the proper module, etc.). Lots of packages build just fine (including, e.g. `m4` which failed in #5705 and we had to fix it in spack). But the `libxml2` packages fails with:\r\n```\r\n$ spack install --restage amrex%intel@16.0.2\r\n...\r\n==> Executing phase: 'autoreconf'\r\n==> Executing phase: 'configure'\r\n==> Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 2:\r\n    'make' '-j32'\r\n\r\n4 errors found in build log:\r\n     [ ... ]\r\n     328   icc: command line warning #10006: ignoring unknown option '-Wnested-externs'\r\n     329   icc: command line warning #10006: ignoring unknown option '-Wredundant-decls'\r\n     330   HTMLparser.c(5409): warning #2338: this switch statement does not have a default clause\r\n     331             switch (ctxt->instate) {\r\n     332             ^\r\n     333   \r\n  >> 334   xmlIO.c(1450): error: identifier \"LZMA_OK\" is undefined\r\n     335         ret =  (__libxml2_xzclose((xzFile) context) == LZMA_OK ) ? 0 : -1;\r\n     336                                                        ^\r\n     337   \r\n     338   xmlIO.c(2044): warning #3179: deprecated conversion of string literal to char* (should be const char*)\r\n     339         char *                 content_type = (char *) \"text/xml\";\r\n     340                                               ^\r\n     [ ... ]\r\n     342   xmlIO.c(2056): warning #3179: deprecated conversion of string literal to char* (should be const char*)\r\n     343        content_encoding = (char *) \"Content-Encoding: gzip\";\r\n     344                           ^\r\n     345   \r\n     346   compilation aborted for xmlIO.c (code 2)\r\n     347   Makefile:1248: recipe for target 'xmlIO.lo' failed\r\n  >> 348   make[2]: *** [xmlIO.lo] Error 1\r\n     349   make[2]: *** Waiting for unfinished jobs....\r\n     350   icc: command line warning #10006: ignoring unknown option '-Wno-format-extra-args'\r\n     351   icc: command line warning #10006: ignoring unknown option '-Wcast-align'\r\n     352   icc: command line warning #10006: ignoring unknown option '-Waggregate-return'\r\n     353   icc: command line warning #10006: ignoring unknown option '-Wnested-externs'\r\n     354   icc: command line warning #10006: ignoring unknown option '-Wredundant-decls'\r\n     [ ... ]\r\n     981   trionan.c(218): warning #177: function \"trio_is_negative\" was declared but never referenced\r\n     982     trio_is_negative\r\n     983     ^\r\n     984   \r\n     985   make[2]: Leaving directory '/home/certik/tmp/spack-stage/spack-stage-dmGFaF/libxml2-2.9.4'\r\n     986   Makefile:1440: recipe for target 'all-recursive' failed\r\n  >> 987   make[1]: *** [all-recursive] Error 1\r\n     988   make[1]: Leaving directory '/home/certik/tmp/spack-stage/spack-stage-dmGFaF/libxml2-2.9.4'\r\n     989   Makefile:859: recipe for target 'all' failed\r\n  >> 990   make: *** [all] Error 2\r\n\r\nSee build log for details:\r\n  /home/certik/repos/spack/var/spack/stage/libxml2-2.9.4-j26m2sopxpelbb2vhdtbfdb7gdhczbl2/libxml2-2.9.4/spack-build.out\r\n```\r\nThe missing `LZMA_OK` symbol I think comes from the `xz` package, that was installed successfully by spack already. Here is the spec:\r\n```\r\n$ spack spec amrex%intel@16.0.2\r\nInput spec\r\n--------------------------------\r\namrex%intel@16.0.2\r\n\r\nNormalized\r\n--------------------------------\r\namrex%intel@16.0.2\r\n    ^cmake\r\n\r\nConcretized\r\n--------------------------------\r\namrex@17.06%intel@16.0.2 build_type=RelWithDebInfo ~debug dims=3 +fortran+mpi~openmp~particles prec=DOUBLE arch=linux-ubuntu16.04-x86_64 \r\n    ^cmake@3.9.4%intel@16.0.2~doc+ncurses+openssl+ownlibs~qt arch=linux-ubuntu16.04-x86_64 \r\n        ^ncurses@6.0%intel@16.0.2 patches=f84b2708a42777aadcc7f502a261afe10ca5646a51c1ef8b5e60d2070d926b57 ~symlinks arch=linux-ubuntu16.04-x86_64 \r\n            ^pkg-config@0.29.2%intel@16.0.2+internal_glib arch=linux-ubuntu16.04-x86_64 \r\n        ^openssl@1.0.2k%intel@16.0.2 arch=linux-ubuntu16.04-x86_64 \r\n            ^zlib@1.2.11%intel@16.0.2+pic+shared arch=linux-ubuntu16.04-x86_64 \r\n    ^openmpi@2.1.1%intel@16.0.2~cuda fabrics= ~java schedulers= ~sqlite3~thread_multiple+vt arch=linux-ubuntu16.04-x86_64 \r\n        ^hwloc@1.11.7%intel@16.0.2~cuda+libxml2+pci arch=linux-ubuntu16.04-x86_64 \r\n            ^libpciaccess@0.13.5%intel@16.0.2 arch=linux-ubuntu16.04-x86_64 \r\n                ^libtool@2.4.6%intel@16.0.2 arch=linux-ubuntu16.04-x86_64 \r\n                    ^m4@1.4.18%intel@16.0.2 patches=3877ab548f88597ab2327a2230ee048d2d07ace1062efe81fc92e91b7f39cd00 +sigsegv arch=linux-ubuntu16.04-x86_64 \r\n                        ^libsigsegv@2.11%intel@16.0.2 arch=linux-ubuntu16.04-x86_64 \r\n                ^util-macros@1.19.1%intel@16.0.2 arch=linux-ubuntu16.04-x86_64 \r\n            ^libxml2@2.9.4%intel@16.0.2~python arch=linux-ubuntu16.04-x86_64 \r\n                ^xz@5.2.3%intel@16.0.2 arch=linux-ubuntu16.04-x86_64 \r\n```\r\nNote that `libxml2` builds just fine with Intel 17.0.1 on another machine.",
    "performed_via_github_app": null
}