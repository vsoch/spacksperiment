{
    "url": "https://api.github.com/repos/spack/spack/issues/20232",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/20232/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/20232/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/20232/events",
    "html_url": "https://github.com/spack/spack/issues/20232",
    "id": 756277577,
    "node_id": "MDU6SXNzdWU3NTYyNzc1Nzc=",
    "number": 20232,
    "title": "Installation issue: amrex+cuda~fortran+openmp+particles @20.12",
    "user": {
        "login": "eschnett",
        "id": 213514,
        "node_id": "MDQ6VXNlcjIxMzUxNA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/213514?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/eschnett",
        "html_url": "https://github.com/eschnett",
        "followers_url": "https://api.github.com/users/eschnett/followers",
        "following_url": "https://api.github.com/users/eschnett/following{/other_user}",
        "gists_url": "https://api.github.com/users/eschnett/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/eschnett/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/eschnett/subscriptions",
        "organizations_url": "https://api.github.com/users/eschnett/orgs",
        "repos_url": "https://api.github.com/users/eschnett/repos",
        "events_url": "https://api.github.com/users/eschnett/events{/privacy}",
        "received_events_url": "https://api.github.com/users/eschnett/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-12-03T15:06:57Z",
    "updated_at": "2020-12-04T09:16:37Z",
    "closed_at": "2020-12-04T09:16:37Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "<!-- Thanks for taking the time to report this build failure. To proceed with the report please:\r\n\r\n1. Title the issue \"Installation issue: <name-of-the-package>\".\r\n2. Provide the information required below.\r\n\r\nWe encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively! -->\r\n\r\n### Steps to reproduce the issue\r\n\r\n<!-- Fill in the exact spec you are trying to build and the relevant part of the error message -->\r\n```console\r\n$ spack install amrex+cuda~fortran+openmp+particles\r\n...\r\n     99     cd /tmp/root/spack-stage/spack-stage-amrex-20.12-jqne5t32rxkzodklwo\r\n            eqfefn44ldtwkw/spack-build-jqne5t3/Src && /opt/software/linux-ubunt\r\n            u20.04-haswell/gcc-9.3.0/cuda-11.1.0-n5wch2ga6sejvwicpkxlx26y4vxj77\r\n            22/bin/nvcc -ccbin=/usr/bin/g++ -DAMREX_GIT_VERSION=\\\"20.12.0\\\" -DA\r\n            MREX_GPU_MAX_THREADS=256 -DAMREX_Linux -DAMREX_PARTICLES -DAMREX_SP\r\n            ACEDIM=3 -DAMREX_USE_CUDA -DAMREX_USE_GPU -DAMREX_USE_MPI -DAMREX_U\r\n            SE_NVML -DAMREX_USE_OMP -DAMREX_XSDK -DBL_COALESCE_FABS -DBL_Linux\r\n            -DBL_NO_FORT -DBL_SPACEDIM=3 -DBL_USE_MPI -DBL_USE_OMP -I/tmp/root/\r\n            spack-stage/spack-stage-amrex-20.12-jqne5t32rxkzodklwoeqfefn44ldtwk\r\n            w/spack-src/Src/Base -I/tmp/root/spack-stage/spack-stage-amrex-20.1\r\n            2-jqne5t32rxkzodklwoeqfefn44ldtwkw/spack-src/Src/Boundary -I/tmp/ro\r\n            ot/spack-stage/spack-stage-amrex-20.12-jqne5t32rxkzodklwoeqfefn44ld\r\n            twkw/spack-src/Src/AmrCore -I/tmp/root/spack-stage/spack-stage-amre\r\n            x-20.12-jqne5t32rxkzodklwoeqfefn44ldtwkw/spack-src/Src/Amr -I/tmp/r\r\n            oot/spack-stage/spack-stage-amrex-20.12-jqne5t32rxkzodklwoeqfefn44l\r\n            dtwkw/spack-src/Src/LinearSolvers/MLMG -I/tmp/root/spack-stage/spac\r\n            k-stage-amrex-20.12-jqne5t32rxkzodklwoeqfefn44ldtwkw/spack-src/Src/\r\n            LinearSolvers/Projections -I/tmp/root/spack-stage/spack-stage-amrex\r\n            -20.12-jqne5t32rxkzodklwoeqfefn44ldtwkw/spack-src/Src/Particle -isy\r\n            stem=/usr/lib/x86_64-linux-gnu/openmpi/include/openmpi -isystem=/us\r\n            r/lib/x86_64-linux-gnu/openmpi/include  -m64 --expt-relaxed-constex\r\n            pr --expt-extended-lambda -Wno-deprecated-gpu-targets -gencode=arch\r\n            =compute_30,code=sm_30 -gencode=arch=compute_35,code=sm_35 -gencode\r\n            =arch=compute_50,code=sm_50 -gencode=arch=compute_52,code=sm_52 -ge\r\n            ncode=arch=compute_60,code=sm_60 -gencode=arch=compute_61,code=sm_6\r\n            1 -gencode=arch=compute_70,code=sm_70 -gencode=arch=compute_75,code\r\n            =sm_75 -gencode=arch=compute_70,code=compute_70 -gencode=arch=compu\r\n            te_75,code=compute_75 -maxrregcount=255 -Xcudafe --diag_suppress=es\r\n            a_on_defaulted_function_ignored --use_fast_math -Xcudafe --display_\r\n            error_number --Wext-lambda-captures-this --forward-unknown-to-host-\r\n            compiler -O3 -DNDEBUG   -Xcompiler=-fopenmp -Xcompiler=-Werror=retu\r\n            rn-type -Xcompiler -pthread -std=c++11 -x cu -dc /tmp/root/spack-st\r\n            age/spack-stage-amrex-20.12-jqne5t32rxkzodklwoeqfefn44ldtwkw/spack-\r\n            src/Src/Base/AMReX_Utility.cpp -o CMakeFiles/amrex.dir/Base/AMReX_U\r\n            tility.cpp.o\r\n     100    nvcc fatal   : Unsupported gpu architecture 'compute_30'\r\n...\r\n```\r\n\r\n### Information on your system\r\n\r\nI built this inside a Docker container based on Ubuntu 20.04. The root of the problem seems to be (as the web tells me) that CUDA 11 (installed by Spack) doesn't support `compute_30` any more. I've looked in the source code of AMReX and of Spack to see who decides that `compute_30` should be used (see line 99 of the error messages), but I found no clue. Any pointer would be appreciated.\r\n\r\nThe complete error message is available at <https://gist.github.com/eschnett/d2fbff0fa94a8861b98c496f0432cf1a>.",
    "performed_via_github_app": null
}