{
    "url": "https://api.github.com/repos/spack/spack/issues/15746",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/15746/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/15746/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/15746/events",
    "html_url": "https://github.com/spack/spack/issues/15746",
    "id": 589914012,
    "node_id": "MDU6SXNzdWU1ODk5MTQwMTI=",
    "number": 15746,
    "title": "openmpi links host libgpfs.so with no way to exclude",
    "user": {
        "login": "anderbubble",
        "id": 350294,
        "node_id": "MDQ6VXNlcjM1MDI5NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/350294?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/anderbubble",
        "html_url": "https://github.com/anderbubble",
        "followers_url": "https://api.github.com/users/anderbubble/followers",
        "following_url": "https://api.github.com/users/anderbubble/following{/other_user}",
        "gists_url": "https://api.github.com/users/anderbubble/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/anderbubble/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/anderbubble/subscriptions",
        "organizations_url": "https://api.github.com/users/anderbubble/orgs",
        "repos_url": "https://api.github.com/users/anderbubble/repos",
        "events_url": "https://api.github.com/users/anderbubble/events{/privacy}",
        "received_events_url": "https://api.github.com/users/anderbubble/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 512483297,
            "node_id": "MDU6TGFiZWw1MTI0ODMyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-low",
            "name": "impact-low",
            "color": "fef2c0",
            "default": false,
            "description": ""
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "scheibelp",
            "id": 1659704,
            "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scheibelp",
            "html_url": "https://github.com/scheibelp",
            "followers_url": "https://api.github.com/users/scheibelp/followers",
            "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
            "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
            "organizations_url": "https://api.github.com/users/scheibelp/orgs",
            "repos_url": "https://api.github.com/users/scheibelp/repos",
            "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scheibelp/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2020-03-29T23:49:28Z",
    "updated_at": "2020-05-02T16:07:51Z",
    "closed_at": "2020-05-02T16:07:51Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "We are installing openmpi on a host that happens to have GPFS installed. openmpi detects gpfs.h and links in libgpfs.so; but this prevents the build from being used on other systems that do not have GPFS installed. (It also means that the build depends on state that isn't expressed in its spec.)\r\n\r\n- Why does openmpi see gpfs.h or libgpfs.so? I would have expected the build environment to not expose these during `./configure`.\r\n- If I built this package with the same spec on two similar systems, one with GPFS and one without, would I end up with two different builds that share the same hash?\r\n- I am working on a modification to the openmpi package that would allow this to be controlled; but my first attempt hasn't had the desired effect. See https://www.mail-archive.com/users@lists.open-mpi.org//msg33758.html\r\n\r\n### Spack version\r\n```console\r\n$ spack --version\r\n0.14.1-415-cbcac72\r\n```\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ rpm -ql gpfs.base | grep -i 'gpfs\\.h'\r\n/usr/lpp/mmfs/include/gpfs.h\r\n$ spack install openmpi\r\n```\r\n\r\n### Error Message\r\n\r\nNo error message in spack; but on hosts that then don't have GPFS.\r\n\r\n```console\r\n   libgpfs.so => not found\r\n   libpsm2.so.2 => not found\r\n```\r\n### Information on your system\r\n```\r\n$ cat /etc/redhat-release \r\nRed Hat Enterprise Linux Server release 7.6 (Maipo)\r\n```\r\n\r\n### General information\r\n\r\n- [X] I have run `spack --version` and reported the version of Spack\r\n- [X] I have searched the issues of this repo and believe this is not a duplicate",
    "performed_via_github_app": null
}