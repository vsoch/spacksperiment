{
    "url": "https://api.github.com/repos/spack/spack/issues/10769",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/10769/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/10769/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/10769/events",
    "html_url": "https://github.com/spack/spack/issues/10769",
    "id": 416039604,
    "node_id": "MDU6SXNzdWU0MTYwMzk2MDQ=",
    "number": 10769,
    "title": "Installation issue: boost+python",
    "user": {
        "login": "HadrienG2",
        "id": 1305080,
        "node_id": "MDQ6VXNlcjEzMDUwODA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1305080?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/HadrienG2",
        "html_url": "https://github.com/HadrienG2",
        "followers_url": "https://api.github.com/users/HadrienG2/followers",
        "following_url": "https://api.github.com/users/HadrienG2/following{/other_user}",
        "gists_url": "https://api.github.com/users/HadrienG2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/HadrienG2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/HadrienG2/subscriptions",
        "organizations_url": "https://api.github.com/users/HadrienG2/orgs",
        "repos_url": "https://api.github.com/users/HadrienG2/repos",
        "events_url": "https://api.github.com/users/HadrienG2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/HadrienG2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2019-03-01T10:32:44Z",
    "updated_at": "2019-03-04T18:36:52Z",
    "closed_at": "2019-03-04T18:36:52Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Boost+python fails to build as a result of the include handling changes brought by #10623. It is unclear to me why that is the case, as python has a custom `headers` property, and should therefore be unaffected by the changes in default headers handling logic brought by this PR.\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install boost+python     \r\n==> diffutils is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/diffutils-3.7-vqgpdjmh2f6dwkrnj4i4yzxbvjzojugf\r\n==> bzip2 is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/bzip2-1.0.6-erc62fysmzegn5aggj7pq4ssxymhxghi\r\n==> libbsd is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/libbsd-0.9.1-lmv2j45wvfo5oewhsthujzxgcjpaxf2w\r\n==> expat is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/expat-2.2.5-huhjzhcuyxo5qexwmjedmbdzzmhi7dx4\r\n==> pkgconf is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/pkgconf-1.5.4-dlkfufky32mp6rxdvv3bc3buvfnxw2fb\r\n==> ncurses is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/ncurses-6.1-shlk5nceijseveculkybs4hh57dhu52r\r\n==> readline is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/readline-7.0-up73p4kl4uzyuyeuitrgzjflkqgyy4ea\r\n==> gdbm is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/gdbm-1.18.1-32xbwmojcgxzsyuxcrg3qwzjnabrdp7i\r\n==> libffi is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/libffi-3.2.1-g6lmitu5yjawyihgzhpclcifrdh7etbs\r\n==> perl is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/perl-5.26.2-h523kjaenpmpy3b74qfo4prry6obs3qb\r\n==> zlib is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/zlib-1.2.11-3wsfgx7dlu6zi6bj2obthqawemrmlwdt\r\n==> openssl is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/openssl-1.1.1a-aqkdbyebu73olpu4mq6lrok2plpmmdim\r\n==> sqlite is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/sqlite-3.26.0-rirc3xn6zezl7ritvedayintf546a3yh\r\n==> python is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/python-2.7.15-de2bigxceg2q4hc733lkrlx2g5ejpkrs\r\n==> Installing boost\r\n==> Searching for binary cache of boost\r\n==> Warning: No Spack mirrors are currently configured\r\n==> No binary for boost found: installing from source\r\n==> Fetching https://dl.bintray.com/boostorg/release/1.69.0/source/boost_1_69_0.tar.bz2\r\n######################################################################################################################################################################################################################################################### 100.0%\r\n==> Staging archive: /opt/spack/var/spack/stage/boost-1.69.0-36m7gfytolhq3rb24pvqgw36cfjwigc2/boost_1_69_0.tar.bz2\r\n==> Created stage in /opt/spack/var/spack/stage/boost-1.69.0-36m7gfytolhq3rb24pvqgw36cfjwigc2\r\n==> No patches needed for boost\r\n==> Building boost [Package]\r\n==> Executing phase: 'install'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    './b2' 'install' 'threading=multi' '-j' '20' '--user-config=/opt/spack/var/spack/stage/boost-1.69.0-36m7gfytolhq3rb24pvqgw36cfjwigc2/boost_1_69_0/user-config.jam' 'variant=release' '-s' 'BZIP2_INCLUDE=/opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/bzip2-1.0.6-erc62fysmzegn5aggj7pq4ssxymhxghi/include' '-s' 'BZIP2_LIBPATH=/opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/bzip2-1.0.6-erc62fysmzegn5aggj7pq4ssxymhxghi/lib' '-s' 'ZLIB_INCLUDE=/opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/zlib-1.2.11-3wsfgx7dlu6zi6bj2obthqawemrmlwdt/include' '-s' 'ZLIB_LIBPATH=/opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/zlib-1.2.11-3wsfgx7dlu6zi6bj2obthqawemrmlwdt/lib' 'link=static,shared' '--layout=system' 'toolset=gcc'\r\n\r\n54 errors found in build log:\r\n     385      gcc.compile.c++ bin.v2/libs/log/build/gcc-8.2.1/release/link-static/threadapi-pthread/threading-multi/visibility-hidden/dump_avx2.o\r\n     386      gcc.compile.c++ bin.v2/libs/log/build/gcc-8.2.1/release/link-static/threadapi-pthread/threading-multi/visibility-hidden/setup/parser_utils.o\r\n     387      gcc.compile.c++ bin.v2/libs/python/build/gcc-8.2.1/release/link-static/python-2.7/threading-multi/visibility-hidden/list.o\r\n     388      In file included from ./boost/python/detail/prefix.hpp:13,\r\n     389                       from ./boost/python/list.hpp:8,\r\n     390                       from libs/python/src/list.cpp:5:\r\n  >> 391      ./boost/python/detail/wrap_python.hpp:50:11: fatal error: pyconfig.h: No such file or directory\r\n     392       # include <pyconfig.h>\r\n     393                 ^~~~~~~~~~~~\r\n     394      compilation terminated.\r\n     395      \r\n     396          \"/opt/spack/lib/spack/env/gcc/g++\"   -fvisibility-inlines-hidden -m64 -pthread -O3 -finline-functions -Wno-inline -Wall -fvisibility=hidden  -DBOOST_ALL_NO_LIB=1 -DBOOST_PYTHON_SOURCE -DBOOST_PYTHON_STATIC_LIB -DNDEBUG  -I\".\" -I\"/opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2\r\n              .1/python-2.7.15-de2bigxceg2q4hc733lkrlx2g5ejpkrs/include\" -c -o \"bin.v2/libs/python/build/gcc-8.2.1/release/link-static/python-2.7/threading-multi/visibility-hidden/list.o\" \"libs/python/src/list.cpp\"\r\n\r\n    [ ... more failures ... ]\r\n\r\n```\r\n\r\nThe problem here is that spack uses the wrong include path for python headers. The proper path is not `/opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/python-2.7.15-de2bigxceg2q4hc733lkrlx2g5ejpkrs/include`, but its `[...]/python-2.7.15-de2bigxceg2q4hc733lkrlx2g5ejpkrs/include/python2.7` subdirectory.\r\n\r\nReverting PR #10623 brings the build back:\r\n\r\n```console\r\n$ cd /opt/spack && git revert 42386dbe947b81\r\n    [...]\r\n$ spack install boost+python\r\n==> diffutils is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/diffutils-3.7-vqgpdjmh2f6dwkrnj4i4yzxbvjzojugf\r\n==> bzip2 is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/bzip2-1.0.6-erc62fysmzegn5aggj7pq4ssxymhxghi\r\n==> libbsd is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/libbsd-0.9.1-lmv2j45wvfo5oewhsthujzxgcjpaxf2w\r\n==> expat is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/expat-2.2.5-huhjzhcuyxo5qexwmjedmbdzzmhi7dx4\r\n==> pkgconf is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/pkgconf-1.5.4-dlkfufky32mp6rxdvv3bc3buvfnxw2fb\r\n==> ncurses is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/ncurses-6.1-shlk5nceijseveculkybs4hh57dhu52r\r\n==> readline is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/readline-7.0-up73p4kl4uzyuyeuitrgzjflkqgyy4ea\r\n==> gdbm is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/gdbm-1.18.1-32xbwmojcgxzsyuxcrg3qwzjnabrdp7i\r\n==> libffi is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/libffi-3.2.1-g6lmitu5yjawyihgzhpclcifrdh7etbs\r\n==> perl is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/perl-5.26.2-h523kjaenpmpy3b74qfo4prry6obs3qb\r\n==> zlib is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/zlib-1.2.11-3wsfgx7dlu6zi6bj2obthqawemrmlwdt\r\n==> openssl is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/openssl-1.1.1a-aqkdbyebu73olpu4mq6lrok2plpmmdim\r\n==> sqlite is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/sqlite-3.26.0-rirc3xn6zezl7ritvedayintf546a3yh\r\n==> python is already installed in /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/python-2.7.15-de2bigxceg2q4hc733lkrlx2g5ejpkrs\r\n==> Installing boost\r\n==> Searching for binary cache of boost\r\n==> Warning: No Spack mirrors are currently configured\r\n==> No binary for boost found: installing from source\r\n==> Fetching https://dl.bintray.com/boostorg/release/1.69.0/source/boost_1_69_0.tar.bz2\r\n######################################################################################################################################################################################################################################################### 100.0%\r\n==> Staging archive: /opt/spack/var/spack/stage/boost-1.69.0-36m7gfytolhq3rb24pvqgw36cfjwigc2/boost_1_69_0.tar.bz2\r\n==> Created stage in /opt/spack/var/spack/stage/boost-1.69.0-36m7gfytolhq3rb24pvqgw36cfjwigc2\r\n==> No patches needed for boost\r\n==> Building boost [Package]\r\n==> Executing phase: 'install'\r\n==> Successfully installed boost\r\n  Fetch: 3.38s.  Build: 2m 3.04s.  Total: 2m 6.43s.\r\n[+] /opt/spack/opt/spack/linux-opensuse_tumbleweed20190226-x86_64/gcc-8.2.1/boost-1.69.0-36m7gfytolhq3rb24pvqgw36cfjwigc2\r\n```\r\n\r\nI am a bit surprised though: Python already has a custom headers property, which seems reasonable enough, so why does this change of default headers handling affect it at all?\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n```commandline\r\n$ uname -a\r\nLinux 390521e9442e 4.9.0-8-amd64 #1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64 x86_64 x86_64 GNU/Linux\r\n$ cat /etc/os-release \r\nNAME=\"openSUSE Tumbleweed\"\r\n# VERSION=\"20190226\"\r\nID=\"opensuse-tumbleweed\"\r\nID_LIKE=\"opensuse suse\"\r\nVERSION_ID=\"20190226\"\r\nPRETTY_NAME=\"openSUSE Tumbleweed\"\r\nANSI_COLOR=\"0;32\"\r\nCPE_NAME=\"cpe:/o:opensuse:tumbleweed:20190226\"\r\nBUG_REPORT_URL=\"https://bugs.opensuse.org\"\r\nHOME_URL=\"https://www.opensuse.org/\"",
    "performed_via_github_app": null
}