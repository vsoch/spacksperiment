{
    "url": "https://api.github.com/repos/spack/spack/issues/22932",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/22932/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/22932/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/22932/events",
    "html_url": "https://github.com/spack/spack/issues/22932",
    "id": 856026213,
    "node_id": "MDU6SXNzdWU4NTYwMjYyMTM=",
    "number": 22932,
    "title": "spack activate fails if dependencies are already activated",
    "user": {
        "login": "ilbiondo",
        "id": 61497728,
        "node_id": "MDQ6VXNlcjYxNDk3NzI4",
        "avatar_url": "https://avatars.githubusercontent.com/u/61497728?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ilbiondo",
        "html_url": "https://github.com/ilbiondo",
        "followers_url": "https://api.github.com/users/ilbiondo/followers",
        "following_url": "https://api.github.com/users/ilbiondo/following{/other_user}",
        "gists_url": "https://api.github.com/users/ilbiondo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ilbiondo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ilbiondo/subscriptions",
        "organizations_url": "https://api.github.com/users/ilbiondo/orgs",
        "repos_url": "https://api.github.com/users/ilbiondo/repos",
        "events_url": "https://api.github.com/users/ilbiondo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ilbiondo/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 1433532775,
            "node_id": "MDU6TGFiZWwxNDMzNTMyNzc1",
            "url": "https://api.github.com/repos/spack/spack/labels/triage",
            "name": "triage",
            "color": "ed9793",
            "default": false,
            "description": "The issue needs to be prioritized"
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "alalazo",
        "id": 4199709,
        "node_id": "MDQ6VXNlcjQxOTk3MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alalazo",
        "html_url": "https://github.com/alalazo",
        "followers_url": "https://api.github.com/users/alalazo/followers",
        "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
        "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
        "organizations_url": "https://api.github.com/users/alalazo/orgs",
        "repos_url": "https://api.github.com/users/alalazo/repos",
        "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alalazo/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "alalazo",
            "id": 4199709,
            "node_id": "MDQ6VXNlcjQxOTk3MDk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/alalazo",
            "html_url": "https://github.com/alalazo",
            "followers_url": "https://api.github.com/users/alalazo/followers",
            "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
            "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
            "organizations_url": "https://api.github.com/users/alalazo/orgs",
            "repos_url": "https://api.github.com/users/alalazo/repos",
            "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
            "received_events_url": "https://api.github.com/users/alalazo/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 4,
    "created_at": "2021-04-12T14:17:51Z",
    "updated_at": "2021-04-28T13:21:08Z",
    "closed_at": "2021-04-28T13:21:08Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "<!-- Explain, in a clear and concise way, the command you ran and the result you were trying to achieve.\r\nExample: \"I ran `spack find` to list all the installed packages and ...\" -->\r\n\r\nWhen activating an extension (python or R) the activation fails if any of the dependencies are already activated. \r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\nspack activate py-biopython\r\n```\r\n\r\nThere's the same behaviour if one tries to activate an already activated package.\r\n\r\nWith an older Spack instance (0.13.3) this returns an informational message and the activation continues.\r\n\r\n\r\n### Error Message\r\n\r\n<!-- If Spack reported an error, provide the error message. If it did not report an error but the output appears incorrect, provide the incorrect output. If there was no error message and no output but the result is incorrect, describe how it does not match what you expect. -->\r\n\r\n```console\r\n$ spack find -dl py-biopython\r\n==> 1 installed package\r\n-- linux-rhel8-zen2 / gcc@9.3.0 ---------------------------------\r\nsc7ad4r py-biopython@1.78\r\njfrf5qg     py-numpy@1.20.2\r\nkuedzzc         openblas@0.3.14\r\n5stjmys         py-setuptools@50.3.2\r\nrqhqacx             python@3.8.8\r\ntsmb67u                 bzip2@1.0.8\r\nrjyzhae                 expat@2.2.10\r\nbdtqx3b                     libbsd@0.10.0\r\n6h6znzs                 gdbm@1.19\r\nswnjpjl                     readline@8.0\r\no5uglmw                         ncurses@6.2\r\nwgotc6p                 gettext@0.21\r\nuc7nftf                     libiconv@1.16\r\nkcss646                     libxml2@2.9.10\r\n3zvzfm6                         xz@5.2.5\r\nejndmi5                         zlib@1.2.11\r\nu5sz3r5                     tar@1.32\r\nj2cbdcs                 libffi@3.3\r\n2mbz6et                 openssl@1.1.1c\r\nk27yovt                 sqlite@3.34.0\r\n3yzxuey                 util-linux-uuid@2.36\r\n\r\n$ spack -d activate py-biopython\r\n==> [2021-04-12-16:10:28.338572] Imported activate from built-in commands\r\n==> [2021-04-12-16:10:28.339290] Imported activate from built-in commands\r\n==> [2021-04-12-16:10:28.341524] Reading config file /dcsrsoft/spack/hetre/v1.1/spack/etc/spack/defaults/config.yaml\r\n==> [2021-04-12-16:10:28.364591] Reading config file /dcsrsoft/spack/hetre/v1.1/spack/etc/spack/config.yaml\r\n==> [2021-04-12-16:10:28.368351] DATABASE LOCK TIMEOUT: 3s\r\n==> [2021-04-12-16:10:28.368396] PACKAGE LOCK TIMEOUT: No timeout\r\n==> [2021-04-12-16:10:28.466561] Reading config file /dcsrsoft/spack/hetre/v1.1/spack/etc/spack/defaults/repos.yaml\r\n==> [2021-04-12-16:10:28.469615] Reading config file /dcsrsoft/spack/hetre/v1.1/spack/etc/spack/repos.yaml\r\n==> [2021-04-12-16:14:43.890409] Activating extension py-biopython@1.78%gcc@9.3.0 arch=linux-rhel8-zen2/sc7ad4r for python@3.8.8%gcc@9.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87 arch=linux-rhel8-zen2/rqhqacx\r\n==> [2021-04-12-16:14:43.895104] Activating extension py-numpy@1.20.2%gcc@9.3.0+blas+lapack patches=873745d7b547857fcfec9cae90b09c133b42a4f0c23b6c2d84cf37e2dd816604 arch=linux-rhel8-zen2/jfrf5qg for python@3.8.8%gcc@9.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87 arch=linux-rhel8-zen2/rqhqacx\r\n==> [2021-04-12-16:14:43.902956] ExtensionAlreadyInstalledError: py-numpy@1.20.2%gcc@9.3.0+blas+lapack patches=873745d7b547857fcfec9cae90b09c133b42a4f0c23b6c2d84cf37e2dd816604 arch=linux-rhel8-zen2/jfrf5qg is already installed in python@3.8.8%gcc@9.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87 arch=linux-rhel8-zen2/rqhqacx\r\n==> [2021-04-12-16:14:43.903007] Error: py-numpy@1.20.2%gcc@9.3.0+blas+lapack patches=873745d7b547857fcfec9cae90b09c133b42a4f0c23b6c2d84cf37e2dd816604 arch=linux-rhel8-zen2/jfrf5qg is already installed in python@3.8.8%gcc@9.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87 arch=linux-rhel8-zen2/rqhqacx\r\nTraceback (most recent call last):\r\n  File \"/dcsrsoft/spack/hetre/v1.1/spack/lib/spack/spack/main.py\", line 768, in main\r\n    return _invoke_command(command, parser, args, unknown)\r\n  File \"/dcsrsoft/spack/hetre/v1.1/spack/lib/spack/spack/main.py\", line 496, in _invoke_command\r\n    return_val = command(parser, args)\r\n  File \"/dcsrsoft/spack/hetre/v1.1/spack/lib/spack/spack/cmd/activate.py\", line 51, in activate\r\n    spec.package.do_activate(view, with_dependencies=not args.force)\r\n  File \"/dcsrsoft/spack/hetre/v1.1/spack/lib/spack/spack/package.py\", line 2331, in do_activate\r\n    verbose=verbose)\r\n  File \"/dcsrsoft/spack/hetre/v1.1/spack/lib/spack/spack/package.py\", line 2323, in do_activate\r\n    self.extendee_spec, self.spec)\r\n  File \"/dcsrsoft/spack/hetre/v1.1/spack/lib/spack/spack/directory_layout.py\", line 434, in check_extension_conflict\r\n    raise ExtensionAlreadyInstalledError(spec, ext_spec)\r\nspack.directory_layout.ExtensionAlreadyInstalledError: py-numpy@1.20.2%gcc@9.3.0+blas+lapack patches=873745d7b547857fcfec9cae90b09c133b42a4f0c23b6c2d84cf37e2dd816604 arch=linux-rhel8-zen2/jfrf5qg is already installed in python@3.8.8%gcc@9.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87 arch=linux-rhel8-zen2/rqhqacx\r\n\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n\r\n$ spack debug report\r\n* **Spack:** 0.16.1-1940-3d7069e039\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-rhel8-zen2\r\n* **Concretizer:** clingo\r\n\r\nMaybe @alalazo would like to take a look?\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\n\r\n### Additional information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n- [x] I have run the failing commands in debug mode and reported the output\r\n\r\n<!-- We encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively!\r\n\r\nIf you want to ask a question about the tool (how to use it, what it can currently do, etc.), try the `#general` channel on our Slack first. We have a welcoming community and chances are you'll get your reply faster and without opening an issue.\r\n\r\nOther than that, thanks for taking the time to contribute to Spack! -->\r\n",
    "performed_via_github_app": null
}