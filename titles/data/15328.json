{
    "url": "https://api.github.com/repos/spack/spack/issues/15328",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/15328/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/15328/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/15328/events",
    "html_url": "https://github.com/spack/spack/issues/15328",
    "id": 575583793,
    "node_id": "MDU6SXNzdWU1NzU1ODM3OTM=",
    "number": 15328,
    "title": "Error: Detected uninstalled dependencies for openssl",
    "user": {
        "login": "haampie",
        "id": 194764,
        "node_id": "MDQ6VXNlcjE5NDc2NA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/194764?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/haampie",
        "html_url": "https://github.com/haampie",
        "followers_url": "https://api.github.com/users/haampie/followers",
        "following_url": "https://api.github.com/users/haampie/following{/other_user}",
        "gists_url": "https://api.github.com/users/haampie/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/haampie/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/haampie/subscriptions",
        "organizations_url": "https://api.github.com/users/haampie/orgs",
        "repos_url": "https://api.github.com/users/haampie/repos",
        "events_url": "https://api.github.com/users/haampie/events{/privacy}",
        "received_events_url": "https://api.github.com/users/haampie/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 719256466,
            "node_id": "MDU6TGFiZWw3MTkyNTY0NjY=",
            "url": "https://api.github.com/repos/spack/spack/labels/containers",
            "name": "containers",
            "color": "c5def5",
            "default": false,
            "description": null
        },
        {
            "id": 537065486,
            "node_id": "MDU6TGFiZWw1MzcwNjU0ODY=",
            "url": "https://api.github.com/repos/spack/spack/labels/environments",
            "name": "environments",
            "color": "d4c5f9",
            "default": false,
            "description": null
        },
        {
            "id": 1433532775,
            "node_id": "MDU6TGFiZWwxNDMzNTMyNzc1",
            "url": "https://api.github.com/repos/spack/spack/labels/triage",
            "name": "triage",
            "color": "ed9793",
            "default": false,
            "description": "The issue needs to be prioritized"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "alalazo",
        "id": 4199709,
        "node_id": "MDQ6VXNlcjQxOTk3MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alalazo",
        "html_url": "https://github.com/alalazo",
        "followers_url": "https://api.github.com/users/alalazo/followers",
        "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
        "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
        "organizations_url": "https://api.github.com/users/alalazo/orgs",
        "repos_url": "https://api.github.com/users/alalazo/repos",
        "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alalazo/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "alalazo",
            "id": 4199709,
            "node_id": "MDQ6VXNlcjQxOTk3MDk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/alalazo",
            "html_url": "https://github.com/alalazo",
            "followers_url": "https://api.github.com/users/alalazo/followers",
            "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
            "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
            "organizations_url": "https://api.github.com/users/alalazo/orgs",
            "repos_url": "https://api.github.com/users/alalazo/repos",
            "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
            "received_events_url": "https://api.github.com/users/alalazo/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2020-03-04T17:08:05Z",
    "updated_at": "2020-03-06T11:20:08Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "I'm trying to build/install an environment via a `spack.yaml` in a Docker container, where I used `install_missing_compilers: True` to automatically install the compiler as well. Installing the compiler goes well, but when building `openssl` (an actual spec from the yaml file) it errors with\r\n\r\n```\r\nStep #1: ==> Error: Detected uninstalled dependencies for openssl: {'zlib', 'perl'}\r\n```\r\n\r\nzlib and perl are listed in the concretization though (`^zlib@1.2.11%gcc@9.2.0+optimize+pic+shared arch=linux-ubuntu18.04-skylake`). And in fact `zlib` is installed when GCC 9.2.0 is built:\r\n\r\n```\r\nStep #1: ==> 31: Installing zlib\r\nStep #1: ==> Fetching http://zlib.net/fossils/zlib-1.2.11.tar.gz\r\nStep #1: ==> Staging archive: /tmp/root/spack-stage/spack-stage-zlib-1.2.11-zsfobvoatxmon7erh2xzk5l6imufesb7/zlib-1.2.11.tar.gz\r\nStep #1: ==> Created stage in /tmp/root/spack-stage/spack-stage-zlib-1.2.11-zsfobvoatxmon7erh2xzk5l6imufesb7\r\nStep #1: ==> No patches needed for zlib\r\nStep #1: ==> 31: zlib: Building zlib [Package]\r\nStep #1: ==> 31: zlib: Executing phase: 'install'\r\nStep #1: ==> 31: zlib: Successfully installed zlib\r\nStep #1:   Fetch: 0.47s.  Build: 1.66s.  Total: 2.12s.\r\nStep #1: [+] /opt/software/linux-ubuntu18.04-skylake/gcc-7.4.0/zlib-1.2.11-zsfobvoatxmon7erh2xzk5l6imufesb7\r\n```\r\n\r\nPossibly related issues are https://github.com/spack/spack/issues/15219 and https://github.com/spack/spack/issues/15219, but I made sure I'm on the latest development version of spack to get their bug fixes.\r\n\r\n### Spack version\r\nLatest develop version\r\n```console\r\n$ spack --version\r\n0.14.0-110-b472c1380\r\n```\r\n\r\n### Steps to reproduce the issue\r\n\r\nBuild the following dockerfile (building GCC 9.2.0 takes unfortunately 30mins with sufficiently many cores)\r\n\r\n```Dockerfile\r\nFROM ubuntu:18.04\r\n\r\nENV SPACK_ROOT=/opt/spack\r\n\r\nRUN apt-get -yqq update                           \\\r\n && apt-get -yqq install --no-install-recommends  \\\r\n        build-essential                           \\\r\n        ca-certificates                           \\\r\n        curl                                      \\\r\n        file                                      \\\r\n        gfortran                                  \\\r\n        git                                       \\\r\n        python3                                   \\\r\n        python3-pip                               \\\r\n        unzip                                     \\\r\n && rm -rf /var/lib/apt/lists/*\r\n\r\nRUN mkdir -p $SPACK_ROOT\r\n\r\nRUN git clone -b develop https://github.com/spack/spack.git $SPACK_ROOT\r\n\r\n# Login shell so that we expose spack\r\nRUN echo \". \\$SPACK_ROOT/share/spack/setup-env.sh\" > /etc/profile.d/spack.sh\r\nWORKDIR /root\r\nSHELL [\"/bin/bash\", \"-l\", \"-c\"]\r\nENTRYPOINT [\"/bin/bash\", \"-l\"]\r\n\r\n# Override some defaults to the spack settings\r\nRUN (echo \"config:\" \\\r\n&&   echo \"    install_missing_compilers: True\") > $SPACK_ROOT/etc/spack/config.yaml\r\n\r\nRUN mkdir /opt/spack-environment \\\r\n&&  (echo \"spack:\" \\\r\n&&   echo \"  specs:\" \\\r\n&&   echo \"  - cmake@3.16.2%gcc@9.2.0 arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  - py-mpi4py%gcc@9.2.0 arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  - netlib-scalapack%gcc@9.2.0 ^cmake@3.16.2 ^openblas threads=openmp arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  - hdf5+hl%gcc@9.2.0 arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  - libxc%gcc@9.2.0 arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  - spglib%gcc@9.2.0 arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  - gsl%gcc@9.2.0 arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  - spfft%gcc@9.2.0 arch=linux-ubuntu18.04-skylake\" \\\r\n&&   echo \"  view: /opt/view\" \\\r\n&&   echo \"  concretization: together\" \\\r\n&&   echo \"  config:\" \\\r\n&&   echo \"    install_tree: /opt/software\") > /opt/spack-environment/spack.yaml\r\n\r\n# Install the software, remove unecessary deps\r\nRUN cd /opt/spack-environment && spack install && spack gc -y\r\n```\r\n\r\n### Error Message\r\n\r\n```\r\nStep #1: ==> Error: Detected uninstalled dependencies for openssl: {'zlib', 'perl'}\r\n```\r\n",
    "performed_via_github_app": null
}