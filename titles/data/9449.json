{
    "url": "https://api.github.com/repos/spack/spack/issues/9449",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/9449/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/9449/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/9449/events",
    "html_url": "https://github.com/spack/spack/issues/9449",
    "id": 367485663,
    "node_id": "MDU6SXNzdWUzNjc0ODU2NjM=",
    "number": 9449,
    "title": "Installation issue: intel-mkl",
    "user": {
        "login": "alichnewsky",
        "id": 2906795,
        "node_id": "MDQ6VXNlcjI5MDY3OTU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2906795?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alichnewsky",
        "html_url": "https://github.com/alichnewsky",
        "followers_url": "https://api.github.com/users/alichnewsky/followers",
        "following_url": "https://api.github.com/users/alichnewsky/following{/other_user}",
        "gists_url": "https://api.github.com/users/alichnewsky/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alichnewsky/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alichnewsky/subscriptions",
        "organizations_url": "https://api.github.com/users/alichnewsky/orgs",
        "repos_url": "https://api.github.com/users/alichnewsky/repos",
        "events_url": "https://api.github.com/users/alichnewsky/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alichnewsky/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2018-10-06T18:59:33Z",
    "updated_at": "2020-01-15T09:00:13Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install -v --dont-restage intel-mkl threads=tbb\r\n==> Installing intel-mkl\r\n==> Using cached archive: /home/alichnewsky/github.com/spack/spack/var/spack/cache/intel-mkl/intel-mkl-2019.0.117.tgz\r\n==> Already staged intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2 in /home/alichnewsky/github.com/spack/spack/var/spack/stage/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2\r\n==> No patches needed for intel-mkl\r\n==> Building intel-mkl [IntelPackage]\r\n==> Executing phase: 'configure'\r\n==> Executing phase: 'install'\r\n==> './install.sh' '--silent' 'silent.cfg'\r\nWARNING: Destination directory already exists.\r\n\r\n==> Installing silent.cfg to /home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/.spack\r\n==> Installing /tmp/spack-intel-7XxumU/intel.pset.alichnewsky.penguin_10.06.11.29.34.2018.log to /home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/.spack\r\n==> normalize_path.normalize_suite_dir: trying /home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/parallel_studio_xe_2019.0.117\r\n==> normalize_path.normalize_suite_dir: trying /home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/parallel_studio_xe_2019.0.*\r\n==> normalize_path.normalize_suite_dir: found 1:\r\n  ['/home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/parallel_studio_xe_2019.0.045']\r\n==> normalize_path.normalize_suite_dir: /home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/parallel_studio_xe_2019.0.045\r\n==> uninstall_ism.normalize_path:       /home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/parallel_studio_xe_2019.0.045/ism\r\n==> phase_wrapper.uninstall_ism:        /tmp/alichnewsky/spack-stage/spack-stage-KXNUP5/l_mkl_2019.0.117\r\n==> Error: ValueError: Error: unterminated ${ in format:'() {  eval $($LMOD_CMD bash \"$@\") && eval $(${LMOD_SETTARG_CMD'\r\n\r\n/home/alichnewsky/github.com/spack/spack/lib/spack/spack/package.py:1505, in build_process:\r\n       1502                    echo = logger.echo\r\n       1503                    self.log()\r\n       1504\r\n  >>   1505                # Run post install hooks before build stage is removed.\r\n       1506                spack.hooks.post_install(self.spec)\r\n       1507\r\n       1508            # Stop timer.\r\n\r\nSee build log for details:\r\n  /home/alichnewsky/github.com/spack/spack/var/spack/stage/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/l_mkl_2019.0.117/spack-build.out\r\n```\r\n\r\nPlease note that the `--dont-restage` option is only in there not to download ~1GiB of software at every install attempt.\r\nthe latter file contains the previous logs **except the actual error message** : \r\n```\r\n==> Error: ValueError: Error: unterminated ${ in format:'() {  eval $($LMOD_CMD bash \"$@\") && eval $(${LMOD_SETTARG_CMD'\r\n```\r\n\r\nnote that manually going into the directory where the software is staged, uninstall and then install manually works. I just don't get any of the spack post-installation hooks executed, and I cant `spack load` the package...\r\n\r\n### Platform and user environment\r\n\r\n```console\r\n$ uname -a \r\nLinux penguin 4.14.65-05969-g6f2926628697 #1 SMP PREEMPT Tue Sep 4 16:08:40 PDT 2018 x86_64 GNU/Linux\r\n$ lsb_release -d\r\nDescription:    Debian GNU/Linux 9.5 (stretch)\r\n``` \r\n### Additional information\r\n```console\r\n$ spack spec  --install-status  intel-mkl threads=tbb\r\nInput spec\r\n--------------------------------\r\n     intel-mkl threads=tbb\r\n\r\nConcretized\r\n--------------------------------\r\n     intel-mkl@2019.0.117%gcc@8.2.0~ilp64+shared threads=tbb arch=linux-debian9-x86_64 \r\n...\r\n\r\n$ spack log-parse --show=errors,warnings  /home/alichnewsky/github.com/spack/spack/var/spack/stage/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/l_mkl_2019.0.117/spack-build.out\r\n0 errors\r\n1 warnings\r\n     1    ==> Executing phase: 'configure'\r\n     2    ==> Executing phase: 'install'\r\n     3    ==> './install.sh' '--silent' 'silent.cfg'\r\n  >> 4    WARNING: Destination directory already exists.\r\n     5\r\n     6    ==> Installing silent.cfg to /home/alichnewsky/github.com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-\r\n          2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/.spack\r\n     7    ==> Installing /tmp/spack-intel-7XxumU/intel.pset.alichnewsky.penguin_10.06.11.29.34.2018.log to /home/alichnewsky/github\r\n          .com/spack/spack/opt/spack/linux-debian9-x86_64/gcc-8.2.0/intel-mkl-2019.0.117-scxcrzabzmrrysppye3tepsvm22jogy2/.spack\r\n```\r\nthere are also 2MiB of installation logs from intel showing everything went right on their end...\r\n\r\nspack was cloned from git. Here's the commit being used:\r\n```console\r\n$ /home/alichnewsky/github.com/spack/spack/ && git rev-parse HEAD\r\n011ad24950684b955a213f1b32662dd745fea3b1\r\n```",
    "performed_via_github_app": null
}