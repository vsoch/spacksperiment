{
    "url": "https://api.github.com/repos/spack/spack/issues/17820",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/17820/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/17820/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/17820/events",
    "html_url": "https://github.com/spack/spack/issues/17820",
    "id": 670257459,
    "node_id": "MDU6SXNzdWU2NzAyNTc0NTk=",
    "number": 17820,
    "title": "`develop` test failures on linux",
    "user": {
        "login": "tldahlgren",
        "id": 35777542,
        "node_id": "MDQ6VXNlcjM1Nzc3NTQy",
        "avatar_url": "https://avatars.githubusercontent.com/u/35777542?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tldahlgren",
        "html_url": "https://github.com/tldahlgren",
        "followers_url": "https://api.github.com/users/tldahlgren/followers",
        "following_url": "https://api.github.com/users/tldahlgren/following{/other_user}",
        "gists_url": "https://api.github.com/users/tldahlgren/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tldahlgren/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tldahlgren/subscriptions",
        "organizations_url": "https://api.github.com/users/tldahlgren/orgs",
        "repos_url": "https://api.github.com/users/tldahlgren/repos",
        "events_url": "https://api.github.com/users/tldahlgren/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tldahlgren/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2020-07-31T21:36:43Z",
    "updated_at": "2020-08-13T20:12:29Z",
    "closed_at": "2020-07-31T22:15:15Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "The following tests fail using `develop` on LC quartz (Linux, broadwell):\r\n\r\n- `test_all_virtual_packages_have_default_providers` and\r\n- `test_all_dependencies_exist`\r\n\r\n\r\n### Error Messages\r\n\r\n```\r\n$ spack test -v --showlocals\r\n...\r\n_________________________________ test_all_virtual_packages_have_default_providers __________________________________\r\n\r\n    def test_all_virtual_packages_have_default_providers():\r\n        \"\"\"All virtual packages must have a default provider explicitly set.\"\"\"\r\n        defaults = spack.config.get('packages', scope='defaults')\r\n        default_providers = defaults['all']['providers']\r\n        providers = spack.repo.path.provider_index.providers\r\n        default_providers_filename = \\\r\n            spack.config.config.scopes['defaults'].get_section_filename('packages')\r\n        for provider in providers:\r\n>           assert provider in default_providers, \\\r\n                \"all providers must have a default in %s\" \\\r\n                % default_providers_filename\r\nE           AssertionError: all providers must have a default in /g/g21/user/spack/clean/spack/etc/spack/defaults/packages.yaml\r\nE           assert 'egl' in CommentedMap([('D', ['ldc']), ('awk', ['gawk']), ('blas', ['openblas']), ('daal', ['intel-daal']), ('elf', ['elfutils'...alapack']), ('sycl', ['hipsycl']), ('szip', ['libszip', 'libaec']), ('tbb', ['intel-tbb']), ('unwind', ['libunwind'])])\r\n\r\ndefault_providers = CommentedMap([('D', ['ldc']), ('awk', ['gawk']), ('blas', ['openblas']), ('daal', ['intel-daal']), ('elf', ['elfutils'...alapack']), ('sycl', ['hipsycl']), ('szip', ['libszip', 'libaec']), ('tbb', ['intel-tbb']), ('unwind', ['libunwind'])])\r\ndefault_providers_filename = '/g/g21/dahlgren/spack/clean/spack/etc/spack/defaults/packages.yaml'\r\ndefaults   = {'all': CommentedMap([('compiler', ['gcc', 'intel', 'pgi', 'clang', 'xl', 'nag', 'fj']), ('providers', CommentedMap([(... ['intel-tbb']), ('unwind', ['libunwind'])])), ('permissions', CommentedMap([('read', 'world'), ('write', 'user')]))])}\r\nprovider   = 'egl'\r\nproviders  = {'D': {D@2: {ldc}}, 'awk': {awk: {gawk, mawk}}, 'blas': {blas: {amdblis+blas, amdblis+cblas, atlas, blis+blas, blis+cblas, cray-libsci, ...}}, 'daal': {daal: {intel-daal, intel-parallel-studio+daal}}, ...}\r\n\r\nlib/spack/spack/test/package_sanity.py:60: AssertionError\r\n____________________________________________ test_all_dependencies_exist ____________________________________________\r\n\r\n    def test_all_dependencies_exist():\r\n        \"\"\"Make sure no packages have nonexisting dependencies.\"\"\"\r\n        missing = {}\r\n        pkgs = [pkg for pkg in spack.repo.path.all_package_names()]\r\n        spack.package.possible_dependencies(\r\n            *pkgs, transitive=True, missing=missing)\r\n    \r\n        lines = [\r\n            \"%s: [%s]\" % (name, \", \".join(deps)) for name, deps in missing.items()\r\n        ]\r\n>       assert not missing, \"These packages have missing dependencies:\\n\" + (\r\n            \"\\n\".join(lines)\r\n        )\r\nE       AssertionError: These packages have missing dependencies:\r\nE         hwloc: [libglvnd-fe]\r\nE       assert not {'hwloc': {'libglvnd-fe'}}\r\n\r\nlines      = ['hwloc: [libglvnd-fe]']\r\nmissing    = {'hwloc': {'libglvnd-fe'}}\r\npkgs       = ['abinit', 'abseil-cpp', 'abyss', 'accfft', 'accumulo', 'ace', ...]\r\n\r\nlib/spack/spack/test/package_sanity.py:203: AssertionError\r\n```\r\n\r\n\r\n### Information on your system\r\n```\r\n$ spack debug report \r\n* **Spack:** 0.15.3-328-c436414\r\n* **Python:** 3.7.2\r\n* **Platform:** linux-rhel7-broadwell\r\n```\r\n\r\n\r\n### Additional information\r\n\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n- [x] I have run the failing commands in ~debug~ verbose mode and reported the output\r\n",
    "performed_via_github_app": null
}