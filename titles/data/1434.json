{
    "url": "https://api.github.com/repos/spack/spack/issues/1434",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/1434/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/1434/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/1434/events",
    "html_url": "https://github.com/spack/spack/issues/1434",
    "id": 169248282,
    "node_id": "MDU6SXNzdWUxNjkyNDgyODI=",
    "number": 1434,
    "title": "spack compiler wrappers munging include file lines when building cbtf-krell",
    "user": {
        "login": "jgalarowicz",
        "id": 630197,
        "node_id": "MDQ6VXNlcjYzMDE5Nw==",
        "avatar_url": "https://avatars.githubusercontent.com/u/630197?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jgalarowicz",
        "html_url": "https://github.com/jgalarowicz",
        "followers_url": "https://api.github.com/users/jgalarowicz/followers",
        "following_url": "https://api.github.com/users/jgalarowicz/following{/other_user}",
        "gists_url": "https://api.github.com/users/jgalarowicz/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jgalarowicz/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jgalarowicz/subscriptions",
        "organizations_url": "https://api.github.com/users/jgalarowicz/orgs",
        "repos_url": "https://api.github.com/users/jgalarowicz/repos",
        "events_url": "https://api.github.com/users/jgalarowicz/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jgalarowicz/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 10,
    "created_at": "2016-08-03T22:19:47Z",
    "updated_at": "2016-11-27T15:33:37Z",
    "closed_at": "2016-11-27T15:33:37Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Unless I am missing something, it appears that the spack compiler wrappers are causing the `cbtf-krell` component to fail to build.\n\nFor the file that fails to build, I've isolated the failing compile line out and replaced the\n`/home/jgalaro/spack/lib/spack/env/gcc/g++` phrase with `/usr/bin/g++`\nWith `/usr/bin/g++` the compile works, but with the spack wrapper the `-I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab` seems to be mucked up by the wrapper.\n\nHere is the compile command I invoked:\n\n```\n/home/jgalaro/spack/lib/spack/env/gcc/g++   -DHAVE_DLOPEN -DHAVE_STDINT_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_TARGET_DLOPEN -DVERSION=\\\"1.6.0\\\" -Dcbtf_messages_converters_symtab_EXPORTS -Dos_linux -O2 -g -std=c++0x -fPIC -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab../base -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wstz5rddti/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wstz5rddti/lib/mrnet-5.0.1/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wstz5rddti/lib/xplat-5.0.1/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/boost-1.53.0-p2fdcohijrb4gvd27olpdcnxjugrcfhg/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/cbtf-1.6-4j6wcyigyzwhvufnhklj57y7puebxqvo/include -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/base -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/base    -o CMakeFiles/cbtf-messages-converters-symtab.dir/Converters.cpp.o -c /tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab/Converters.cpp\n```\n\nBut the spack wrapper munged the include line:   See `-p/jgalaro` in bold.   I added the same line again and it munged the second one in a different way.   See `**/cbtf-krell/bucbtf_krell/me**`  that is supposed to be `**/cbtf-krell/build_cbtf_krell/me**`\n\n```\nbash-4.1$ /home/jgalaro/spack/lib/spack/env/gcc/g++   -DHAVE_DLOPEN -DHAVE_STDINT_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_TARGET_DLOPEN -DVERSION=\\\"1.6.0\\\" -Dcbtf_messages_converters_symtab_EXPORTS -Dos_linux -O2 -g -std=c++0x -fPIC **-p/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab** -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab **-I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/bucbtf_krell/messages/src/symtab** -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab../base -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wsddti/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wstz5rddti/lib/mrnet-5.0.1/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5pt7wstz5rddti/lib/xplat-5.0.1/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/boost-1.53.0-p2fdcohijrb4gvd27olpdcnxjugrcfhg/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/cbtf-1.6-4j6wcyigyzwhvufn57y7puebxqvo/include -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/base -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/base    -o CMakeFiles/cbtf-messages-conver-symtab.dir/Converters.cpp.o -c /tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab/Converters.cpp\n/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab/Converters.cpp:25: error: \u2018CBTF_Protocol_AddressBitmap\u2019 was not declared in this scope\n...\n...\n...\n/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab/Converters.cpp:29: error: invalid type in declaration before \u2018;\u2019 token\n/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab/Converters.cpp:29: error: redefinition of \u2018int KrellInstitute::CBTF::Impl::instance\u2019\n/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab/Converters.cpp:25: error: \u2018int KrellInstitute::CBTF::Impl::instance\u2019 previously declared here\nbash-4.1$\nbash-4.1$\n**/usr/bin/g++ works:**\nbash-4.1$\nbash-4.1$ /usr/bin/g++   -DHAVE_DLOPEN -DHAVE_STDINT_H=1 -DHAVE_SYS_STAT_H=1 -DHAVE_TARGET_DLOPEN -DVERSION=\\\"1.6.0\\\" -Dcbtf_messages_converters_symtab_EXPORTS -Dos_linux -O2 -g -std=c++0x -fPIC -I/tmp/jgalaro/spack-stage/spatage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/sb -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/symtab../base -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wstz5rddti/include -I/home/jgalspack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wstz5rddti/lib/mrnet-5.0.1/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/mrnet-5.0.1-2-2rcgpsm2uiffkx5ptg25m7wstz5rddti/lib/xplat-5.0nclude -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/boost-1.53.0-p2fdcohijrb4gvd27olpdcnxjugrcfhg/include -I/home/jgalaro/spack/opt/spack/Linux-x86_64/gcc-4.4.7/cbtf-1.6-4j6wcyigyzwhvufnhklj57y7puebxqvo/include -I/tgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/base -I/tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/build_cbtf_krell/messages/src/base    -o CMakeFiles/cbtf-messages-converters-symtab.dir/Converters.cp-c /tmp/jgalaro/spack-stage/spack-stage-Qb0Vjp/cbtf-krell/messages/src/symtab/Converters.cpp\nbash-4.1$\n```\n",
    "performed_via_github_app": null
}