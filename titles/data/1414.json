{
    "url": "https://api.github.com/repos/spack/spack/issues/1414",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/1414/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/1414/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/1414/events",
    "html_url": "https://github.com/spack/spack/pull/1414",
    "id": 168740145,
    "node_id": "MDExOlB1bGxSZXF1ZXN0Nzk2MzUwNjQ=",
    "number": 1414,
    "title": "Fix backup=True for filter_file",
    "user": {
        "login": "adamjstewart",
        "id": 12021217,
        "node_id": "MDQ6VXNlcjEyMDIxMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12021217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjstewart",
        "html_url": "https://github.com/adamjstewart",
        "followers_url": "https://api.github.com/users/adamjstewart/followers",
        "following_url": "https://api.github.com/users/adamjstewart/following{/other_user}",
        "gists_url": "https://api.github.com/users/adamjstewart/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/adamjstewart/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/adamjstewart/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjstewart/orgs",
        "repos_url": "https://api.github.com/users/adamjstewart/repos",
        "events_url": "https://api.github.com/users/adamjstewart/events{/privacy}",
        "received_events_url": "https://api.github.com/users/adamjstewart/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2016-08-01T20:56:13Z",
    "updated_at": "2016-08-01T21:11:00Z",
    "closed_at": "2016-08-01T21:10:59Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/1414",
        "html_url": "https://github.com/spack/spack/pull/1414",
        "diff_url": "https://github.com/spack/spack/pull/1414.diff",
        "patch_url": "https://github.com/spack/spack/pull/1414.patch"
    },
    "body": "I was trying to debug a problem in the patch method of the libxsmm package (#1413), so I set `backup=True` to compare the Makefile.inc and it's backup copy. Much to my chagrin, I discovered that only one line of the file had changed. Upon further inspection, I discovered that the backup file wasn't the same as the original file.\n\nFor packages like libxsmm that call the `filter` method multiple times, `filter_file` was taking the current file, overwriting the old backup with it, and applying the change. In effect, Makefile.inc contained all replaced text, and the backup file contained all replaced text except for the last filter.\n\nThe solution was to create a backup file only if one does not already exist. This required me to edit the new file in place. After applying these changes, the backup file is identical to the old file before patching and the new file contains all changes as expected.\n\n@mdevlin1 \n",
    "performed_via_github_app": null
}