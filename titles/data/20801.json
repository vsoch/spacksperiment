{
    "url": "https://api.github.com/repos/spack/spack/issues/20801",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/20801/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/20801/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/20801/events",
    "html_url": "https://github.com/spack/spack/issues/20801",
    "id": 784510374,
    "node_id": "MDU6SXNzdWU3ODQ1MTAzNzQ=",
    "number": 20801,
    "title": "Installation issue: pytorchvision and python2 from spack.yaml does not work",
    "user": {
        "login": "doutriaux1",
        "id": 2781425,
        "node_id": "MDQ6VXNlcjI3ODE0MjU=",
        "avatar_url": "https://avatars.githubusercontent.com/u/2781425?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/doutriaux1",
        "html_url": "https://github.com/doutriaux1",
        "followers_url": "https://api.github.com/users/doutriaux1/followers",
        "following_url": "https://api.github.com/users/doutriaux1/following{/other_user}",
        "gists_url": "https://api.github.com/users/doutriaux1/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/doutriaux1/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/doutriaux1/subscriptions",
        "organizations_url": "https://api.github.com/users/doutriaux1/orgs",
        "repos_url": "https://api.github.com/users/doutriaux1/repos",
        "events_url": "https://api.github.com/users/doutriaux1/events{/privacy}",
        "received_events_url": "https://api.github.com/users/doutriaux1/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 446623646,
            "node_id": "MDU6TGFiZWw0NDY2MjM2NDY=",
            "url": "https://api.github.com/repos/spack/spack/labels/concretization",
            "name": "concretization",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2021-01-12T19:01:37Z",
    "updated_at": "2021-01-12T19:45:58Z",
    "closed_at": "2021-01-12T19:45:57Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "### Steps to reproduce the issue\r\nuse this [rzhasgpu-python2.txt](https://github.com/spack/spack/files/5804205/rzhasgpu-python2.txt) yaml file and spack v0.16.0\r\n\r\n\r\n```console\r\n$ spactivate .\r\n$ spack install \r\n```\r\n\r\n### Information on your system\r\n\r\nrzhasgpu on LC (toss) spack.yaml file worked on Dec 4th.\r\n\r\n### Additional information\r\n\r\nWe are using binaries mirror setup by @rblake for us.\r\n\r\nv0.16.0 works as is for @rblake but for me I need to edit the specs to:\r\n- pytorchvision@0.5.1\r\notherwise i get this error:\r\n```\r\n==> Error: An unsatisfiable version constraint has been detected for spec:\r\n\r\n    python@2.7.18%gcc@7.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib arch=linux-rhel7-haswell\r\n        ^bzip2\r\n            ^diffutils\r\n                ^iconv\r\n        ^expat\r\n        ^gdbm\r\n            ^readline\r\n                ^ncurses\r\n                    ^pkgconf@1.7.3%gcc@7.3.0 arch=linux-rhel7-haswell\r\n        ^gettext+libxml2\r\n            ^libxml2\r\n                ^xz\r\n                ^zlib@1.2.11%gcc@7.3.0+optimize+pic+shared arch=linux-rhel7-haswell\r\n        ^libffi\r\n        ^libuuid\r\n        ^openssl\r\n            ^perl@5.14.0:\r\n                ^berkeley-db\r\n        ^sqlite@3.0.8:\r\n\r\n\r\nwhile trying to concretize the partial spec:\r\n\r\n    py-torchvision@0.8.1%gcc@7.3.0 backend=pil arch=linux-rhel7-haswell\r\n\r\n\r\npy-torchvision requires python version 3.6:, but spec asked for 2.7.18\r\n```\r\n\r\nEven with this, after installing most thing I get the following error for pytorchvision:\r\n\r\n```\r\n[+] /usr/WS1/aml_user/tools/spack/opt/spack/linux-rhel7-haswell/gcc-7.3.0/py-pillow-6.2.2-6nz6psw7vuezoe3khcymizh64qdoc7yo\r\n[+] /usr/WS1/aml_user/tools/spack/opt/spack/linux-rhel7-haswell/gcc-7.3.0/py-numpy-1.16.6-es2kr3aijn2nsjyi6lbu6ljd5pekfmsk\r\n==> Installing py-torchvision-0.5.1-zla6qcryikcyumfgkyb6aup36jxnk2vc\r\n==> No binary for py-torchvision-0.5.1-zla6qcryikcyumfgkyb6aup36jxnk2vc found: installing from source\r\n==> Error: KeyError: 'No spec with name py-torch in py-torchvision@0.5.1%gcc@7.3.0 backend=pil arch=linux-rhel7-haswell ^alsa-lib@1.2.3.2%gcc@7.3.0~python arch=linux-rhel7-haswell ^bzip2@1.0.8%gcc@7.3.0+shared arch=linux-rhel7-haswell ^cmake@3.18.0%gcc@7.3.0~doc+ncurses+openssl+ownlibs~qt patches=bf695e3febb222da2ed94b3beea600650e4318975da90e4a71d6f31a6d5d8c3d,e51119dd387aa3eb2f21fee730d3aa8b5480301c5e2e3a33bd86f4f7d8903861 arch=linux-rhel7-haswell ^diffutils@3.7%gcc@7.3.0 arch=linux-rhel7-haswell ^expat@2.2.10%gcc@7.3.0+libbsd arch=linux-rhel7-haswell ^ffmpeg@4.2.2%gcc@7.3.0~X~avresample+bzlib~drawtext+gpl~libaom~libmp3lame~libopenjpeg~libopus~libsnappy~libspeex~libssh~libvorbis~libwebp~libzmq~lzma~nonfree~openssl~sdl2+shared+version3 arch=linux-rhel7-haswell ^gdbm@1.18.1%gcc@7.3.0 arch=linux-rhel7-haswell ^gettext@0.21%gcc@7.3.0+bzip2+curses+git~libunistring+libxml2+tar+xz arch=linux-rhel7-haswell ^libbsd@0.10.0%gcc@7.3.0 arch=linux-rhel7-haswell ^libffi@3.3%gcc@7.3.0 patches=26f26c6f29a7ce9bf370ad3ab2610f99365b4bdd7b82e7c31df41a3370d685c0 arch=linux-rhel7-haswell ^libiconv@1.16%gcc@7.3.0 arch=linux-rhel7-haswell ^libjpeg-turbo@2.0.4%gcc@7.3.0 arch=linux-rhel7-haswell ^libuuid@1.0.3%gcc@7.3.0 arch=linux-rhel7-haswell ^libxml2@2.9.10%gcc@7.3.0~python arch=linux-rhel7-haswell ^nasm@2.15.05%gcc@7.3.0 arch=linux-rhel7-haswell ^ncurses@5.9.20130511%gcc@7.3.0~symlinks+termlib patches=f84b2708a42777aadcc7f502a261afe10ca5646a51c1ef8b5e60d2070d926b57 arch=linux-rhel7-haswell ^ninja@1.9.0%gcc@7.3.0 arch=linux-rhel7-haswell ^openblas@0.3.12%gcc@7.3.0~consistent_fpcsr~ilp64+pic+shared threads=none arch=linux-rhel7-haswell ^openssl@1.0.2k-fips%gcc@7.3.0+systemcerts arch=linux-rhel7-haswell ^pkgconf@1.7.3%gcc@7.3.0 arch=linux-rhel7-haswell ^py-numpy@1.16.6%gcc@7.3.0+blas+lapack patches=196dc7cc8e1367de199726d4e005bba50c3d13fb2843c4753c5f07f7894f10c9 arch=linux-rhel7-haswell ^py-pillow@6.2.2%gcc@7.3.0~freetype~imagequant+jpeg~jpeg2000~lcms~tiff~webp~webpmux~xcb+zlib arch=linux-rhel7-haswell ^py-setuptools@44.1.0%gcc@7.3.0 arch=linux-rhel7-haswell ^py-six@1.14.0%gcc@7.3.0 arch=linux-rhel7-haswell ^python@2.7.18%gcc@7.3.0+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=7e1bd91333263e2a03e91bcc87bf476d81dae56092903974c1580a78cd9e3411 arch=linux-rhel7-haswell ^readline@8.0%gcc@7.3.0 arch=linux-rhel7-haswell ^sqlite@3.33.0%gcc@7.3.0+column_metadata+fts~functions~rtree arch=linux-rhel7-haswell ^tar@1.26%gcc@7.3.0 patches=08921fcbd732050c74ddf1de7d8ad95ffdbc09f8b4342456fa2f6a0dd02a957c,5c314db58d005043bf407abaf25eb9823b9032a22fd12a0b142d4bf548130fa4,d428578be7fb99b831eb61e53b8d88a859afe08b479a21238180899707d79ce4 arch=linux-rhel7-haswell ^xz@5.2.5%gcc@7.3.0~pic arch=linux-rhel7-haswell ^yasm@1.3.0%gcc@7.3.0 arch=linux-rhel7-haswell ^zlib@1.2.11%gcc@7.3.0+optimize+pic+shared arch=linux-rhel7-haswell'\r\n\r\n/usr/WS1/aml_user/tools/spack/var/spack/repos/builtin/packages/py-torchvision/package.py:98, in setup_build_environment:\r\n         95        env.set('CPATH', ':'.join(include))\r\n         96        env.set('LIBRARY_PATH', ':'.join(library))\r\n         97\r\n  >>     98        if '+cuda' in self.spec['py-torch']:\r\n         99            env.set('FORCE_CUDA', 1)\r\n        100            env.set('CUDA_HOME', self.spec['cuda'].prefix)\r\n        101            pytorch_cuda_arch = ';'.join(\r\n\r\n\r\n==> Updating view at /usr/WS1/aml_user/tools/toss_3_x86_64_ib/python2/.spack-env/view\r\n==> Warning: [/usr/WS1/aml_user/tools/toss_3_x86_64_ib/python2/.spack-env/view] Skipping external package: ncurses@5.9.20130511%gcc@7.3.0~symlinks+termlib patches=f84b2708a42777aadcc7f502a261afe10ca5646a51c1ef8b5e60d2070d926b57 arch=linux-rhel7-haswell/lhk6r6h\r\n==> Warning: [/usr/WS1/aml_user/tools/toss_3_x86_64_ib/python2/.spack-env/view] Skipping external package: tar@1.26%gcc@7.3.0 patches=08921fcbd732050c74ddf1de7d8ad95ffdbc09f8b4342456fa2f6a0dd02a957c,5c314db58d005043bf407abaf25eb9823b9032a22fd12a0b142d4bf548130fa4,d428578be7fb99b831eb61e53b8d88a859afe08b479a21238180899707d79ce4 arch=linux-rhel7-haswell/mbavqfx\r\n==> Warning: [/usr/WS1/aml_user/tools/toss_3_x86_64_ib/python2/.spack-env/view] Skipping external package: cuda@10.2.89%gcc@7.3.0 arch=linux-rhel7-haswell/53eo4jr\r\n```\r\n\r\n\r\n### General information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n\r\n```\r\nspack debug report\r\n* **Spack:** 0.16.0\r\n* **Python:** 3.6.8\r\n* **Platform:** linux-rhel7-haswell\r\n```\r\n\r\n",
    "performed_via_github_app": null
}