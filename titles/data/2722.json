{
    "url": "https://api.github.com/repos/spack/spack/issues/2722",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/2722/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/2722/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/2722/events",
    "html_url": "https://github.com/spack/spack/issues/2722",
    "id": 198429841,
    "node_id": "MDU6SXNzdWUxOTg0Mjk4NDE=",
    "number": 2722,
    "title": "Fail to build gcc@4.9.3 due to `ld: cannot find -lstdc++`",
    "user": {
        "login": "weijianwen",
        "id": 908249,
        "node_id": "MDQ6VXNlcjkwODI0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/908249?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/weijianwen",
        "html_url": "https://github.com/weijianwen",
        "followers_url": "https://api.github.com/users/weijianwen/followers",
        "following_url": "https://api.github.com/users/weijianwen/following{/other_user}",
        "gists_url": "https://api.github.com/users/weijianwen/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/weijianwen/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/weijianwen/subscriptions",
        "organizations_url": "https://api.github.com/users/weijianwen/orgs",
        "repos_url": "https://api.github.com/users/weijianwen/repos",
        "events_url": "https://api.github.com/users/weijianwen/events{/privacy}",
        "received_events_url": "https://api.github.com/users/weijianwen/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 6,
    "created_at": "2017-01-03T08:42:04Z",
    "updated_at": "2017-01-04T02:56:01Z",
    "closed_at": "2017-01-04T02:55:05Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Hi. \r\n\r\nI tried to build gcc@4.9.3 again after upgrading spack to the latest version v0.9.1 at 164da8e . The error messages are as follows. gcc, gcc-c++ and libstdc++ have been installed. \r\n\r\nI'm not sure whether the  'libjava/configure' issue ( #2717 ) persists  because building stops before installation.\r\n\r\n\r\n```\r\n$ rpm -qa gcc*; rpm -qa libstd*\r\ngcc-4.8.5-11.el7.x86_64\r\ngcc-gfortran-4.8.5-11.el7.x86_64\r\ngcc-c++-4.8.5-11.el7.x86_64\r\nlibstdc++-4.8.5-11.el7.x86_64\r\nlibstdc++-devel-4.8.5-11.el7.x86_64\r\n...\r\n$ spack purge; spack install gcc@4.9.3\r\n==> Installing gcc\r\n==> gmp is already installed in /home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/gmp-6.1.0-yvehsomaeu6ye4hs2uzfs2rgtuvjlfyh\r\n==> mpc is already installed in /home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/mpc-1.0.3-awiifdxnhcofbxk4po2wmylvto45gumq\r\n==> binutils is already installed in /home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/binutils-2.26-epxamcwy43mkyeimilwwx4tzzktndxg4\r\n==> mpfr is already installed in /home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/mpfr-3.1.4-55n2azac7lipecty34vrgwdq2zsm5dwj\r\n==> Trying to fetch from http://open-source-box.org/gcc/gcc-4.9.3/gcc-4.9.3.tar.bz2\r\n######################################################################## 100.0%\r\n==> Staging archive: /home/rpm/spack/var/spack/stage/gcc-4.9.3-2hag6vkvsqwtfn7bb4udnfx4v6abe7g5/gcc-4.9.3.tar.bz2\r\n==> Created stage in /home/rpm/spack/var/spack/stage/gcc-4.9.3-2hag6vkvsqwtfn7bb4udnfx4v6abe7g5\r\n==> No patches needed for gcc\r\n==> Building gcc\r\n==> Error: Command exited with status 2:\r\n'make' '-j32'\r\n\r\nSee build log for details:\r\n  /tmp/rpm/spack-stage/spack-stage-o9PmZC/gcc-4.9.3/spack-build.out\r\n/home/rpm/spack/var/spack/repos/builtin/packages/gcc/package.py:99, in install:                                                                                     [36/1910]\r\n     52       def install(self, spec, prefix):\r\n     53           # libjava/configure needs a minor fix to install into spack paths.\r\n     54           filter_file(r\"'@.*@'\", \"'@[[:alnum:]]*@'\", 'libjava/configure',\r\n     55                       string=True)\r\n     56\r\n     57           enabled_languages = set(('c', 'c++', 'fortran', 'java', 'objc'))\r\n     58\r\n     59           if spec.satisfies(\"@4.7.1:\") and sys.platform != 'darwin':\r\n     60               enabled_languages.add('go')\r\n     61\r\n     62           # Generic options to compile GCC\r\n     63           options = [\"--prefix=%s\" % prefix, \"--libdir=%s/lib64\" % prefix,\r\n     64                      \"--disable-multilib\",\r\n     65                      \"--enable-languages=\" + ','.join(enabled_languages),\r\n     66                      \"--with-mpc=%s\" % spec['mpc'].prefix, \"--with-mpfr=%s\" %\r\n     67                      spec['mpfr'].prefix, \"--with-gmp=%s\" % spec['gmp'].prefix,\r\n     68                      \"--enable-lto\", \"--with-quad\"]\r\n     69           # Binutils\r\n     70           if spec.satisfies('+binutils'):\r\n     71               static_bootstrap_flags = \"-static-libstdc++ -static-libgcc\"                                                                                   [16/1910]\r\n     72               binutils_options = [\r\n     73                   \"--with-sysroot=/\", \"--with-stage1-ldflags=%s %s\" %\r\n     74                   (self.rpath_args, static_bootstrap_flags),\r\n     75                   \"--with-boot-ldflags=%s %s\" %\r\n     76                   (self.rpath_args, static_bootstrap_flags), \"--with-gnu-ld\",\r\n     77                   \"--with-ld=%s/bin/ld\" % spec['binutils'].prefix,\r\n     78                   \"--with-gnu-as\",\r\n     79                   \"--with-as=%s/bin/as\" % spec['binutils'].prefix\r\n     80               ]\r\n     81               options.extend(binutils_options)\r\n     82           # Isl\r\n     83           if 'isl' in spec:\r\n     84               isl_options = [\"--with-isl=%s\" % spec['isl'].prefix]\r\n     85               options.extend(isl_options)\r\n     86\r\n     87           if sys.platform == 'darwin':\r\n     88               darwin_options = [\"--with-build-config=bootstrap-debug\"]\r\n     89               options.extend(darwin_options)\r\n     90\r\n     91           build_dir = join_path(self.stage.path, 'spack-build')\r\n     92           configure = Executable(join_path(self.stage.source_path, 'configure'))\r\n     93           with working_dir(build_dir, create=True):\r\n     94               # Rest of install is straightforward.\r\n     95               configure(*options)\r\n     96               if sys.platform == 'darwin':\r\n     97                   make(\"bootstrap\")\r\n     98               else:\r\n  >> 99                   make()\r\n     100              make(\"install\")\r\n     101\r\n     102          self.write_rpath_specs()\r\n==> Error: Installation process had nonzero exit code.\r\n\r\n$ tail -20 /tmp/rpm/spack-stage/spack-stage-o9PmZC/gcc-4.9.3/spack-build.out\r\n        -o build/gengenrtl.o /home/rpm/spack/var/spack/stage/gcc-4.9.3-2hag6vkvsqwtfn7bb4udnfx4v6abe7g5/gcc-4.9.3/gcc/gengenrtl.c\r\necho timestamp > doc/gpl.7\r\n(pod2man --center=\"GNU\" --release=\"gcc-4.9.3\" --date=2015-06-26 --section=7 gpl.pod > doc/gpl.7.T$$ && \\\r\n        mv -f doc/gpl.7.T$$ doc/gpl.7) || \\\r\n        (rm -f doc/gpl.7.T$$ && exit 1)\r\n/home/rpm/spack/lib/spack/env/gcc/g++   -g -DIN_GCC    -fno-exceptions -fno-rtti -fasynchronous-unwind-tables -W -Wall -Wno-narrowing -Wwrite-strings -Wcast-qual -Wno-format -Wmissing-format-attribute -pedantic -Wno-long-long -Wno-variadic-macros -Wno-overlength-strings -fno-common  -DHAVE_CONFIG_H -DGENERATOR_FILE -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/gcc-4.9.3-2hag6vkvsqwtfn7bb4udnfx4v6abe7g5/lib -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/gcc-4.9.3-2hag6vkvsqwtfn7bb4udnfx4v6abe7g5/lib64 -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/binutils-2.26-epxamcwy43mkyeimilwwx4tzzktndxg4/lib -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/bison-3.0.4-z2lahg3c4qcf77h7vok7hes4pzhwb7hb/lib -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/libsigsegv-2.10-j32yakkbmfvvjxswoil2stezl7uvti2m/lib -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/flex-2.6.0-53bofvssstnjx5mbzcxpupw2bnxfg3k7/lib -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/gmp-6.1.0-yvehsomaeu6ye4hs2uzfs2rgtuvjlfyh/lib -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/mpc-1.0.3-awiifdxnhcofbxk4po2wmylvto45gumq/lib -Wl,-rpath,/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/mpfr-3.1.4-55n2azac7lipecty34vrgwdq2zsm5dwj/lib -static-libstdc++ -static-libgcc  -o build/genchecksum \\\r\n    build/genchecksum.o ../build-x86_64-unknown-linux-gnu/libiberty/libiberty.a\r\n/home/rpm/spack/opt/spack/linux-x86_64/gcc-4.8.5/binutils-2.26-epxamcwy43mkyeimilwwx4tzzktndxg4/bin/ld: cannot find -lstdc++\r\ncollect2: error: ld returned 1 exit status\r\n...\r\n```",
    "performed_via_github_app": null
}