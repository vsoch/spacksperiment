{
    "url": "https://api.github.com/repos/spack/spack/issues/1827",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/1827/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/1827/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/1827/events",
    "html_url": "https://github.com/spack/spack/issues/1827",
    "id": 178672382,
    "node_id": "MDU6SXNzdWUxNzg2NzIzODI=",
    "number": 1827,
    "title": "Cray: how do I use MPI compile wrappers?",
    "user": {
        "login": "KineticTheory",
        "id": 17579601,
        "node_id": "MDQ6VXNlcjE3NTc5NjAx",
        "avatar_url": "https://avatars.githubusercontent.com/u/17579601?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/KineticTheory",
        "html_url": "https://github.com/KineticTheory",
        "followers_url": "https://api.github.com/users/KineticTheory/followers",
        "following_url": "https://api.github.com/users/KineticTheory/following{/other_user}",
        "gists_url": "https://api.github.com/users/KineticTheory/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/KineticTheory/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/KineticTheory/subscriptions",
        "organizations_url": "https://api.github.com/users/KineticTheory/orgs",
        "repos_url": "https://api.github.com/users/KineticTheory/repos",
        "events_url": "https://api.github.com/users/KineticTheory/events{/privacy}",
        "received_events_url": "https://api.github.com/users/KineticTheory/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446645732,
            "node_id": "MDU6TGFiZWw0NDY2NDU3MzI=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-environment",
            "name": "build-environment",
            "color": "bfdadc",
            "default": false,
            "description": null
        },
        {
            "id": 446615268,
            "node_id": "MDU6TGFiZWw0NDY2MTUyNjg=",
            "url": "https://api.github.com/repos/spack/spack/labels/compilers",
            "name": "compilers",
            "color": "f9d0c4",
            "default": false,
            "description": null
        },
        {
            "id": 446614485,
            "node_id": "MDU6TGFiZWw0NDY2MTQ0ODU=",
            "url": "https://api.github.com/repos/spack/spack/labels/cray",
            "name": "cray",
            "color": "b60205",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 12,
    "created_at": "2016-09-22T17:31:28Z",
    "updated_at": "2016-10-11T13:47:24Z",
    "closed_at": "2016-10-11T13:46:30Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I'm trying to follow the [current documentation for Crays](http://spack.readthedocs.io/en/latest/basic_usage.html#spack-on-cray) to build parmetis on trinitite (Cray machine at LANL), but spack is trying to use `mpicc` instead of the Cray compiler wrapper `cc`. Hopefully, you can point out my configuration or install command syntax error.\n\nConfiguration files:\n[compilers.yaml](https://github.com/LLNL/spack/files/487944/compilers.yaml.txt) - automatically generated from `spack compilers`\n[packages.yaml](https://github.com/LLNL/spack/files/487945/packages.yaml.txt) - generated based on online documentation.\n\nThe documentation uses `mpi:` instead of `mpich:` in `packages.yaml`.  I'm not sure if that is a bug, but I had to change it to `mpich` in my configuration files to allow spack to resolve the mpi-flavor.\n\nHere's the spec:\n\n```\n % spack spec parmetis target=haswell os=CNL ^mpich\nInput spec\n------------------------------\n  parmetis\n      ^mpich@7.4.2 arch=cray-CNL-haswell\n\nNormalized\n------------------------------\n  parmetis\n      ^cmake@2.8:\n      ^metis@5:\n      ^mpich\n\nConcretized\n------------------------------\n  parmetis@4.0.3%intel@16.0.3~debug~gdb+shared arch=cray-CNL-haswell\n      ^cmake@3.6.2%intel@16.0.3~doc+ncurses+openssl~ownlibs~qt arch=cray-CNL-haswell\n      ^metis@5.1.0%intel@16.0.3~debug~gdb~idx64~real64+shared arch=cray-CNL-haswell\n      ^mpich@7.4.2%intel@16.0.3+hydra+pmi~verbs arch=cray-CNL-haswell\n```\n\nThat looks good, so try to install:\n\n```\n% spack install --dirty  parmetis target=haswell os=CNL\n==> Installing parmetis\n==> mpich is externally installed in /opt/cray/pe/mpt/7.4.2/gni/mpich-intel/15.0\n==> metis is already installed in /usr/projects/draco/vendors/spack.tt.20160920/opt/spack/cray-CNL-haswell/intel-16.0.3/metis-5.1.0-sd6v7to2csrd5oun2hkzufo2rs7sxquh\n==> cmake is externally installed in /usr/projects/hpcsoft/cle6.0/common/cmake\n==> Already downloaded /usr/projects/draco/vendors/spack.tt.20160920/var/spack/stage/parmetis-4.0.3-vbjpbrq7dxi4q5qei442i6aeij6hwkoa/parmetis-4.0.3.tar.gz\n==> Already staged parmetis-4.0.3-vbjpbrq7dxi4q5qei442i6aeij6hwkoa in /usr/projects/draco/vendors/spack.tt.20160920/var/spack/stage/parmetis-4.0.3-vbjpbrq7dxi4q5qei442i6aeij6hwkoa\n==> Already patched parmetis\n==> Building parmetis\n==> Error: Command exited with status 1:\n'cmake' '/usr/projects/draco/vendors/spack.tt.20160920/var/spack/stage/parmetis-4.0.3-vbjpbrq7dxi4q5qei442i6aeij6hwkoa/parmetis-4.0.3' '-DCMAKE_INSTALL_PREFIX=/usr/projects/draco/vendors/spack.tt.20160920/opt/spack/cray-CNL-haswell/intel-16.0.3/parmetis-4.0.3-vbjpbrq7dxi4q5qei442i6aeij6hwkoa' '-DCMAKE_BUILD_TYPE=RelWithDebInfo' '-DCMAKE_INSTALL_RPATH_USE_LINK_PATH=FALSE' '-DCMAKE_INSTALL_RPATH=/usr/projects/draco/vendors/spack.tt.20160920/opt/spack/cray-CNL-haswell/intel-16.0.3/parmetis-4.0.3-vbjpbrq7dxi4q5qei442i6aeij6hwkoa/lib:/usr/projects/draco/vendors/spack.tt.20160920/opt/spack/cray-CNL-haswell/intel-16.0.3/parmetis-4.0.3-vbjpbrq7dxi4q5qei442i6aeij6hwkoa/lib64:/opt/cray/pe/mpt/7.4.2/gni/mpich-intel/15.0/lib:/usr/projects/draco/vendors/spack.tt.20160920/opt/spack/cray-CNL-haswell/intel-16.0.3/metis-5.1.0-sd6v7to2csrd5oun2hkzufo2rs7sxquh/lib:/opt/gcc/5.3.0/snos' '-DGKLIB_PATH:PATH=/usr/projects/draco/vendors/spack.tt.20160920/opt/spack/cray-CNL-haswell/intel-16.0.3/metis-5.1.0-sd6v7to2csrd5oun2hkzufo2rs7sxquh/include/GKlib' '-DMETIS_PATH:PATH=/usr/projects/draco/vendors/spack.tt.20160920/opt/spack/cray-CNL-haswell/intel-16.0.3/metis-5.1.0-sd6v7to2csrd5oun2hkzufo2rs7sxquh' '-DCMAKE_C_COMPILER:STRING=/opt/cray/pe/mpt/7.4.2/gni/mpich-intel/15.0/bin/mpicc' '-DCMAKE_CXX_COMPILER:STRING=/opt/cray/pe/mpt/7.4.2/gni/mpich-intel/15.0/bin/mpic++' '-DSHARED:BOOL=ON'\n\nSee build log for details:\n  /tmp/kellyt/spack-stage/spack-stage-IdePiO/parmetis-4.0.3/spack-build.out\n```\n\nHere's the spack-build.log:\n[parmetis-spack-build.out.txt](https://github.com/LLNL/spack/files/487961/parmetis-spack-build.out.txt). \n\nSpack has set `CMAKE_C_COMPILER:STRING=/opt/cray/pe/mpt/7.4.2/gni/mpich-intel/15.0/bin/mpicc` instead of using the Cray compile wrapper `cc` \n\nShould I have something different in `packages.yaml` or should the install command have different options since we want to use the cray compile wrappers?  \n",
    "performed_via_github_app": null
}