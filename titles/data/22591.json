{
    "url": "https://api.github.com/repos/spack/spack/issues/22591",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/22591/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/22591/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/22591/events",
    "html_url": "https://github.com/spack/spack/issues/22591",
    "id": 842405271,
    "node_id": "MDU6SXNzdWU4NDI0MDUyNzE=",
    "number": 22591,
    "title": "PETSc linked to system lib \"/usr/lib/x86_64-linux-gnu/libmpi.so.20\" and \"/usr/lib/x86_64-linux-gnu/libmpi_mpifh.so.20\"",
    "user": {
        "login": "lrtfm",
        "id": 1192812,
        "node_id": "MDQ6VXNlcjExOTI4MTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1192812?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lrtfm",
        "html_url": "https://github.com/lrtfm",
        "followers_url": "https://api.github.com/users/lrtfm/followers",
        "following_url": "https://api.github.com/users/lrtfm/following{/other_user}",
        "gists_url": "https://api.github.com/users/lrtfm/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lrtfm/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lrtfm/subscriptions",
        "organizations_url": "https://api.github.com/users/lrtfm/orgs",
        "repos_url": "https://api.github.com/users/lrtfm/repos",
        "events_url": "https://api.github.com/users/lrtfm/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lrtfm/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 1433532775,
            "node_id": "MDU6TGFiZWwxNDMzNTMyNzc1",
            "url": "https://api.github.com/repos/spack/spack/labels/triage",
            "name": "triage",
            "color": "ed9793",
            "default": false,
            "description": "The issue needs to be prioritized"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-03-27T03:30:05Z",
    "updated_at": "2021-03-27T03:43:52Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "<!-- Explain, in a clear and concise way, the command you ran and the result you were trying to achieve.\r\nExample: \"I ran `spack find` to list all the installed packages and ...\" -->\r\nI install `petsc` by \r\n```\r\n$ spack install petsc+mpfr+mumps+p4est+suite-sparse+valgrind+libyaml+trilinos ^hdf5+hl\r\n$ spack find -d petsc\r\n==> 1 installed package\r\n-- linux-ubuntu18.04-skylake / gcc@7.5.0 ------------------------\r\npetsc@3.14.4\r\n    gmp@6.1.2\r\n    hdf5@1.10.7\r\n        openmpi@4.0.5\r\n            hwloc@2.4.1\r\n                libpciaccess@0.16\r\n                libxml2@2.9.10\r\n                    libiconv@1.16\r\n                    xz@5.2.5\r\n                    zlib@1.2.11\r\n                ncurses@6.2\r\n            libevent@2.1.12\r\n                openssl@1.1.1j\r\n            numactl@2.0.14\r\n            openssh@8.5p1\r\n                libedit@3.1-20210216\r\n    hypre@2.20.0\r\n        openblas@0.3.14\r\n    libyaml@0.2.5\r\n    metis@5.1.0\r\n    mpfr@4.0.2\r\n    mumps@5.3.3\r\n        netlib-scalapack@2.1.0\r\n    p4est@2.2\r\n    parmetis@4.0.3\r\n    suite-sparse@5.9.0\r\n    superlu-dist@6.4.0\r\n    trilinos@13.0.1\r\n        boost@1.75.0\r\n            bzip2@1.0.8\r\n        glm@0.9.7.1\r\n        matio@1.5.17\r\n        netcdf-c@4.7.4\r\n    valgrind@3.16.1\r\n```\r\nWhen I compile an example, it gives me a warning\r\n```\r\n/usr/bin/ld: warning: libmpi.so.20, needed by /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/petsc-3.14.4-6z2kidebavwve3tx6mqiz6gmqkdcqbrq/lib/libpetsc.so, may conflict with libmpi.so.40\r\n```\r\nwhere `libmpi.so.20` is the `mpi` in the system.\r\n\r\n@jedbrown Could you help me check this, and give me some advice?\r\n\r\nI don't know whether it's an error of `petsc` or of the compiler.  I used the systems' compiler\r\n```\r\n- compiler:\r\n    spec: gcc@7.5.0\r\n    paths:\r\n      cc: /usr/bin/gcc\r\n      cxx: /usr/bin/g++\r\n      f77: /usr/bin/gfortran\r\n      fc: /usr/bin/gfortran\r\n    flags: {}\r\n    operating_system: ubuntu18.04\r\n    target: x86_64\r\n    modules: []\r\n    environment: {}\r\n    extra_rpaths: []\r\n```\r\n\r\nThe `ldd` results of `libpetsc.so` is listed below with an attached file for `ldd` results of every lib [ldd.log](https://github.com/spack/spack/files/6215055/ldd.log).\r\n\r\n```console\r\n$ ldd /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/petsc-3.14.4-6z2kidebavwve3tx6mqiz6gmqkdcqbrq/lib/libpetsc.so\r\n        linux-vdso.so.1 (0x00007ffff07ca000)\r\n        libexodus.so.13 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/trilinos-13.0.1-yenvgieodmk46qd5vtcuzejajbrlikxs/lib/libexodus.so.13 (0x00007fedea2e6000)\r\n        libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fedea0c7000)\r\n        libHYPRE-2.20.0.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/hypre-2.20.0-sdsqmz63jd366lponat3nhwd6l2p6gj4/lib/libHYPRE-2.20.0.so (0x00007fede9b23000)\r\n        libdmumps.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/mumps-5.3.3-hwmachvo4eazwio5ltp5x5i6tyw65k5v/lib/libdmumps.so (0x00007fede972a000)\r\n        libscalapack.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/netlib-scalapack-2.1.0-yo3kybnfgdnscxgzzfsptgdhrzdto2be/lib/libscalapack.so (0x00007fede8f49000)\r\n        libumfpack.so.5 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libumfpack.so.5 (0x00007fede8c58000)\r\n        libklu.so.1 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libklu.so.1 (0x00007fede8a1f000)\r\n        libcholmod.so.3 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libcholmod.so.3 (0x00007fede870e000)\r\n        libamd.so.2 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libamd.so.2 (0x00007fede8500000)\r\n        libsuperlu_dist.so.6 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/superlu-dist-6.4.0-2huaszvx6kv4ixzahv7bjdm54uitoy7x/lib/libsuperlu_dist.so.6 (0x00007fede823f000)\r\n        libp4est-2.2.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/p4est-2.2-j4nnmjyobz4bl5c53kxbmg3df54ft6ob/lib/libp4est-2.2.so (0x00007fede7f8b000)\r\n        libsc-2.2.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/p4est-2.2-j4nnmjyobz4bl5c53kxbmg3df54ft6ob/lib/libsc-2.2.so (0x00007fede7d5d000)\r\n        libopenblas.so.0 => /usr/lib/x86_64-linux-gnu/libopenblas.so.0 (0x00007fede5ab7000)\r\n        libhdf5.so.103 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/hdf5-1.10.7-4hx4rywxznrha25rwzn2pm5l72bymgb6/lib/libhdf5.so.103 (0x00007fede54b6000)\r\n        libparmetis.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/parmetis-4.0.3-rsmsnbgdisap3v2kovd3lrz2ynthi5zc/lib/libparmetis.so (0x00007fede527d000)\r\n        libmetis.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/metis-5.1.0-5nhfc72ai2qxmtzp5yo2asgnj5lpvtpk/lib/libmetis.so (0x00007fede5003000)\r\n        libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007fede4c65000)\r\n        libmpfr.so.6 => /usr/lib/x86_64-linux-gnu/libmpfr.so.6 (0x00007fede49e5000)\r\n        libyaml-0.so.2 => /usr/lib/x86_64-linux-gnu/libyaml-0.so.2 (0x00007fede47c7000)\r\n        libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fede45c3000)\r\n        libmpi_mpifh.so.20 => /usr/lib/x86_64-linux-gnu/libmpi_mpifh.so.20 (0x00007fede436c000)\r\n        libmpi.so.20 => /usr/lib/x86_64-linux-gnu/libmpi.so.20 (0x00007fede407a000)\r\n        libgfortran.so.4 => /usr/lib/x86_64-linux-gnu/libgfortran.so.4 (0x00007fede3c9b000)\r\n        libgcc_s.so.1 => /usr/lib/gcc/x86_64-linux-gnu/7/libgcc_s.so.1 (0x00007fede3a83000)\r\n        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fede3692000)\r\n        libnetcdf.so.18 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/netcdf-c-4.7.4-ku7ovgbu57fw6wyqvgsn6nto2rfyhs6w/lib/libnetcdf.so.18 (0x00007fede3379000)\r\n        /lib64/ld-linux-x86-64.so.2 (0x00007fedec1b1000)\r\n        libmpi.so.40 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/openmpi-4.0.5-zolc54dfymrduiqv6vibzzluhj7z4jui/lib/libmpi.so.40 (0x00007fede2eae000)\r\n        libmumps_common.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/mumps-5.3.3-hwmachvo4eazwio5ltp5x5i6tyw65k5v/lib/libmumps_common.so (0x00007fede2c5e000)\r\n        libpord.so => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/mumps-5.3.3-hwmachvo4eazwio5ltp5x5i6tyw65k5v/lib/libpord.so (0x00007fede2a47000)\r\n        libmpi_mpifh.so.40 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/openmpi-4.0.5-zolc54dfymrduiqv6vibzzluhj7z4jui/lib/libmpi_mpifh.so.40 (0x00007fede27e7000)\r\n        libsuitesparseconfig.so.5 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libsuitesparseconfig.so.5 (0x00007fede25e4000)\r\n        libcolamd.so.2 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libcolamd.so.2 (0x00007fede23dc000)\r\n        libbtf.so.1 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libbtf.so.1 (0x00007fede21d7000)\r\n        libccolamd.so.2 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libccolamd.so.2 (0x00007fede1fc9000)\r\n        libcamd.so.2 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/suite-sparse-5.9.0-awpwwabvyg353c7q4ql46qili6w7birw/lib/libcamd.so.2 (0x00007fede1db9000)\r\n        libstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007fede1a30000)\r\n        libz.so.1 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/zlib-1.2.11-fz2bs562jhc2spgubs3fvq25g3qymz6x/lib/libz.so.1 (0x00007fede1819000)\r\n        libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007fede1598000)\r\n        libopen-pal.so.20 => /usr/lib/x86_64-linux-gnu/libopen-pal.so.20 (0x00007fede12e6000)\r\n        libopen-rte.so.20 => /usr/lib/x86_64-linux-gnu/libopen-rte.so.20 (0x00007fede105e000)\r\n        librt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007fede0e56000)\r\n        libhwloc.so.5 => /usr/lib/x86_64-linux-gnu/libhwloc.so.5 (0x00007fede0c19000)\r\n        libquadmath.so.0 => /usr/lib/x86_64-linux-gnu/libquadmath.so.0 (0x00007fede09d9000)\r\n        libhdf5_hl.so.100 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/hdf5-1.10.7-4hx4rywxznrha25rwzn2pm5l72bymgb6/lib/libhdf5_hl.so.100 (0x00007fede07b4000)\r\n        libopen-rte.so.40 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/openmpi-4.0.5-zolc54dfymrduiqv6vibzzluhj7z4jui/lib/libopen-rte.so.40 (0x00007fede0499000)\r\n        libopen-pal.so.40 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/openmpi-4.0.5-zolc54dfymrduiqv6vibzzluhj7z4jui/lib/libopen-pal.so.40 (0x00007feddffdc000)\r\n        libhwloc.so.15 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/hwloc-2.4.1-npun3tyosxltzglezftzziglhq75ls4x/lib/libhwloc.so.15 (0x00007feddfd84000)\r\n        libutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007feddfb81000)\r\n        libnuma.so.1 => /usr/lib/x86_64-linux-gnu/libnuma.so.1 (0x00007feddf976000)\r\n        libltdl.so.7 => /usr/lib/x86_64-linux-gnu/libltdl.so.7 (0x00007feddf76c000)\r\n        libevent_core-2.1.so.7 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/libevent-2.1.12-bm2bkfgnd5ur3rwmzp4hcrdvuayhj4yp/lib/libevent_core-2.1.so.7 (0x00007feddf535000)\r\n        libevent_pthreads-2.1.so.7 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/libevent-2.1.12-bm2bkfgnd5ur3rwmzp4hcrdvuayhj4yp/lib/libevent_pthreads-2.1.so.7 (0x00007feddf332000)\r\n        libpciaccess.so.0 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/libpciaccess-0.16-fyllhvy7teorlwvdy2sqtpooxlwjrniv/lib/libpciaccess.so.0 (0x00007feddf128000)\r\n        libxml2.so.2 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/libxml2-2.9.10-hxsopl6whqtirosqzu4blc3urkyeryhk/lib/libxml2.so.2 (0x00007feddedc7000)\r\n        liblzma.so.5 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/xz-5.2.5-yjkcmisqyqjpfqwa4cvll5qehkr25aog/lib/liblzma.so.5 (0x00007feddeba1000)\r\n        libiconv.so.2 => /home/yzz/spack/opt/spack/linux-ubuntu18.04-skylake/gcc-7.5.0/libiconv-1.16-7ddqjmff6zg3zer572yuqnvzk2ebrkfc/lib/libiconv.so.2 (0x00007fedde8a5000)\r\n```\r\n\r\n### Information on your system\r\n\r\n<!-- Please include the output of `spack debug report` -->\r\n$ spack debug report\r\n* **Spack:** 0.16.1-1890-04a02f8665\r\n* **Python:** 3.6.9\r\n* **Platform:** linux-ubuntu18.04-skylake\r\n* **Concretizer:** original\r\n\r\n<!-- If you have any relevant configuration detail (custom `packages.yaml` or `modules.yaml`, etc.) you can add that here as well. -->\r\n\r\n### Additional information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [X] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n- [ ] I have run the failing commands in debug mode and reported the output\r\n\r\n<!-- We encourage you to try, as much as possible, to reduce your problem to the minimal example that still reproduces the issue. That would help us a lot in fixing it quickly and effectively!\r\n\r\nIf you want to ask a question about the tool (how to use it, what it can currently do, etc.), try the `#general` channel on our Slack first. We have a welcoming community and chances are you'll get your reply faster and without opening an issue.\r\n\r\nOther than that, thanks for taking the time to contribute to Spack! -->\r\n",
    "performed_via_github_app": null
}