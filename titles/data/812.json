{
    "url": "https://api.github.com/repos/spack/spack/issues/812",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/812/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/812/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/812/events",
    "html_url": "https://github.com/spack/spack/pull/812",
    "id": 149879844,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NjcyNTQyNzU=",
    "number": 812,
    "title": "Check the installed HDF5 library for consistency",
    "user": {
        "login": "eschnett",
        "id": 213514,
        "node_id": "MDQ6VXNlcjIxMzUxNA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/213514?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/eschnett",
        "html_url": "https://github.com/eschnett",
        "followers_url": "https://api.github.com/users/eschnett/followers",
        "following_url": "https://api.github.com/users/eschnett/following{/other_user}",
        "gists_url": "https://api.github.com/users/eschnett/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/eschnett/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/eschnett/subscriptions",
        "organizations_url": "https://api.github.com/users/eschnett/orgs",
        "repos_url": "https://api.github.com/users/eschnett/repos",
        "events_url": "https://api.github.com/users/eschnett/events{/privacy}",
        "received_events_url": "https://api.github.com/users/eschnett/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 13,
    "created_at": "2016-04-20T20:38:25Z",
    "updated_at": "2016-05-11T19:44:00Z",
    "closed_at": "2016-05-10T08:34:10Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/812",
        "html_url": "https://github.com/spack/spack/pull/812",
        "diff_url": "https://github.com/spack/spack/pull/812.diff",
        "patch_url": "https://github.com/spack/spack/pull/812.patch"
    },
    "body": "I added a routine to the HDF5 install script that checks the installed library. This is not the self-check that HDF5 itself can perform as part of its build; rather, this tests whether Spack installed the library in such a way that its customers (other packages etc.) find a self-consistent and usable HDF5 library.\n\nIn particular, this routine builds and runs a small C program that uses the HDF5 library, thus checking include, library, and run time path settings. It also checks the version numbers, both via preprocessor constants (from include headers) and via function calls (from the library found at run time), and compares these to the expected version numbers. A mismatch leads to an error.\n\nI think such a system is generically useful for many packages. I'm suggesting to add this to HDF5 as a test balloon, and if it works, it can be cleaned up, made part of Spack, and generally be used for many other packages as well.\n\nAs a side node, I think packages could define environment variables that define the list of library names that should be used to link against a library; in this case, HDF5 could define e.g. the equivalent of `HDF5_LIBS='-lhdf5'` or similar. This is just a note, this is not implemented here.\n",
    "performed_via_github_app": null
}