{
    "url": "https://api.github.com/repos/spack/spack/issues/18520",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/18520/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/18520/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/18520/events",
    "html_url": "https://github.com/spack/spack/issues/18520",
    "id": 693733566,
    "node_id": "MDU6SXNzdWU2OTM3MzM1NjY=",
    "number": 18520,
    "title": "py-numpy: build fails when using preinstalled python [also has cython installed]",
    "user": {
        "login": "balay",
        "id": 5642668,
        "node_id": "MDQ6VXNlcjU2NDI2Njg=",
        "avatar_url": "https://avatars.githubusercontent.com/u/5642668?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/balay",
        "html_url": "https://github.com/balay",
        "followers_url": "https://api.github.com/users/balay/followers",
        "following_url": "https://api.github.com/users/balay/following{/other_user}",
        "gists_url": "https://api.github.com/users/balay/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/balay/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/balay/subscriptions",
        "organizations_url": "https://api.github.com/users/balay/orgs",
        "repos_url": "https://api.github.com/users/balay/repos",
        "events_url": "https://api.github.com/users/balay/events{/privacy}",
        "received_events_url": "https://api.github.com/users/balay/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "adamjstewart",
        "id": 12021217,
        "node_id": "MDQ6VXNlcjEyMDIxMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12021217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjstewart",
        "html_url": "https://github.com/adamjstewart",
        "followers_url": "https://api.github.com/users/adamjstewart/followers",
        "following_url": "https://api.github.com/users/adamjstewart/following{/other_user}",
        "gists_url": "https://api.github.com/users/adamjstewart/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/adamjstewart/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/adamjstewart/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjstewart/orgs",
        "repos_url": "https://api.github.com/users/adamjstewart/repos",
        "events_url": "https://api.github.com/users/adamjstewart/events{/privacy}",
        "received_events_url": "https://api.github.com/users/adamjstewart/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "adamjstewart",
            "id": 12021217,
            "node_id": "MDQ6VXNlcjEyMDIxMjE3",
            "avatar_url": "https://avatars.githubusercontent.com/u/12021217?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/adamjstewart",
            "html_url": "https://github.com/adamjstewart",
            "followers_url": "https://api.github.com/users/adamjstewart/followers",
            "following_url": "https://api.github.com/users/adamjstewart/following{/other_user}",
            "gists_url": "https://api.github.com/users/adamjstewart/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/adamjstewart/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/adamjstewart/subscriptions",
            "organizations_url": "https://api.github.com/users/adamjstewart/orgs",
            "repos_url": "https://api.github.com/users/adamjstewart/repos",
            "events_url": "https://api.github.com/users/adamjstewart/events{/privacy}",
            "received_events_url": "https://api.github.com/users/adamjstewart/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 10,
    "created_at": "2020-09-04T22:22:07Z",
    "updated_at": "2020-10-13T00:59:21Z",
    "closed_at": "2020-10-13T00:59:21Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "py-numpy build fails when using preinstalled python3. \r\n\r\nSystem Cython is also installed - however this build is using spack dependencies for cython.  Likely system cython is getting picked up instead of spack installed cython?\r\n\r\n```console\r\n[balay@pj01 .spack]$ cat ~/.spack/packages.yaml\r\npackages:\r\n  python:\r\n    externals:\r\n    - spec: \"python@3.7.8%gcc@9.3.1\"\r\n      prefix: /usr\r\n[balay@pj01 .spack]$ python3 -c \"import cython;print(cython.__version__)\"\r\n0.29.13\r\n[balay@pj01 .spack]$ spack spec py-numpy\r\nInput spec\r\n--------------------------------\r\npy-numpy\r\n\r\nConcretized\r\n--------------------------------\r\npy-numpy@1.19.1%gcc@9.3.1+blas+lapack arch=linux-fedora31-skylake\r\n    ^openblas@0.3.10%gcc@9.3.1~consistent_fpcsr~ilp64+pic+shared threads=none arch=linux-fedora31-skylake\r\n    ^py-cython@0.29.21%gcc@9.3.1 arch=linux-fedora31-skylake\r\n        ^py-setuptools@49.2.0%gcc@9.3.1 arch=linux-fedora31-skylake\r\n            ^python@3.7.8%gcc@9.3.1+bz2+ctypes+dbm~debug+libxml2+lzma~nis~optimizations+pic+pyexpat+pythoncmd+readline+shared+sqlite3+ssl~tix~tkinter~ucs4+uuid+zlib patches=0d98e93189bc278fbc37a50ed7f183bd8aaf249a8e1670a465f0db6bb4f8cf87 arch=linux-fedora31-skylake\r\n\r\n[balay@pj01 .spack]$ spack install py-numpy\r\n==> Installing openblas\r\n==> No binary for openblas found: installing from source\r\n==> Fetching https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/_source-cache/archive/04/0484d275f87e9b8641ff2eecaa9df2830cbe276ac79ad80494822721de6e1693.tar.gz\r\n############################################################################################################################################################################################################ 100.0%\r\n==> openblas: Executing phase: 'edit'\r\n==> openblas: Executing phase: 'build'\r\n==> openblas: Executing phase: 'install'\r\n[+] /home/balay/spack/opt/spack/linux-fedora31-skylake/gcc-9.3.1/openblas-0.3.10-rjaatbkpaiylnv7k7osx64n2ylyytvxu\r\n==> python@3.7.8 : externally installed in /usr\r\n[+] /usr\r\n==> Installing py-setuptools\r\n==> No binary for py-setuptools found: installing from source\r\n==> Fetching https://pypi.io/packages/source/s/setuptools/setuptools-49.2.0.zip\r\n############################################################################################################################################################################################################ 100.0%\r\n==> py-setuptools: Executing phase: 'build'\r\n==> py-setuptools: Executing phase: 'install'\r\n[+] /home/balay/spack/opt/spack/linux-fedora31-skylake/gcc-9.3.1/py-setuptools-49.2.0-c6an5huaysuobc3k4ycsacw6edoxvjxh\r\n==> Installing py-cython\r\n==> No binary for py-cython found: installing from source\r\n==> Fetching https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/_source-cache/archive/e5/e57acb89bd55943c8d8bf813763d20b9099cc7165c0f16b707631a7654be9cad.tar.gz\r\n############################################################################################################################################################################################################ 100.0%\r\n==> py-cython: Executing phase: 'build'\r\n==> py-cython: Executing phase: 'install'\r\n[+] /home/balay/spack/opt/spack/linux-fedora31-skylake/gcc-9.3.1/py-cython-0.29.21-sues7uro5rryb2b63s3esw3zihz2iuyu\r\n==> Installing py-numpy\r\n==> No binary for py-numpy found: installing from source\r\n==> Fetching https://spack-llnl-mirror.s3-us-west-2.amazonaws.com/_source-cache/archive/b8/b8456987b637232602ceb4d663cb34106f7eb780e247d51a260b84760fd8f491.zip\r\n############################################################################################################################################################################################################ 100.0%\r\n==> py-numpy: Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/usr/bin/python3.7' '-s' 'setup.py' '--no-user-cfg' 'build'\r\nSee build log for details:\r\n  /home/balay/spack-temp/stage/spack-stage-py-numpy-1.19.1-sknmujvto2tr3dqp5qbocpiwwb3k2qu4/spack-build-out.txt\r\n```\r\n```\r\n[balay@pj01 .spack]$ spack debug report\r\n* **Spack:** 0.15.4-853-f4d3a1a0c\r\n* **Python:** 3.7.8\r\n* **Platform:** linux-fedora31-skylake\r\n```\r\n\r\n### Additional information\r\n\r\n[spack-build-out.txt](https://github.com/spack/spack/files/5177157/spack-build-out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/5177158/spack-build-env.txt)\r\n",
    "performed_via_github_app": null
}