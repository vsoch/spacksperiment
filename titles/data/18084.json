{
    "url": "https://api.github.com/repos/spack/spack/issues/18084",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/18084/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/18084/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/18084/events",
    "html_url": "https://github.com/spack/spack/issues/18084",
    "id": 679609889,
    "node_id": "MDU6SXNzdWU2Nzk2MDk4ODk=",
    "number": 18084,
    "title": "Installation issue: OpenMPI has implicit runtime dependency on ssh",
    "user": {
        "login": "sethrj",
        "id": 741229,
        "node_id": "MDQ6VXNlcjc0MTIyOQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/741229?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sethrj",
        "html_url": "https://github.com/sethrj",
        "followers_url": "https://api.github.com/users/sethrj/followers",
        "following_url": "https://api.github.com/users/sethrj/following{/other_user}",
        "gists_url": "https://api.github.com/users/sethrj/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/sethrj/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/sethrj/subscriptions",
        "organizations_url": "https://api.github.com/users/sethrj/orgs",
        "repos_url": "https://api.github.com/users/sethrj/repos",
        "events_url": "https://api.github.com/users/sethrj/events{/privacy}",
        "received_events_url": "https://api.github.com/users/sethrj/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2020-08-15T17:04:51Z",
    "updated_at": "2021-03-05T11:54:24Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I'm using Spack to install OpenMPI on a Docker container (nvidia/cuda:11.0-devel-ubuntu18.04), but that image didn't by default contain ssh, leading to a runtime error (similar to https://github.com/open-mpi/ompi/issues/3625):\r\n```\r\n--------------------------------------------------------------------------\r\nThe value of the MCA parameter \"plm_rsh_agent\" was set to a path\r\nthat could not be found:\r\n\r\n  plm_rsh_agent: ssh : rsh\r\n\r\nPlease either unset the parameter, or check that the path is correct\r\n--------------------------------------------------------------------------\r\n[dc96570fc736:39976] [[INVALID],INVALID] FORCE-TERMINATE AT Not found:-13 - error plm_rsh_component.c(327)\r\n[dc96570fc736:39976] *** Process received signal ***\r\n[dc96570fc736:39976] Signal: Segmentation fault (11)\r\n[dc96570fc736:39976] Signal code: Address not mapped (1)\r\n[dc96570fc736:39976] Failing at address: (nil)\r\n[dc96570fc736:39976] [ 0] /lib/x86_64-linux-gnu/libpthread.so.0(+0x128a0)[0x7f8a0b9048a0]\r\n[dc96570fc736:39976] *** End of error message ***\r\n[dc96570fc736:39975] [[INVALID],INVALID] ORTE_ERROR_LOG: Unable to start a daemon on the local node in file ess_singleton_module.c at line 532\r\n[dc96570fc736:39975] [[INVALID],INVALID] ORTE_ERROR_LOG: Unable to start a daemon on the local node in file ess_singleton_module.c at line 166\r\n--------------------------------------------------------------------------\r\nIt looks like orte_init failed for some reason; your parallel process is\r\nlikely to abort.  There are many reasons that a parallel process can\r\nfail during orte_init; some of which are due to configuration or\r\nenvironment problems.  This failure appears to be an internal failure;\r\nhere's some additional information (which may only be relevant to an\r\nOpen MPI developer):\r\n\r\n  orte_ess_init failed\r\n  --> Returned value Unable to start a daemon on the local node (-127) instead of ORTE_SUCCESS\r\n--------------------------------------------------------------------------\r\n--------------------------------------------------------------------------\r\nIt looks like MPI_INIT failed for some reason; your parallel process is\r\nlikely to abort.  There are many reasons that a parallel process can\r\nfail during MPI_INIT; some of which are due to configuration or environment\r\nproblems.  This failure appears to be an internal failure; here's some\r\nadditional information (which may only be relevant to an Open MPI\r\ndeveloper):\r\n\r\n  ompi_mpi_init: ompi_rte_init failed\r\n  --> Returned \"Unable to start a daemon on the local node\" (-127) instead of \"Success\" (0)\r\n--------------------------------------------------------------------------\r\n*** An error occurred in MPI_Init\r\n*** on a NULL communicator\r\n*** MPI_ERRORS_ARE_FATAL (processes in this communicator will now abort,\r\n***    and potentially your MPI job)\r\n```\r\n\r\nInstalling ssh via apt-get (`LD_LIBRARY_PATH= apt-get update;LD_LIBRARY_PATH= apt-get -yqq install --no-install-recommends ssh`) *or* adding `openssh` to my spack environment fixes the error.\r\n\r\nDo we need to add a `run` dependency on openmpi with the `auto` fabric to include openssh? Is that a silly requirement because most systems have openssh already installed?\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install openmpi\r\n```\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.15.4\r\n* **Python:** 3.6.9\r\n* **Platform:** linux-ubuntu18.04-haswell\r\n\r\n### Additional information\r\n\r\n@hppritcha\r\n\r\n### General information\r\n\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [ ] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "performed_via_github_app": null
}