{
    "url": "https://api.github.com/repos/spack/spack/issues/10617",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/10617/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/10617/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/10617/events",
    "html_url": "https://github.com/spack/spack/issues/10617",
    "id": 410697811,
    "node_id": "MDU6SXNzdWU0MTA2OTc4MTE=",
    "number": 10617,
    "title": "Installation issue: libxpm",
    "user": {
        "login": "HadrienG2",
        "id": 1305080,
        "node_id": "MDQ6VXNlcjEzMDUwODA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1305080?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/HadrienG2",
        "html_url": "https://github.com/HadrienG2",
        "followers_url": "https://api.github.com/users/HadrienG2/followers",
        "following_url": "https://api.github.com/users/HadrienG2/following{/other_user}",
        "gists_url": "https://api.github.com/users/HadrienG2/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/HadrienG2/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/HadrienG2/subscriptions",
        "organizations_url": "https://api.github.com/users/HadrienG2/orgs",
        "repos_url": "https://api.github.com/users/HadrienG2/repos",
        "events_url": "https://api.github.com/users/HadrienG2/events{/privacy}",
        "received_events_url": "https://api.github.com/users/HadrienG2/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 446634397,
            "node_id": "MDU6TGFiZWw0NDY2MzQzOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/discussion",
            "name": "discussion",
            "color": "a87f5a",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 18,
    "created_at": "2019-02-15T10:19:49Z",
    "updated_at": "2019-02-15T23:21:36Z",
    "closed_at": "2019-02-15T23:21:36Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "On openSUSE Tumbleweed, the libxpm configuration fails because a test binary which successfully compiles cannot find its library dependencies at run time. Perhaps this is an issue with RPATHs?\r\n\r\n**Updated 15 Feb:** This installation failure is triggered by the path handling changes of #8136 (though it may not be the root cause). Therefore, reverting #8136 along with child PRs such as #10604 is a way to restore the build until the underlying problem is resolved.\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install libxpm\r\n\r\n    [ ... abriged ... ]\r\n\r\n==> Installing libxpm\r\n==> Searching for binary cache of libxpm\r\n==> Warning: No Spack mirrors are currently configured\r\n==> No binary for libxpm found: installing from source\r\n==> Warning: A dependency has updated CPATH, this may lead pkg-config to assume that the package is part of the system includes and omit it when invoked with '--cflags'.\r\n==> Fetching https://www.x.org/archive//individual/lib/libXpm-3.5.12.tar.gz\r\n#=#=-  #       #                                                                                                                                                                                                                                               #=O=#     #        #                                                                                                                                                                                                                                           -#O=- #      #          #                                                                                                   ######################################################################################################################################################################################################################################################### 100.0%\r\n==> Staging archive: /opt/spack/var/spack/stage/libxpm-3.5.12-xct4e36uamewlxuxznptzkpt5sjpf3y5/libXpm-3.5.12.tar.gz\r\n==> Created stage in /opt/spack/var/spack/stage/libxpm-3.5.12-xct4e36uamewlxuxznptzkpt5sjpf3y5\r\n==> No patches needed for libxpm\r\n==> Building libxpm [AutotoolsPackage]\r\n==> Executing phase: 'autoreconf'\r\n==> Executing phase: 'configure'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/opt/spack/var/spack/stage/libxpm-3.5.12-xct4e36uamewlxuxznptzkpt5sjpf3y5/libXpm-3.5.12/configure' '--prefix=/opt/spack/opt/spack/linux-opensuse_tumbleweed20190209-x86_64/gcc-8.2.1/libxpm-3.5.12-xct4e36uamewlxuxznptzkpt5sjpf3y5'\r\n\r\n2 errors found in build log:\r\n     12    checking how to print strings... printf\r\n     13    checking for style of include used by make... GNU\r\n     14    checking for gcc... /opt/spack/lib/spack/env/gcc/gcc\r\n     15    checking whether the C compiler works... yes\r\n     16    checking for C compiler default output file name... a.out\r\n     17    checking for suffix of executables...\r\n  >> 18    checking whether we are cross compiling... configure: error: in `/tmp/root/spack-stage/spack-stage-eFcsYw/libXpm-3.5.12':\r\n  >> 19    configure: error: cannot run C compiled programs.\r\n     20    If you meant to cross compile, use `--host'.\r\n     21    See `config.log' for more details\r\n\r\nSee build log for details:\r\n  /opt/spack/var/spack/stage/libxpm-3.5.12-xct4e36uamewlxuxznptzkpt5sjpf3y5/libXpm-3.5.12/spack-build.out\r\n```\r\n\r\nMeanwhile in config.log:\r\n\r\n```\r\n    [ ... abriged ... ]\r\n\r\nconfigure:3543: checking whether we are cross compiling\r\nconfigure:3551: /opt/spack/lib/spack/env/gcc/gcc -o conftest   -L/opt/spack/opt/spack/linux-opensuse_tumbleweed20190209-x86_64/gcc-8.2.1/gettext-0.19.8.1-iripatjl75pcvvcekmu6bc5qqnzggnck/lib -lintl conftest.c  >&5\r\nconfigure:3555: $? = 0\r\nconfigure:3562: ./conftest\r\n./conftest: error while loading shared libraries: libintl.so.8: cannot open shared object file: No such file or directory\r\nconfigure:3566: $? = 127\r\nconfigure:3573: error: in `/tmp/root/spack-stage/spack-stage-eFcsYw/libXpm-3.5.12':\r\nconfigure:3575: error: cannot run C compiled programs.\r\nIf you meant to cross compile, use `--host'.\r\nSee `config.log' for more details\r\n\r\n    [ ... abriged ... ]\r\n```\r\n\r\nFor sure, that libintl is right where the configure script expected it:\r\n\r\n```\r\n$ ls -l /opt/spack/opt/spack/linux-opensuse_tumbleweed20190209-x86_64/gcc-8.2.1/gettext-0.19.8.1-iripatjl75pcvvcekmu6bc5qqnzggnck/lib\r\ntotal 13576\r\ndrwxr-sr-x 1 root root      92 Feb 15 09:56 gettext\r\n-rw-r--r-- 1 root root   72064 Feb 15 09:56 libasprintf.a\r\n-rwxr-xr-x 1 root root    1180 Feb 15 09:56 libasprintf.la\r\nlrwxrwxrwx 1 root root      20 Feb 15 09:56 libasprintf.so -> libasprintf.so.0.0.0\r\nlrwxrwxrwx 1 root root      20 Feb 15 09:56 libasprintf.so.0 -> libasprintf.so.0.0.0\r\n-rwxr-xr-x 1 root root   82776 Feb 15 09:56 libasprintf.so.0.0.0\r\n-rwxr-xr-x 1 root root 2780784 Feb 15 09:56 libgettextlib-0.19.8.1.so\r\n-rw-r--r-- 1 root root 4069412 Feb 15 09:56 libgettextlib.a\r\n-rwxr-xr-x 1 root root    2275 Feb 15 09:56 libgettextlib.la\r\nlrwxrwxrwx 1 root root      25 Feb 15 09:56 libgettextlib.so -> libgettextlib-0.19.8.1.so\r\n-rw-r--r-- 1 root root 2681538 Feb 15 09:56 libgettextpo.a\r\n-rwxr-xr-x 1 root root    1336 Feb 15 09:56 libgettextpo.la\r\nlrwxrwxrwx 1 root root      21 Feb 15 09:56 libgettextpo.so -> libgettextpo.so.0.5.4\r\nlrwxrwxrwx 1 root root      21 Feb 15 09:56 libgettextpo.so.0 -> libgettextpo.so.0.5.4\r\n-rwxr-xr-x 1 root root 1821024 Feb 15 09:56 libgettextpo.so.0.5.4\r\n-rwxr-xr-x 1 root root 1691008 Feb 15 09:56 libgettextsrc-0.19.8.1.so\r\n-rwxr-xr-x 1 root root    2418 Feb 15 09:56 libgettextsrc.la\r\nlrwxrwxrwx 1 root root      25 Feb 15 09:56 libgettextsrc.so -> libgettextsrc-0.19.8.1.so\r\n-rw-r--r-- 1 root root  396396 Feb 15 09:56 libintl.a\r\n-rw-r--r-- 1 root root    1164 Feb 15 09:56 libintl.la\r\nlrwxrwxrwx 1 root root      16 Feb 15 09:56 libintl.so -> libintl.so.8.1.5\r\nlrwxrwxrwx 1 root root      16 Feb 15 09:56 libintl.so.8 -> libintl.so.8.1.5\r\n-rw-r--r-- 1 root root  238360 Feb 15 09:56 libintl.so.8.1.5\r\n```\r\n\r\n...but it seems the final binary cannot find it. This smells suspiciously like an LD_LIBRARY_PATH problem, but my understanding of Spack's compiler wrappers was that its use of RPATHs should normally prevent that kind of issues.\r\n\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n```commandline\r\n$ uname -a \r\nLinux a3d284dcee9b 4.20.6-1-default #1 SMP PREEMPT Thu Jan 31 07:37:50 UTC 2019 (463cfd2) x86_64 x86_64 x86_64 GNU/Linux\r\n$ cat /etc/os-release \r\nNAME=\"openSUSE Tumbleweed\"\r\n# VERSION=\"20190209\"\r\nID=\"opensuse-tumbleweed\"\r\nID_LIKE=\"opensuse suse\"\r\nVERSION_ID=\"20190209\"\r\nPRETTY_NAME=\"openSUSE Tumbleweed\"\r\nANSI_COLOR=\"0;32\"\r\nCPE_NAME=\"cpe:/o:opensuse:tumbleweed:20190209\"\r\nBUG_REPORT_URL=\"https://bugs.opensuse.org\"\r\nHOME_URL=\"https://www.opensuse.org/\"\r\n``` ",
    "performed_via_github_app": null
}