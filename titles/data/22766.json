{
    "url": "https://api.github.com/repos/spack/spack/issues/22766",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/22766/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/22766/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/22766/events",
    "html_url": "https://github.com/spack/spack/issues/22766",
    "id": 849710333,
    "node_id": "MDU6SXNzdWU4NDk3MTAzMzM=",
    "number": 22766,
    "title": "Quotes aren't needed because spack doesn't use a shell. Consider removing them",
    "user": {
        "login": "adamjstewart",
        "id": 12021217,
        "node_id": "MDQ6VXNlcjEyMDIxMjE3",
        "avatar_url": "https://avatars.githubusercontent.com/u/12021217?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamjstewart",
        "html_url": "https://github.com/adamjstewart",
        "followers_url": "https://api.github.com/users/adamjstewart/followers",
        "following_url": "https://api.github.com/users/adamjstewart/following{/other_user}",
        "gists_url": "https://api.github.com/users/adamjstewart/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/adamjstewart/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/adamjstewart/subscriptions",
        "organizations_url": "https://api.github.com/users/adamjstewart/orgs",
        "repos_url": "https://api.github.com/users/adamjstewart/repos",
        "events_url": "https://api.github.com/users/adamjstewart/events{/privacy}",
        "received_events_url": "https://api.github.com/users/adamjstewart/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 509628729,
            "node_id": "MDU6TGFiZWw1MDk2Mjg3Mjk=",
            "url": "https://api.github.com/repos/spack/spack/labels/error-messages",
            "name": "error-messages",
            "color": "f9d0c4",
            "default": false,
            "description": null
        },
        {
            "id": 512483297,
            "node_id": "MDU6TGFiZWw1MTI0ODMyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-low",
            "name": "impact-low",
            "color": "fef2c0",
            "default": false,
            "description": ""
        },
        {
            "id": 477156668,
            "node_id": "MDU6TGFiZWw0NzcxNTY2Njg=",
            "url": "https://api.github.com/repos/spack/spack/labels/intel",
            "name": "intel",
            "color": "127cc1",
            "default": false,
            "description": null
        },
        {
            "id": 2061910540,
            "node_id": "MDU6TGFiZWwyMDYxOTEwNTQw",
            "url": "https://api.github.com/repos/spack/spack/labels/run-environment",
            "name": "run-environment",
            "color": "57f9c6",
            "default": false,
            "description": ""
        },
        {
            "id": 521903170,
            "node_id": "MDU6TGFiZWw1MjE5MDMxNzA=",
            "url": "https://api.github.com/repos/spack/spack/labels/user-experience",
            "name": "user-experience",
            "color": "bfdadc",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-04-03T18:03:05Z",
    "updated_at": "2021-04-06T05:13:55Z",
    "closed_at": "2021-04-06T05:13:55Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "If you use `spack load` to load any package that uses `spack.util.environment.from_sourcing_file` (**including all Intel packages**), or any package that _depends_ on one of these packages, Spack emits the aforementioned erroneous warning message. We should remove this warning.\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install intel-mkl\r\n$ spack load intel-mkl\r\n```\r\n\r\n### Error Message\r\n\r\n```console\r\n$ spack load intel-mkl\r\n==> Warning: Quotes in command arguments can confuse scripts like configure.\r\n  The following arguments may cause problems when executed:\r\n      source /dev/null &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"\r\n  Quotes aren't needed because spack doesn't use a shell.\r\n  Consider removing them\r\n==> Warning: Quotes in command arguments can confuse scripts like configure.\r\n  The following arguments may cause problems when executed:\r\n      source /opt/intel/compilers_and_libraries_2020.0.166/mac/mkl/bin/mklvars.sh intel64 &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"\r\n  Quotes aren't needed because spack doesn't use a shell.\r\n  Consider removing them\r\n```\r\n\r\n```console\r\n$ spack -d load intel-mkl\r\n==> [2021-04-03-12:58:51.404517] Imported load from built-in commands\r\n==> [2021-04-03-12:58:51.406030] Imported load from built-in commands\r\n==> [2021-04-03-12:58:51.408626] Reading config file /Users/Adam/spack/etc/spack/defaults/config.yaml\r\n==> [2021-04-03-12:58:51.445309] Reading config file /Users/Adam/.spack/config.yaml\r\n==> [2021-04-03-12:58:51.448786] DATABASE LOCK TIMEOUT: 3s\r\n==> [2021-04-03-12:58:51.448919] PACKAGE LOCK TIMEOUT: No timeout\r\n==> [2021-04-03-12:58:51.697714] Reading config file /Users/Adam/spack/etc/spack/defaults/repos.yaml\r\n==> [2021-04-03-12:58:54.283298] Reading config file /Users/Adam/spack/etc/spack/defaults/modules.yaml\r\n==> [2021-04-03-12:58:54.300375] Reading config file /Users/Adam/spack/etc/spack/defaults/darwin/modules.yaml\r\n==> [2021-04-03-12:58:54.306236] Reading config file /Users/Adam/.spack/modules.yaml\r\n==> [2021-04-03-12:58:54.552076] Reading config file /Users/Adam/.spack/darwin/compilers.yaml\r\n==> [2021-04-03-12:58:54.582045] normalize_path.normalize_suite_dir:\ttrying /opt/intel/compilers_and_libraries_2020.0.166\r\n==> [2021-04-03-12:58:54.583319] normalize_path.normalize_suite_dir:\tfound 1:\r\n  ['/opt/intel/compilers_and_libraries_2020.0.166']\r\n==> [2021-04-03-12:58:54.584315] normalize_path.normalize_suite_dir:\t/opt/intel/compilers_and_libraries_2020.0.166\r\n==> [2021-04-03-12:58:54.585610] file_to_source.normalize_path:\t/opt/intel/compilers_and_libraries_2020.0.166/mac/mkl/bin/mklvars.sh\r\n==> [2021-04-03-12:58:54.585712] sourcing /opt/intel/compilers_and_libraries_2020.0.166/mac/mkl/bin/mklvars.sh\r\n==> [2021-04-03-12:58:54.587316] Warning: Quotes in command arguments can confuse scripts like configure.\r\n  The following arguments may cause problems when executed:\r\n      source /dev/null &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"\r\n  Quotes aren't needed because spack doesn't use a shell.\r\n  Consider removing them\r\n==> [2021-04-03-12:58:54.587617] '/bin/bash' '-c' 'source /dev/null &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"'\r\n==> [2021-04-03-12:58:54.742466] Warning: Quotes in command arguments can confuse scripts like configure.\r\n  The following arguments may cause problems when executed:\r\n      source /opt/intel/compilers_and_libraries_2020.0.166/mac/mkl/bin/mklvars.sh intel64 &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"\r\n  Quotes aren't needed because spack doesn't use a shell.\r\n  Consider removing them\r\n==> [2021-04-03-12:58:54.742856] '/bin/bash' '-c' 'source /opt/intel/compilers_and_libraries_2020.0.166/mac/mkl/bin/mklvars.sh intel64 &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"'\r\n==> [2021-04-03-12:58:55.186467] '/Users/Adam/spack/opt/spack/darwin-catalina-x86_64/apple-clang-12.0.0/python-3.8.8-hb53qjrjzg2glssozy2xoppjczwuh2bs/bin/python3.8' '-c' 'from distutils.sysconfig import get_config_h_filename; print(get_config_h_filename())'\r\n==> [2021-04-03-12:58:55.371812] '/Users/Adam/spack/opt/spack/darwin-catalina-x86_64/apple-clang-12.0.0/python-3.8.8-hb53qjrjzg2glssozy2xoppjczwuh2bs/bin/python3.8' '-c' 'from distutils.sysconfig import get_config_var; print(get_config_var('\"'\"'prefix'\"'\"'))'\r\n```\r\n\r\n### Information on your system\r\n\r\n* **Spack:** 0.16.1-2031-d978d72e19\r\n* **Python:** 3.8.7\r\n* **Platform:** darwin-catalina-ivybridge\r\n* **Concretizer:** clingo\r\n\r\n### Additional information\r\n\r\nBasically, the command we are running is:\r\n```console\r\n$ '/bin/bash' '-c' 'source /opt/intel/compilers_and_libraries_2020.0.166/mac/mkl/bin/mklvars.sh intel64 &> /dev/null && python3 -c \"import os, json; print(json.dumps(dict(os.environ)))\"'\r\n```\r\nWhile it's true that the outer set of single quotes is not necessary, the inner set of double quotes is necessary for the command to work. This seems like a false positive. I think the easiest solution is to add a \"ignore_quotes\" kwarg to the `Executable.__call__` method.\r\n\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n- [x] I have run the failing commands in debug mode and reported the output",
    "performed_via_github_app": null
}