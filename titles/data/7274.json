{
    "url": "https://api.github.com/repos/spack/spack/issues/7274",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/7274/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/7274/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/7274/events",
    "html_url": "https://github.com/spack/spack/issues/7274",
    "id": 298001897,
    "node_id": "MDU6SXNzdWUyOTgwMDE4OTc=",
    "number": 7274,
    "title": "Why openexr doesn't find the zlib?",
    "user": {
        "login": "adamryczkowski",
        "id": 4469707,
        "node_id": "MDQ6VXNlcjQ0Njk3MDc=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4469707?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/adamryczkowski",
        "html_url": "https://github.com/adamryczkowski",
        "followers_url": "https://api.github.com/users/adamryczkowski/followers",
        "following_url": "https://api.github.com/users/adamryczkowski/following{/other_user}",
        "gists_url": "https://api.github.com/users/adamryczkowski/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/adamryczkowski/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/adamryczkowski/subscriptions",
        "organizations_url": "https://api.github.com/users/adamryczkowski/orgs",
        "repos_url": "https://api.github.com/users/adamryczkowski/repos",
        "events_url": "https://api.github.com/users/adamryczkowski/events{/privacy}",
        "received_events_url": "https://api.github.com/users/adamryczkowski/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2018-02-17T12:37:34Z",
    "updated_at": "2018-11-13T05:18:54Z",
    "closed_at": "2018-11-13T05:18:54Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "I want to install `openexr` to the already existing Ubuntu 16.04 machine through Spack. Configure fails with error message \"OpenEXR requires a recent version of zlib, which you don't appear to have.\"\r\n\r\nCan you help me to diagnoze the problem? Of course zlib is installed (via Spack), because it is the dependency and (required by `spack bootstrap`).\r\n\r\nHere is the output of `spack --debug --verbose install openexr`:\r\n\r\n```\r\n==> Reading config file /home/adam/spack/etc/spack/defaults/packages.yaml\r\n==> READ LOCK: /home/adam/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Acquiring]\r\n==> READ LOCK: /home/adam/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Acquired]\r\n==> READ LOCK: /home/adam/.spack/cache/providers/.builtin-index.yaml.lock[0:0] [Released]\r\n==> Reading config file /home/adam/.spack/linux/compilers.yaml\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Acquiring]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Acquired]\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/lock[0:0] [Acquiring]\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/lock[0:0] [Acquired]\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/lock[0:0] [Released]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Released]\r\n==> link /home/adam/spack/var/spack/stage/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau -> /tmp/adam/spack-stage/spack-stage-r6a1Ob\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Acquiring]\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Acquired]\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Released]\r\n==> Installing openexr dependencies\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[4221036580051759317:1] [Acquiring]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[4221036580051759317:1] [Acquired]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[4221036580051759317:1] [Released]\r\n==> link /home/adam/spack/var/spack/stage/ilmbase-2.2.0-ouuejt5d2rq2v5je7lfbh5occkxk475w -> /tmp/adam/spack-stage/spack-stage-XEfHMz\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[4221036580051759317:1] [Acquiring]\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[4221036580051759317:1] [Acquired]\r\n==> ilmbase is already installed in /home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/ilmbase-2.2.0-ouuejt5d2rq2v5je7lfbh5occkxk475w\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[4221036580051759317:1] [Released]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[840816945095314796:1] [Acquiring]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[840816945095314796:1] [Acquired]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[840816945095314796:1] [Released]\r\n==> link /home/adam/spack/var/spack/stage/pkgconf-1.4.0-c5lf2hilcinnqpf3nojkif3eauay2gko -> /tmp/adam/spack-stage/spack-stage-613ikE\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[840816945095314796:1] [Acquiring]\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[840816945095314796:1] [Acquired]\r\n==> pkgconf is already installed in /home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/pkgconf-1.4.0-c5lf2hilcinnqpf3nojkif3eauay2gko\r\n==> READ LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[840816945095314796:1] [Released]\r\n==> Installing openexr\r\n==> Using cached archive: /home/adam/spack/var/spack/cache/openexr/openexr-2.2.0.tar.gz\r\n==> Staging archive: /home/adam/spack/var/spack/stage/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau/openexr-2.2.0.tar.gz\r\n==> '/bin/tar' '-xf' '/home/adam/spack/var/spack/stage/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau/openexr-2.2.0.tar.gz'\r\n==> Created stage in /home/adam/spack/var/spack/stage/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau\r\n==> No patches needed for openexr\r\n==> Building openexr [Package]\r\n==> WRITE LOCK: /home/adam/spack/var/spack/stage/.lock[5482083359908941077:1] [Acquiring]\r\n==> WRITE LOCK: /home/adam/spack/var/spack/stage/.lock[5482083359908941077:1] [Acquired]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Acquiring]\r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Acquired]\r\n==> Executing phase: 'install'\r\n==> './configure' '--prefix=/home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau' '--disable-debug'\r\nconfigure: WARNING: unrecognized options: --disable-debug\r\nchecking build system type... x86_64-unknown-linux-gnu\r\nchecking host system type... x86_64-unknown-linux-gnu\r\nchecking for a BSD-compatible install... /usr/bin/install -c\r\nchecking whether build environment is sane... yes\r\nchecking for a thread-safe mkdir -p... /bin/mkdir -p\r\nchecking for gawk... gawk\r\nchecking whether make sets $(MAKE)... yes\r\nchecking whether to enable maintainer-specific portions of Makefiles... no\r\nchecking for C++ compiler default output file name... a.out\r\nchecking whether the C++ compiler works... yes\r\nchecking whether we are cross compiling... no\r\nchecking for suffix of executables... \r\nchecking for suffix of object files... o\r\nchecking whether we are using the GNU C++ compiler... yes\r\nchecking whether /home/adam/spack/lib/spack/env/gcc/g++ accepts -g... yes\r\nchecking for style of include used by make... GNU\r\nchecking dependency style of /home/adam/spack/lib/spack/env/gcc/g++... gcc3\r\nchecking for a BSD-compatible install... /usr/bin/install -c\r\nchecking for gcc... /home/adam/spack/lib/spack/env/gcc/gcc\r\nchecking whether we are using the GNU C compiler... yes\r\nchecking whether /home/adam/spack/lib/spack/env/gcc/gcc accepts -g... yes\r\nchecking for /home/adam/spack/lib/spack/env/gcc/gcc option to accept ISO C89... none needed\r\nchecking dependency style of /home/adam/spack/lib/spack/env/gcc/gcc... gcc3\r\nchecking whether ln -s works... yes\r\nchecking for a sed that does not truncate output... /bin/sed\r\nchecking for grep that handles long lines and -e... /bin/grep\r\nchecking for egrep... /bin/grep -E\r\nchecking for fgrep... /bin/grep -F\r\nchecking for ld used by /home/adam/spack/lib/spack/env/gcc/gcc... /home/adam/spack/lib/spack/env/ld\r\nchecking if the linker (/home/adam/spack/lib/spack/env/ld) is GNU ld... yes\r\nchecking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B\r\nchecking the name lister (/usr/bin/nm -B) interface... BSD nm\r\nchecking the maximum length of command line arguments... 1572864\r\nchecking whether the shell understands some XSI constructs... yes\r\nchecking whether the shell understands \"+=\"... yes\r\nchecking for /home/adam/spack/lib/spack/env/ld option to reload object files... -r\r\nchecking for objdump... objdump\r\nchecking how to recognize dependent libraries... pass_all\r\nchecking for ar... ar\r\nchecking for strip... strip\r\nchecking for ranlib... ranlib\r\nchecking command to parse /usr/bin/nm -B output from /home/adam/spack/lib/spack/env/gcc/gcc object... ok\r\nchecking how to run the C preprocessor... /home/adam/spack/lib/spack/env/gcc/gcc -E\r\nchecking for ANSI C header files... yes\r\nchecking for sys/types.h... yes\r\nchecking for sys/stat.h... yes\r\nchecking for stdlib.h... yes\r\nchecking for string.h... yes\r\nchecking for memory.h... yes\r\nchecking for strings.h... yes\r\nchecking for inttypes.h... yes\r\nchecking for stdint.h... yes\r\nchecking for unistd.h... yes\r\nchecking for dlfcn.h... yes\r\nchecking whether we are using the GNU C++ compiler... (cached) yes\r\nchecking whether /home/adam/spack/lib/spack/env/gcc/g++ accepts -g... (cached) yes\r\nchecking dependency style of /home/adam/spack/lib/spack/env/gcc/g++... (cached) gcc3\r\nchecking how to run the C++ preprocessor... /home/adam/spack/lib/spack/env/gcc/g++ -E\r\nchecking for objdir... .libs\r\nchecking if /home/adam/spack/lib/spack/env/gcc/gcc supports -fno-rtti -fno-exceptions... no\r\nchecking for /home/adam/spack/lib/spack/env/gcc/gcc option to produce PIC... -fPIC -DPIC\r\nchecking if /home/adam/spack/lib/spack/env/gcc/gcc PIC flag -fPIC -DPIC works... yes\r\nchecking if /home/adam/spack/lib/spack/env/gcc/gcc static flag -static works... yes\r\nchecking if /home/adam/spack/lib/spack/env/gcc/gcc supports -c -o file.o... yes\r\nchecking if /home/adam/spack/lib/spack/env/gcc/gcc supports -c -o file.o... (cached) yes\r\nchecking whether the /home/adam/spack/lib/spack/env/gcc/gcc linker (/home/adam/spack/lib/spack/env/ld -m elf_x86_64) supports shared libraries... yes\r\nchecking whether -lc should be explicitly linked in... no\r\nchecking dynamic linker characteristics... GNU/Linux ld.so\r\nchecking how to hardcode library paths into programs... immediate\r\nchecking whether stripping libraries is possible... yes\r\nchecking if libtool supports shared libraries... yes\r\nchecking whether to build shared libraries... yes\r\nchecking whether to build static libraries... yes\r\nchecking for ld used by /home/adam/spack/lib/spack/env/gcc/g++... /home/adam/spack/lib/spack/env/ld -m elf_x86_64\r\nchecking if the linker (/home/adam/spack/lib/spack/env/ld -m elf_x86_64) is GNU ld... yes\r\nchecking whether the /home/adam/spack/lib/spack/env/gcc/g++ linker (/home/adam/spack/lib/spack/env/ld -m elf_x86_64) supports shared libraries... yes\r\nchecking for /home/adam/spack/lib/spack/env/gcc/g++ option to produce PIC... -fPIC -DPIC\r\nchecking if /home/adam/spack/lib/spack/env/gcc/g++ PIC flag -fPIC -DPIC works... yes\r\nchecking if /home/adam/spack/lib/spack/env/gcc/g++ static flag -static works... yes\r\nchecking if /home/adam/spack/lib/spack/env/gcc/g++ supports -c -o file.o... yes\r\nchecking if /home/adam/spack/lib/spack/env/gcc/g++ supports -c -o file.o... (cached) yes\r\nchecking whether the /home/adam/spack/lib/spack/env/gcc/g++ linker (/home/adam/spack/lib/spack/env/ld -m elf_x86_64) supports shared libraries... yes\r\nchecking dynamic linker characteristics... GNU/Linux ld.so\r\nchecking how to hardcode library paths into programs... immediate\r\nchecking whether make sets $(MAKE)... (cached) yes\r\ntest_prefix = NONE\r\nchecking for pkg-config... /home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/pkgconf-1.4.0-c5lf2hilcinnqpf3nojkif3eauay2gko/bin/pkg-config\r\nusing pkg-config to set ILMBASE_CXXFLAGS and ILMBASE_LDFLAGS:\r\n    ILMBASE_CXXFLAGS = -pthread -I/home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/ilmbase-2.2.0-ouuejt5d2rq2v5je7lfbh5occkxk475w/include/OpenEXR \r\n    ILMBASE_LDFLAGS = -L/home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/ilmbase-2.2.0-ouuejt5d2rq2v5je7lfbh5occkxk475w/lib \r\n    ILMBASE_LIBS = -L/home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/ilmbase-2.2.0-ouuejt5d2rq2v5je7lfbh5occkxk475w/lib -lImath -lHalf -lIex -lIexMath -lIlmThread -pthread \r\nchecking for IlmBase... yes\r\nCompiled and ran IlmBase test program.\r\nchecking for ANSI C header files... (cached) yes\r\nchecking limits.h usability... yes\r\nchecking limits.h presence... yes\r\nchecking for limits.h... yes\r\nchecking for unistd.h... (cached) yes\r\nchecking for an ANSI C-conforming const... yes\r\nchecking for inline... inline\r\nchecking for size_t... yes\r\nchecking for compress in -lz... no\r\nconfigure: error:\r\n*** OpenEXR requires a recent version of zlib, which you don't appear to\r\n*** have.\r\n***\r\n*** This could be because the run-time linker is not finding zlib, or it\r\n*** is finding the wrong version.  In this case, you'll need to set your\r\n*** LD_LIBRARY_PATH environment variable, or edit /etc/ld.so.conf to point\r\n*** to the proper version.  Also, make sure you have run ldconfig if\r\n*** that is required on your system.\r\n\t\t\t   \r\n==> WRITE LOCK: /home/adam/spack/opt/spack/.spack-db/prefix_lock[8917411056477007060:1] [Released]\r\n==> WRITE LOCK: /home/adam/spack/var/spack/stage/.lock[5482083359908941077:1] [Released]\r\n==> Error: ProcessError: Command exited with status 1:\r\n    './configure' '--prefix=/home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau' '--disable-debug'\r\n\r\n1 error found in build log:\r\n     100    checking for limits.h... yes\r\n     101    checking for unistd.h... (cached) yes\r\n     102    checking for an ANSI C-conforming const... yes\r\n     103    checking for inline... inline\r\n     104    checking for size_t... yes\r\n     105    checking for compress in -lz... no\r\n  >> 106    configure: error:\r\n     107    *** OpenEXR requires a recent version of zlib, which you don't appear to\r\n     108    *** have.\r\n     109    ***\r\n     110    *** This could be because the run-time linker is not finding zlib, or it\r\n     111    *** is finding the wrong version.  In this case, you'll need to set your\r\n     112    *** LD_LIBRARY_PATH environment variable, or edit /etc/ld.so.conf to point\r\n\r\nSee build log for details:\r\n  /home/adam/spack/var/spack/stage/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau/openexr-2.2.0/spack-build.out\r\nTraceback (most recent call last):\r\n  File \"/home/adam/spack/lib/spack/spack/build_environment.py\", line 666, in child_process\r\n    return_value = function()\r\n  File \"/home/adam/spack/lib/spack/spack/package.py\", line 1459, in build_process\r\n    phase(self.spec, self.prefix)\r\n  File \"/home/adam/spack/lib/spack/spack/package.py\", line 115, in phase_wrapper\r\n    phase(spec, prefix)\r\n  File \"/home/adam/spack/var/spack/repos/builtin/packages/openexr/package.py\", line 53, in install\r\n    configure(*configure_options)\r\n  File \"/home/adam/spack/lib/spack/spack/util/executable.py\", line 183, in __call__\r\n    proc.returncode, cmd_line)\r\nProcessError: Command exited with status 1:\r\n    './configure' '--prefix=/home/adam/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.4.0/openexr-2.2.0-66baioac47m2rqr3lsjjaet73wlx3tau' '--disable-debug'\r\n```\r\n\r\nAs you can see, I use the Ubuntu build-in `gcc-5.4.0`. \r\n\r\nLoading the `zlib` through the `spack load zlib` prior to build seems to make no effect.",
    "performed_via_github_app": null
}