{
    "url": "https://api.github.com/repos/spack/spack/issues/8699",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/8699/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/8699/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/8699/events",
    "html_url": "https://github.com/spack/spack/pull/8699",
    "id": 340839835,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MjAxMTU4MDIx",
    "number": 8699,
    "title": "[WIP] Add patches to mirrors",
    "user": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446756736,
            "node_id": "MDU6TGFiZWw0NDY3NTY3MzY=",
            "url": "https://api.github.com/repos/spack/spack/labels/mirrors",
            "name": "mirrors",
            "color": "ade2f2",
            "default": false,
            "description": null
        },
        {
            "id": 620268714,
            "node_id": "MDU6TGFiZWw2MjAyNjg3MTQ=",
            "url": "https://api.github.com/repos/spack/spack/labels/patch",
            "name": "patch",
            "color": "5319e7",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2018-07-13T00:16:25Z",
    "updated_at": "2018-08-16T02:42:14Z",
    "closed_at": "2018-08-16T02:42:14Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/8699",
        "html_url": "https://github.com/spack/spack/pull/8699",
        "diff_url": "https://github.com/spack/spack/pull/8699.diff",
        "patch_url": "https://github.com/spack/spack/pull/8699.patch"
    },
    "body": "Fixes https://github.com/spack/spack/issues/8637\r\n\r\nThis updates `spack mirror create` to include all patches (including patches specified by dependents on children) in the mirror that is created.\r\n\r\nThis also updates the `spack mirror` command to add all packages in the concretized DAG (where originally it only added the package specified by the user). This is required in order to collect patches that are specified by dependents: e.g. if X->Y and X requires a patch on Y called Pxy, then Pxy will only be discovered if you create a mirror with X.\r\n\r\nA more ambitious approach would attempt to consolidate the behavior of `spack fetch` and `spack mirror` (e.g. it may be desirable for `spack fetch` to also download all patches), but this requires more consideration:\r\n\r\n* The current `mirror.create` logic circumvents all caching/mirroring and directly fetches from the default source \r\n* If the fetching phase were updated to include patches, then additional refactoring is required to keep track of patches: patches are not managed like package sources or resources - for example they are not maintained as part of `Package.stage` - they are downloaded and applied at the same time in `Patch.apply`.\r\n\r\nSo I think the current state of the PR is a good compromise.\r\n\r\nTODOs:\r\n\r\n- [ ] Add an option to `spack mirror` to enable mirroring the whole DAG (right now it always downloads the whole DAG)",
    "performed_via_github_app": null
}