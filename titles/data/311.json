{
    "url": "https://api.github.com/repos/spack/spack/issues/311",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/311/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/311/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/311/events",
    "html_url": "https://github.com/spack/spack/issues/311",
    "id": 125453210,
    "node_id": "MDU6SXNzdWUxMjU0NTMyMTA=",
    "number": 311,
    "title": "Spack should be more aggressive about reusing installed software",
    "user": {
        "login": "alfredo-gimenez",
        "id": 3927136,
        "node_id": "MDQ6VXNlcjM5MjcxMzY=",
        "avatar_url": "https://avatars.githubusercontent.com/u/3927136?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alfredo-gimenez",
        "html_url": "https://github.com/alfredo-gimenez",
        "followers_url": "https://api.github.com/users/alfredo-gimenez/followers",
        "following_url": "https://api.github.com/users/alfredo-gimenez/following{/other_user}",
        "gists_url": "https://api.github.com/users/alfredo-gimenez/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alfredo-gimenez/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alfredo-gimenez/subscriptions",
        "organizations_url": "https://api.github.com/users/alfredo-gimenez/orgs",
        "repos_url": "https://api.github.com/users/alfredo-gimenez/repos",
        "events_url": "https://api.github.com/users/alfredo-gimenez/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alfredo-gimenez/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446623646,
            "node_id": "MDU6TGFiZWw0NDY2MjM2NDY=",
            "url": "https://api.github.com/repos/spack/spack/labels/concretization",
            "name": "concretization",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 1651822417,
            "node_id": "MDU6TGFiZWwxNjUxODIyNDE3",
            "url": "https://api.github.com/repos/spack/spack/labels/snl-atdm",
            "name": "snl-atdm",
            "color": "e20ddb",
            "default": false,
            "description": "Issues for SNL ATDM usage of spack"
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 34,
    "created_at": "2016-01-07T18:06:45Z",
    "updated_at": "2020-06-05T06:33:12Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "When I have python@2.7.10 installed:\n\n```\n(cab689):~$ spack find python\n==> 1 installed packages.\n-- chaos_5_x86_64_ib / gcc@4.9.2 --------------------------------\npython@2.7.10\n```\n\nI now try to install py-twisted, explicitly setting the dependency ^python@2.7.10:\n\n```\n(cab689):~$ spack install -v py-twisted^python@2.7.10\n==> Installing py-twisted\n==> Installing python\n==> bzip2 is already installed in /g/g22/gimenez1/src/spack/opt/spack/chaos_5_x86_64_ib/gcc-4.9.2/bzip2-1.0.6-wl4v7wdok42cfndertdgyxys2au2ljpz.\n==> ncurses is already installed in /g/g22/gimenez1/src/spack/opt/spack/chaos_5_x86_64_ib/gcc-4.9.2/ncurses-6.0-2v7r63atwq6aw3p66bc3mkp7hxeoxgqx.\n==> zlib is already installed in /g/g22/gimenez1/src/spack/opt/spack/chaos_5_x86_64_ib/gcc-4.9.2/zlib-1.2.8-mbw4kksfiiloopjcuqbwrktbxe7hq73x.\n==> openssl is already installed in /g/g22/gimenez1/src/spack/opt/spack/chaos_5_x86_64_ib/gcc-4.9.2/openssl-1.0.2e-qs3iwf2rhwlck3qsyrlea7i7zbxluntg.\n==> sqlite is already installed in /g/g22/gimenez1/src/spack/opt/spack/chaos_5_x86_64_ib/gcc-4.9.2/sqlite-3.8.5-2fhvbyidf72xkkazmqnng4ofp2z2hgxk.\n==> readline is already installed in /g/g22/gimenez1/src/spack/opt/spack/chaos_5_x86_64_ib/gcc-4.9.2/readline-6.3-zclrirpahthnvxm2kj2qbz3rup6agcg5.\n==> Already downloaded /g/g22/gimenez1/src/spack/var/spack/stage/python-2.7.10-4azwfxr6b6fddsanso7fgk5xivgdnffs/Python-2.7.10.tar.xz.\n\n```\n\nAs you can see, spack tries to reinstall python 2.7.10. \n\nI went ahead with the installation to see the dependency graph of the new python, here it is:\n\n```\n(cab689):~$ spack find -d python\n==> 2 installed packages.\n-- chaos_5_x86_64_ib / gcc@4.9.2 --------------------------------\n    python@2.7.10\n        ^bzip2@1.0.6\n        ^ncurses@6.0\n        ^openssl@1.0.2e\n            ^zlib@1.2.8\n        ^readline@6.3\n            ^ncurses@6.0\n        ^sqlite@3.8.5\n    python@2.7.10\n        ^bzip2@1.0.6\n        ^ncurses@6.0\n        ^openssl@1.0.2e\n            ^zlib@1.2.8\n        ^readline@6.3\n            ^ncurses@6.0\n        ^sqlite@3.8.5\n        ^zlib@1.2.8\n```\n\nThe newly installed python has ^zlib, everything else is the same. py-twisted does not, however, depend on python^zlib, so not sure why spack is making this new dependency requirement. To verify that py-twisted is using the new python^zlib:\n\n```\n(cab689):~$ spack find -d py-twisted\n==> 1 installed packages.\n-- chaos_5_x86_64_ib / gcc@4.9.2 --------------------------------\n    py-twisted@15.4.0\n        ^py-setuptools@18.1\n            ^python@2.7.10\n                ^bzip2@1.0.6\n                ^ncurses@6.0\n                ^openssl@1.0.2e\n                    ^zlib@1.2.8\n                ^readline@6.3\n                    ^ncurses@6.0\n                ^sqlite@3.8.5\n                ^zlib@1.2.8\n        ^python@2.7.10\n            ^bzip2@1.0.6\n            ^ncurses@6.0\n            ^openssl@1.0.2e\n                ^zlib@1.2.8\n            ^readline@6.3\n                ^ncurses@6.0\n            ^sqlite@3.8.5\n            ^zlib@1.2.8\n```\n\nTL;DR py-twisted should use the existing python, but it creates a new python^zlib for no apparent reason.\n",
    "performed_via_github_app": null
}