{
    "url": "https://api.github.com/repos/spack/spack/issues/7237",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/7237/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/7237/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/7237/events",
    "html_url": "https://github.com/spack/spack/issues/7237",
    "id": 297026150,
    "node_id": "MDU6SXNzdWUyOTcwMjYxNTA=",
    "number": 7237,
    "title": "Mark a package as non-relocatable",
    "user": {
        "login": "alalazo",
        "id": 4199709,
        "node_id": "MDQ6VXNlcjQxOTk3MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alalazo",
        "html_url": "https://github.com/alalazo",
        "followers_url": "https://api.github.com/users/alalazo/followers",
        "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
        "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
        "organizations_url": "https://api.github.com/users/alalazo/orgs",
        "repos_url": "https://api.github.com/users/alalazo/repos",
        "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alalazo/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 880675484,
            "node_id": "MDU6TGFiZWw4ODA2NzU0ODQ=",
            "url": "https://api.github.com/repos/spack/spack/labels/binary-packages",
            "name": "binary-packages",
            "color": "fc5fb3",
            "default": false,
            "description": ""
        },
        {
            "id": 759411369,
            "node_id": "MDU6TGFiZWw3NTk0MTEzNjk=",
            "url": "https://api.github.com/repos/spack/spack/labels/buildcache",
            "name": "buildcache",
            "color": "bf354c",
            "default": false,
            "description": null
        },
        {
            "id": 446634397,
            "node_id": "MDU6TGFiZWw0NDY2MzQzOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/discussion",
            "name": "discussion",
            "color": "a87f5a",
            "default": false,
            "description": null
        },
        {
            "id": 73908756,
            "node_id": "MDU6TGFiZWw3MzkwODc1Ng==",
            "url": "https://api.github.com/repos/spack/spack/labels/feature",
            "name": "feature",
            "color": "84b6eb",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "alalazo",
        "id": 4199709,
        "node_id": "MDQ6VXNlcjQxOTk3MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alalazo",
        "html_url": "https://github.com/alalazo",
        "followers_url": "https://api.github.com/users/alalazo/followers",
        "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
        "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
        "organizations_url": "https://api.github.com/users/alalazo/orgs",
        "repos_url": "https://api.github.com/users/alalazo/repos",
        "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alalazo/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "alalazo",
            "id": 4199709,
            "node_id": "MDQ6VXNlcjQxOTk3MDk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/alalazo",
            "html_url": "https://github.com/alalazo",
            "followers_url": "https://api.github.com/users/alalazo/followers",
            "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
            "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
            "organizations_url": "https://api.github.com/users/alalazo/orgs",
            "repos_url": "https://api.github.com/users/alalazo/repos",
            "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
            "received_events_url": "https://api.github.com/users/alalazo/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 26,
    "created_at": "2018-02-14T09:28:11Z",
    "updated_at": "2020-11-20T08:21:51Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "This is a feature request to add the possibility to mark packages as non-relocatable.\r\n\r\nWe have since a while the possibility to build binary caches of packages that have been installed. This enhances a lot the user the experience, as the installation time may be dramatically reduced for specs whose binary artifacts are available.\r\n\r\nHowever not all the packages may be relocated. The simplest example that comes to my mind is packages that have absolute paths hardcoded somewhere (maybe in a `config.h` file that gets generated at configure or build time). \r\n\r\nWhat I propose here is to be able to mark packages as non-relocatable:\r\n```python\r\nclass EnvironmentModules(Package):\r\n    relocatable = False\r\n    ...\r\n```\r\nand that should have the effect of skipping this node when creating the binary cache of the DAG (thus enforcing a source build).\r\n\r\n\r\n### Expected Result\r\n\r\nThe binary cache of a dependency DAG containing nodes that are not relocatable should enforce building those nodes from sources.\r\n\r\n### Actual Result\r\n\r\nSometimes we put in cache packages that are not relocatable, and that may cause failures at run-time:\r\n```console\r\n$ spack install --use-cache environment-modules\r\n...\r\n==> Installing environment-modules\r\n==> Searching for binary cache of environment-modules\r\n==> Installing environment-modules from binary cache\r\n==> Fetching http://0.0.0.0:32679/build_cache/linux-ubuntu14.04-x86_64/gcc-4.8/environment-modules-3.2.10/linux-ubuntu14.04-x86_64-gcc-4.8-environment-modules-3.2.10-bwjr7qmyssvp2bjk2jnqw75c2qqedrde.spack\r\n######################################################################## 100,0%\r\ngpg: Signature made ven 09 feb 2018 22:03:38 CET using RSA key ID A1A440B6\r\ngpg: Good signature from \"Massimiliano Culpo (GPG created for Spack) <massimiliano.culpo@gmail.com>\"\r\n==> Relocating package from\r\n  /home/spack/opt/spack to /home/mculpo/PycharmProjects/spack/opt/spack.\r\n==> Successfully installed environment-modules from binary cache\r\n[+] /home/mculpo/PycharmProjects/spack/opt/spack/linux-ubuntu14.04-x86_64/gcc-4.8/environment-modules-3.2.10-bwjr7qmyssvp2bjk2jnqw75c2qqedrde\r\n\r\n$ . share/spack/setup-env.sh\r\n$ module av\r\ninit.c(556):ERROR:161: Cannot initialize TCL\r\n```\r\n\r\n@gartung @tgamblin ",
    "performed_via_github_app": null
}