{
    "url": "https://api.github.com/repos/spack/spack/issues/17794",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/17794/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/17794/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/17794/events",
    "html_url": "https://github.com/spack/spack/issues/17794",
    "id": 669075894,
    "node_id": "MDU6SXNzdWU2NjkwNzU4OTQ=",
    "number": 17794,
    "title": "libxc: Conflicting optimization options break build with Intel 19.1.x",
    "user": {
        "login": "RemiLacroix-IDRIS",
        "id": 11938940,
        "node_id": "MDQ6VXNlcjExOTM4OTQw",
        "avatar_url": "https://avatars.githubusercontent.com/u/11938940?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/RemiLacroix-IDRIS",
        "html_url": "https://github.com/RemiLacroix-IDRIS",
        "followers_url": "https://api.github.com/users/RemiLacroix-IDRIS/followers",
        "following_url": "https://api.github.com/users/RemiLacroix-IDRIS/following{/other_user}",
        "gists_url": "https://api.github.com/users/RemiLacroix-IDRIS/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/RemiLacroix-IDRIS/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/RemiLacroix-IDRIS/subscriptions",
        "organizations_url": "https://api.github.com/users/RemiLacroix-IDRIS/orgs",
        "repos_url": "https://api.github.com/users/RemiLacroix-IDRIS/repos",
        "events_url": "https://api.github.com/users/RemiLacroix-IDRIS/events{/privacy}",
        "received_events_url": "https://api.github.com/users/RemiLacroix-IDRIS/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2020-07-30T18:43:47Z",
    "updated_at": "2020-10-26T15:32:18Z",
    "closed_at": "2020-10-26T15:32:18Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "The libxc package configures some optimization options for the build through setting `CFLAGS` and `FCFLAGS`:\r\nhttps://github.com/spack/spack/blob/ab7b07553beecd54475e90127e2e02ba269ec99e/var/spack/repos/builtin/packages/libxc/package.py#L55-L78\r\n\r\nThis predates the whole architecture detection added in v0.13.0 but now it can somehow conflict.\r\n\r\nIn our case, Spack detects that we have `skylake_avx512` so it injects `-march` and `-mtune` accordingly which \"conflicts\" with `-xSSE4.2 -axAVX,CORE-AVX2`.\r\n\r\nSupposedly the compilers are supposed to handle this but currently it breaks with Intel 19.1.X, or at least for libxc it causes an internal compiler error at link time. Of course I will make sure to report this to Intel because it is a compiler bug.\r\n\r\nHowever I am wondering if the \"libxc\" specific optimizations still make sense now that Spack tries to optimize the builds in general.\r\n\r\nDepending on your opinion, I could provide a PR which:\r\n1. adds a `conflicts` with Intel 19.1.x\r\n2. disable the \"libxc\" optimizations for Intel 19.1.x to workaround the issue\r\n3. remove the \"libxc\" optimizations.",
    "performed_via_github_app": null
}