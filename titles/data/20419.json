{
    "url": "https://api.github.com/repos/spack/spack/issues/20419",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/20419/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/20419/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/20419/events",
    "html_url": "https://github.com/spack/spack/pull/20419",
    "id": 768398152,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NTQwODQ5MjIz",
    "number": 20419,
    "title": "Make package files stand alone for type checking",
    "user": {
        "login": "trws",
        "id": 660149,
        "node_id": "MDQ6VXNlcjY2MDE0OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/660149?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/trws",
        "html_url": "https://github.com/trws",
        "followers_url": "https://api.github.com/users/trws/followers",
        "following_url": "https://api.github.com/users/trws/following{/other_user}",
        "gists_url": "https://api.github.com/users/trws/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/trws/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/trws/subscriptions",
        "organizations_url": "https://api.github.com/users/trws/orgs",
        "repos_url": "https://api.github.com/users/trws/repos",
        "events_url": "https://api.github.com/users/trws/events{/privacy}",
        "received_events_url": "https://api.github.com/users/trws/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 2583834777,
            "node_id": "MDU6TGFiZWwyNTgzODM0Nzc3",
            "url": "https://api.github.com/repos/spack/spack/labels/mypy",
            "name": "mypy",
            "color": "98c635",
            "default": false,
            "description": ""
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 21,
    "created_at": "2020-12-16T02:46:50Z",
    "updated_at": "2020-12-29T23:46:26Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/20419",
        "html_url": "https://github.com/spack/spack/pull/20419",
        "diff_url": "https://github.com/spack/spack/pull/20419.diff",
        "patch_url": "https://github.com/spack/spack/pull/20419.patch"
    },
    "body": "After some chats with @tgamblin, here's a first cut at getting all the package files to type check.  There's more work to do for the dynamically poked names like `make` and `spack_cxx`, but switching the name, adding a star import to every package file, and removing the vestigial `from spack import *`.  The rope script I put together for this also ran optimize imports, so the imports are sorted and split into groups by whether they're builtin or from the project.\r\n\r\nAfter this change, we go from tens of thousands of pyright errors on the package repository to this:\r\n\r\n```\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/3proxy/package.py\r\n  27:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  30:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/abduco/package.py\r\n  24:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/abi-compliance-checker/package.py\r\n  25:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/abi-dumper/package.py\r\n  29:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/abinit/package.py\r\n  182:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  183:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/ace/package.py\r\n  33:9 - error: \"env\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/acpica-tools/package.py\r\n  22:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/activeharmony/package.py\r\n  28:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  32:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/adios/package.py\r\n  152:13 - error: \"env\" is not defined (reportUndefinedVariable)\r\n  153:13 - error: \"env\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/admixtools/package.py\r\n  43:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/alglib/package.py\r\n.  ges/apcomp/package.py\r\n  95:24 - error: \"env\" is not defined (reportUndefinedVariable)\r\n  60:35 - error: \"std_cmake_args\" is not defined (reportUndefinedVariable)\r\n  62:28 - error: \"std_cmake_args\" is not defined (reportUndefinedVariable)\r\n  67:13 - error: \"cmake\" is not defined (reportUndefinedVariable)\r\n  69:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  71:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  84:22 - error: \"env\" is not defined (reportUndefinedVariable)\r\n  85:24 - error: \"env\" is not defined (reportUndefinedVariable)\r\n  94:26 - error: \"env\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/ape/package.py\r\n  44:9 - error: \"configure\" is not defined (reportUndefinedVariable)\r\n  45:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  46:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/apr-util/package.py\r\n  99:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/aragorn/package.py\r\n  22:25 - error: \"spack_cc\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/argon2/package.py\r\n  23:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/argp-standalone/package.py\r\n  26:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  27:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/arpack-ng/package.py\r\n  99:24 - error: \"std_cmake_args\" is not defined (reportUndefinedVariable)\r\n  127:9 - error: \"cmake\" is not defined (reportUndefinedVariable)\r\n  128:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  130:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  131:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  155:9 - error: \"configure\" is not defined (reportUndefinedVariable)\r\n  156:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  158:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  159:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/ascent/package.py\r\n  171:36 - error: \"site_packages_dir\" is not defined (reportUndefinedVariable)\r\n  181:35 - error: \"std_cmake_args\" is not defined (reportUndefinedVariable)\r\n  183:28 - error: \"std_cmake_args\" is not defined (reportUndefinedVariable)\r\n  188:13 - error: \"cmake\" is not defined (reportUndefinedVariable)\r\n  190:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  194:17 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  196:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  222:13 - error: \"cmake\" is not defined (reportUndefinedVariable)\r\n  223:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  236:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/astra/package.py\r\n  56:9 - error: \"mkdir\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/astyle/package.py\r\n  35:47 - error: \"spack_cxx\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/athena/package.py\r\n  160:27 - error: \"spack_cc\" is not defined (reportUndefinedVariable)\r\n  161:28 - error: \"spack_cc\" is not defined (reportUndefinedVariable)\r\n  268:9 - error: \"mkdir\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/atk/package.py\r\n  55:13 - error: \"meson\" is not defined (reportUndefinedVariable)\r\n  55:26 - error: \"std_meson_args\" is not defined (reportUndefinedVariable)\r\n  56:13 - error: \"ninja\" is not defined (reportUndefinedVariable)\r\n  57:13 - error: \"ninja\" is not defined (reportUndefinedVariable)\r\n  61:9 - error: \"configure\" is not defined (reportUndefinedVariable)\r\n  62:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  64:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  65:9 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  67:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n/Users/scogland1/Workspace/Projects/spack/spack/var/spack/repos/builtin/packages/atlas/package.py\r\n  99:25 - error: \"spack_cc\" is not defined (reportUndefinedVariable)\r\n  100:25 - error: \"spack_f77\" is not defined (reportUndefinedVariable)\r\n  106:47 - error: \"spack_cc\" is not defined (reportUndefinedVariable)\r\n  116:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  117:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  118:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  119:13 - error: \"make\" is not defined (reportUndefinedVariable)\r\n  122:21 - error: \"make\" is not defined (reportUndefinedVariable)\r\n```\r\n\r\n",
    "performed_via_github_app": null
}