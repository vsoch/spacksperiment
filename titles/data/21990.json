{
    "url": "https://api.github.com/repos/spack/spack/issues/21990",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/21990/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/21990/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/21990/events",
    "html_url": "https://github.com/spack/spack/issues/21990",
    "id": 817522584,
    "node_id": "MDU6SXNzdWU4MTc1MjI1ODQ=",
    "number": 21990,
    "title": "Installation issue: butteryflypack",
    "user": {
        "login": "scottwittenburg",
        "id": 6527504,
        "node_id": "MDQ6VXNlcjY1Mjc1MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6527504?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scottwittenburg",
        "html_url": "https://github.com/scottwittenburg",
        "followers_url": "https://api.github.com/users/scottwittenburg/followers",
        "following_url": "https://api.github.com/users/scottwittenburg/following{/other_user}",
        "gists_url": "https://api.github.com/users/scottwittenburg/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scottwittenburg/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scottwittenburg/subscriptions",
        "organizations_url": "https://api.github.com/users/scottwittenburg/orgs",
        "repos_url": "https://api.github.com/users/scottwittenburg/repos",
        "events_url": "https://api.github.com/users/scottwittenburg/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scottwittenburg/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-02-26T17:09:57Z",
    "updated_at": "2021-02-26T17:10:48Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "Recently the `butteryflypack` package started failing to build on Ubuntu 18.04 in gitlab pipelines with the following error (excerpted, full build output attached):\r\n\r\n```\r\n==> [2021-02-26-16:35:28.125452] butterflypack: Executing phase: 'build'\r\n==> [2021-02-26-16:36:17.711779] Error: ProcessError: Command exited with status 2:\r\n    'make' '-j16'\r\n\r\n17 errors found in build log:\r\n     290    cd /tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-build-2iy2h2r/EXAMPLE && /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/cmake-3.18.4-wcfgpcfntkkujhxx35old34cr6in7lkw/bi\r\n            n/cmake -E cmake_link_script CMakeFiles/ctest.dir/link.txt --verbose=1\r\n     291    /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/mpich-3.4.1-5o26vgiex4kmxv4pmfjo5rlkn4ptkqd4/bin/mpic++ -fopenmp -std=c++11  -O2 -g -DNDEBUG -rdynamic CMakeFiles/ctest.dir/InterfaceTest.cpp.o -o ctest  -Wl,-rpath,/tmp\r\n            /root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-build-2iy2h2r/SRC_DOUBLE:/work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/openblas-0.3.6-qzjcdsc3mklvgshneqnbf6mlknoo56z3/lib:/wo\r\n            rk/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/netlib-scalapack-2.1.0-p4tbxthbtpjflb47md3baz6ecd32e533/lib:/work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/arpack-ng-3.8.0-7pknykojdju5nyp3ytrfxroroxtxqtio/lib ..\r\n            /SRC_DOUBLE/libdbutterflypack.so.1.2.0 /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/openblas-0.3.6-qzjcdsc3mklvgshneqnbf6mlknoo56z3/lib/libopenblas.so /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/openbl\r\n            as-0.3.6-qzjcdsc3mklvgshneqnbf6mlknoo56z3/lib/libopenblas.so /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/netlib-scalapack-2.1.0-p4tbxthbtpjflb47md3baz6ecd32e533/lib/libscalapack.so /work/spack/opt/spack/linux-ubun\r\n            tu18.04-x86_64/gcc-7.5.0/arpack-ng-3.8.0-7pknykojdju5nyp3ytrfxroroxtxqtio/lib/libparpack.so /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/arpack-ng-3.8.0-7pknykojdju5nyp3ytrfxroroxtxqtio/lib/libarpack.so -lm\r\n     292    /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/cmake-3.18.4-wcfgpcfntkkujhxx35old34cr6in7lkw/bin/cmake -E cmake_copy_f90_mod EXAMPLE/emcurv_module.mod EXAMPLE/CMakeFiles/ie2d.dir/emcurv_module.mod.stamp GNU\r\n     293    /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/cmake-3.18.4-wcfgpcfntkkujhxx35old34cr6in7lkw/bin/cmake -E touch EXAMPLE/CMakeFiles/ie2d.dir/EMCURV_Module.f90.o.provides.build\r\n     294    [ 57%] Building Fortran object EXAMPLE/CMakeFiles/ie2d.dir/EMCURV_Driver.f90.o\r\n     295    cd /tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-build-2iy2h2r/EXAMPLE && /work/spack/opt/spack/linux-ubuntu18.04-x86_64/gcc-7.5.0/mpich-3.4.1-5o26vgiex4kmxv4pmfjo5rlkn4ptkqd4/bin\r\n            /mpif90  -I/tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-src/SRC_DOUBLE -I/tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-src/SRC_DOUB\r\n            LECOMPLEX -I/tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-src/EXAMPLE -I/tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-build-2iy2h2r/\r\n            SRC_DOUBLE -I/tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-build-2iy2h2r/SRC_DOUBLECOMPLEX -DHAVE_FINAL -DHAVE_MPI3  -DHAVE_ARPACK -DHAVE_MKL -fopenmp -DHAVE_TASKLOOP -fno-range-c\r\n            heck -ffree-line-length-none -ffixed-line-length-none -fimplicit-none -lpthread -cpp  -O2 -g -DNDEBUG -c /tmp/root/spack-stage/spack-stage-butterflypack-1.2.1-2iy2h2rqthtb4rfbt7xpomch7ulqg27p/spack-src/EXAMPLE/EMCURV_Driver.f9\r\n            0 -o CMakeFiles/ie2d.dir/EMCURV_Driver.f90.o\r\n  >> 296    ../SRC_DOUBLE/libdbutterflypack.so.1.2.0: undefined reference to `dgemm_batch_'\r\n  >> 297    collect2: error: ld returned 1 exit status\r\n     298    EXAMPLE/CMakeFiles/ctest.dir/build.make:111: recipe for target 'EXAMPLE/ctest' failed\r\n  >> 299    make[2]: *** [EXAMPLE/ctest] Error 1\r\n```\r\n\r\n### Steps to reproduce the issue\r\n\r\nThis can possibly be reproduced on any Ubuntu 18.04, but I ran into the problem in this docker container: `ecpe4s/ubuntu18.04-runner-x86_64:2020-09-01`.  Also, enable the following binary mirror to install binary dependencies: `s3://spack-binaries-develop/e4s-new-cluster`.  To reproduce, download the attached concrete spec yaml for `butterflypack` into, e.g., `/work/butterflypack.yaml`, then:\r\n\r\n```\r\nspack mirror add develop-binaries s3://spack-binaries-develop/e4s-new-cluster\r\nspack -d install --no-check-signature -f /work/butterflypack.yaml\r\n```\r\n\r\n[butterflypack.yaml.txt](https://github.com/spack/spack/files/6051150/butterflypack.yaml.txt)\r\n\r\n### Information on your system\r\n\r\n```\r\nroot@3a665d59470e:/work# spack debug report\r\n* **Spack:** 0.16.1-1514-5578c07b51\r\n* **Python:** 3.6.9\r\n* **Platform:** linux-ubuntu18.04-haswell\r\n* **Concretizer:** original\r\n```\r\n\r\n### Additional information\r\n\r\nLog files from the failed build (`repro.out.txt` is just the redirected stdout/stderr from the `spack -d install ...` command):\r\n\r\n[CMakeCache.txt](https://github.com/spack/spack/files/6051239/CMakeCache.txt)\r\n[repro.out.txt](https://github.com/spack/spack/files/6051241/repro.out.txt)\r\n[spack-build-env.txt](https://github.com/spack/spack/files/6051242/spack-build-env.txt)\r\n[spack-build-out.txt](https://github.com/spack/spack/files/6051243/spack-build-out.txt)\r\n[spack-configure-args.txt](https://github.com/spack/spack/files/6051244/spack-configure-args.txt)\r\n\r\nMaintainers:\r\n\r\n```\r\nroot@3a665d59470e:/work# spack maintainers butterflypack\r\nliuyangzhuan\r\n```\r\n\r\n@liuyangzhuan \r\n\r\nAlso @eugeneswalker \r\n\r\nI'm not sure, but my suspicion is that this error was introduced by #21908, because that PR was the first to show the failure in gitlab pipelines.\r\n\r\n### General information\r\n\r\n<!-- These boxes can be checked by replacing [ ] with [x] or by clicking them after submitting the issue. -->\r\n- [x] I have run `spack debug report` and reported the version of Spack/Python/Platform\r\n- [x] have run `spack maintainers <name-of-the-package>` and @mentioned any maintainers\r\n- [x] I have uploaded the build log and environment files\r\n- [x] I have searched the issues of this repo and believe this is not a duplicate\r\n",
    "performed_via_github_app": null
}