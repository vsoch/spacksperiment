{
    "url": "https://api.github.com/repos/spack/spack/issues/8303",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/8303/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/8303/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/8303/events",
    "html_url": "https://github.com/spack/spack/issues/8303",
    "id": 327156919,
    "node_id": "MDU6SXNzdWUzMjcxNTY5MTk=",
    "number": 8303,
    "title": "py-matplotlib fails with intel compiler ",
    "user": {
        "login": "s-sajid-ali",
        "id": 30510036,
        "node_id": "MDQ6VXNlcjMwNTEwMDM2",
        "avatar_url": "https://avatars.githubusercontent.com/u/30510036?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/s-sajid-ali",
        "html_url": "https://github.com/s-sajid-ali",
        "followers_url": "https://api.github.com/users/s-sajid-ali/followers",
        "following_url": "https://api.github.com/users/s-sajid-ali/following{/other_user}",
        "gists_url": "https://api.github.com/users/s-sajid-ali/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/s-sajid-ali/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/s-sajid-ali/subscriptions",
        "organizations_url": "https://api.github.com/users/s-sajid-ali/orgs",
        "repos_url": "https://api.github.com/users/s-sajid-ali/repos",
        "events_url": "https://api.github.com/users/s-sajid-ali/events{/privacy}",
        "received_events_url": "https://api.github.com/users/s-sajid-ali/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        },
        {
            "id": 477156668,
            "node_id": "MDU6TGFiZWw0NzcxNTY2Njg=",
            "url": "https://api.github.com/repos/spack/spack/labels/intel",
            "name": "intel",
            "color": "127cc1",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2018-05-29T03:12:33Z",
    "updated_at": "2018-06-22T16:16:19Z",
    "closed_at": "2018-06-22T16:16:19Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "### Expected Result\r\n\r\nsuccessful install of py-matplotlib\r\n\r\n### Actual Result\r\n\r\n```\r\n[sajid@apsxrmd-0001 py-matplotlib]$ spack install py-matplotlib@2.2.2+image ^py-numpy@1.14.3 ^/s6v ^python@3.6.5\r\n==> bzip2 is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/bzip2-1.0.6-elwi6mipwwydc72dpxk2tyu277cizzgd\r\n==> zlib is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/zlib-1.2.11-rxnhb4ttcijbf62keegdygnx6noh5cxw\r\n==> libpng is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libpng-1.6.34-gy6gvg4x4yifhx3ig4vgrpatcdlkyn47\r\n==> pkgconf is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/pkgconf-1.4.0-vhhwcl5paccot66ethg7tgfo2g5xgdyg\r\n==> freetype is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/freetype-2.7.1-4vdnp2d6cahfcl6saxpvfvfdz6xucqvk\r\n==> ncurses is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/ncurses-6.1-rpa47v3lwu5vo44yrneqmjk4qc2xsky7\r\n==> readline is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/readline-7.0-2753dh2vx3rmzyqyqvlkyyp4imu66klm\r\n==> gdbm is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/gdbm-1.14.1-tfb7qsoosdfw64cw5ls5nkyfqsqr3nfa\r\n==> openssl@1.0.1e : externally installed in /usr\r\n==> openssl@1.0.1e : already registered in DB\r\n==> sqlite is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/sqlite-3.23.1-weaj3n24nozti46hbk2ij3kkfej4p5av\r\n==> python is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n\r\n==> py-setuptools is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-setuptools-39.0.1-bjdhpcozafhiy2nofvtiy3wg6tyrv3zm\r\n==> py-six is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-six-1.11.0-hzbiswrwls6hkghlynrmvzubye2oc6xp\r\n==> py-cycler is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-cycler-0.10.0-6na5r7xwt2h4bl6ii4k62yuysat3ip3z\r\n==> py-dateutil is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-dateutil-2.5.2-22krkoswxvvsgikyi6kszmapkwqzu72s\r\n==> py-kiwisolver is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-kiwisolver-1.0.1-bqx54bfklwwaemlynz7urknwoq53l4ym\r\n==> intel-mkl is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/intel-mkl-2018.2.199-ifx66vpktj3ojzd6avjtnlzp2ybj3n3r\r\n==> py-numpy is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-numpy-1.14.3-4qfyeaageyyr3bbmeuhfvyvupd3mstns\r\n==> libjpeg-turbo is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libjpeg-turbo-1.5.90-rfrpz7g33kgrzwpu52yobb7fvdy7mhvb\r\n==> xz is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/xz-5.2.4-vd7dt2scvbaxjlk7iz5xdmtcuhvj4i5p\r\n==> libtiff is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libtiff-4.0.9-tpeqxbc6ijle7brt6wgvkljaw4zoim5w\r\n==> lcms is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/lcms-2.9-54avoopvpfhrpmlyqrxwufn33thp7ai3\r\n==> py-pillow is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-pillow-5.1.0-s6vnuajpcydiumbotojxad4zu74otpyc\r\n==> py-pyparsing is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-pyparsing-2.2.0-djdisjjtqynrwdl747f4cvxk7isp4rtw\r\n==> py-pytz is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/py-pytz-2017.2-z353c3gn722k6fwdntchljnfxbm2uqbc\r\n==> cmake is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/cmake-3.10.2-3xxofe2j2z5gfel3wvrpozuwco7srsew\r\n==> qhull is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/qhull-2015.2-wwdfen3muqvslniruwq2imzj2aivibqg\r\n==> util-macros is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/util-macros-1.19.1-3vfwyudzo77g6xv6wnixf6jt5bsemq6e\r\n==> inputproto is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/inputproto-2.3.2-zxcb4og7y4f6rmexnw2qtnzc5timr2vo\r\n==> kbproto is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/kbproto-1.0.7-jfx3docapyiyag3jmpaydb6u4ojm24xp\r\n==> libpthread-stubs is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libpthread-stubs-0.4-dabyqoocabpzqrzcwllzok6zz7dbwxjm\r\n==> xproto is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/xproto-7.0.31-qrlzjumkhlnet7exenu2rdbnria5casp\r\n==> libxau is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libxau-1.0.8-miwfkolf647awha2dvb6rljxig725d2y\r\n==> libxdmcp is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libxdmcp-1.1.2-v7pyjlzjlr5mphaajkuerh4lsancyy5h\r\n==> xcb-proto is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/xcb-proto-1.13-lryq44r4lyhjnrc4zvkis6xas34kwwab\r\n==> libxcb is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libxcb-1.13-6ys2avfqm3tewxwtdev6qnqhc5eyslra\r\n==> perl is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/perl-5.26.2-zhmbbepnesidk4mpyme4tzfoc4l3rjwx\r\n==> xextproto is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/xextproto-7.3.0-2elmu4wxyem7pq4335fuyylsql6n4k47\r\n==> xtrans is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/xtrans-1.3.5-qslzi4wv3pkhsiovbj444envv4x2yx3p\r\n==> libx11 is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/libx11-1.6.5-nhnuhu64b2zavxh4zumq7fjpwsfmt367\r\n==> tcl is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/tcl-8.6.8-z6xgqcvl5othhph7khz5os26tov6iewx\r\n==> tk is already installed in /blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/tk-8.6.8-n3bsexai5msth6siadkx7pll2nqzttkj\r\n==> Installing py-matplotlib\r\n==> Using cached archive: /blues/gpfs/home/sajid/packages/spack/var/spack/cache/py-matplotlib/py-matplotlib-2.2.2.tar.gz\r\n==> Staging archive: /blues/gpfs/home/sajid/packages/spack/var/spack/stage/py-matplotlib-2.2.2-cxqllbit2yxsofg33cgo4epfz6xlgjq7/matplotlib-2.2.2.tar.gz\r\n==> Created stage in /blues/gpfs/home/sajid/packages/spack/var/spack/stage/py-matplotlib-2.2.2-cxqllbit2yxsofg33cgo4epfz6xlgjq7\r\n==> No patches needed for py-matplotlib\r\n==> Building py-matplotlib [PythonPackage]\r\n==> Executing phase: 'build'\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/blues/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n/bin/python3.6' '-s' 'setup.py' '--no-user-cfg' 'build'\r\n\r\n2 errors found in build log:\r\n     585    /blues/gpfs/home/sajid/packages/spack/lib/spack/env/intel/icpc -fno-strict-aliasing -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -DMPL_DEVNULL=/dev/null -DP\r\n            Y_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__qhull_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/blues/gpfs/home/sajid/packages/spack/opt/spack/linux-\r\n            centos7-x86_64/intel-18.0.1/py-numpy-1.14.3-4qfyeaageyyr3bbmeuhfvyvupd3mstns/lib/python3.6/site-packages/numpy/core/include -Iextern -I/usr/local/include -I/usr/include -I. -I/blu\r\n            es/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n/include/python3.6m -c extern/libqhull/io.c -o build/tem\r\n            p.linux-x86_64-3.6/extern/libqhull/io.o\r\n     586    /blues/gpfs/home/sajid/packages/spack/lib/spack/env/intel/icpc -fno-strict-aliasing -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -DMPL_DEVNULL=/dev/null -DP\r\n            Y_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__qhull_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/blues/gpfs/home/sajid/packages/spack/opt/spack/linux-\r\n            centos7-x86_64/intel-18.0.1/py-numpy-1.14.3-4qfyeaageyyr3bbmeuhfvyvupd3mstns/lib/python3.6/site-packages/numpy/core/include -Iextern -I/usr/local/include -I/usr/include -I. -I/blu\r\n            es/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n/include/python3.6m -c extern/libqhull/libqhull.c -o bui\r\n            ld/temp.linux-x86_64-3.6/extern/libqhull/libqhull.o\r\n     587    /blues/gpfs/home/sajid/packages/spack/lib/spack/env/intel/icpc -fno-strict-aliasing -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -DMPL_DEVNULL=/dev/null -DP\r\n            Y_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__qhull_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/blues/gpfs/home/sajid/packages/spack/opt/spack/linux-\r\n            centos7-x86_64/intel-18.0.1/py-numpy-1.14.3-4qfyeaageyyr3bbmeuhfvyvupd3mstns/lib/python3.6/site-packages/numpy/core/include -Iextern -I/usr/local/include -I/usr/include -I. -I/blu\r\n            es/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n/include/python3.6m -c extern/libqhull/mem.c -o build/te\r\n            mp.linux-x86_64-3.6/extern/libqhull/mem.o\r\n     588    /blues/gpfs/home/sajid/packages/spack/lib/spack/env/intel/icpc -fno-strict-aliasing -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -DMPL_DEVNULL=/dev/null -DP\r\n            Y_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__qhull_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/blues/gpfs/home/sajid/packages/spack/opt/spack/linux-\r\n            centos7-x86_64/intel-18.0.1/py-numpy-1.14.3-4qfyeaageyyr3bbmeuhfvyvupd3mstns/lib/python3.6/site-packages/numpy/core/include -Iextern -I/usr/local/include -I/usr/include -I. -I/blu\r\n            es/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n/include/python3.6m -c extern/libqhull/merge.c -o build/\r\n            temp.linux-x86_64-3.6/extern/libqhull/merge.o\r\n     589    /blues/gpfs/home/sajid/packages/spack/lib/spack/env/intel/icpc -fno-strict-aliasing -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -DMPL_DEVNULL=/dev/null -DP\r\n            Y_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__qhull_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/blues/gpfs/home/sajid/packages/spack/opt/spack/linux-\r\n            centos7-x86_64/intel-18.0.1/py-numpy-1.14.3-4qfyeaageyyr3bbmeuhfvyvupd3mstns/lib/python3.6/site-packages/numpy/core/include -Iextern -I/usr/local/include -I/usr/include -I. -I/blu\r\n            es/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n/include/python3.6m -c extern/libqhull/poly.c -o build/t\r\n            emp.linux-x86_64-3.6/extern/libqhull/poly.o\r\n     590    /blues/gpfs/home/sajid/packages/spack/lib/spack/env/intel/icpc -fno-strict-aliasing -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -DMPL_DEVNULL=/dev/null -DP\r\n            Y_ARRAY_UNIQUE_SYMBOL=MPL_matplotlib__qhull_ARRAY_API -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -D__STDC_FORMAT_MACROS=1 -I/blues/gpfs/home/sajid/packages/spack/opt/spack/linux-\r\n            centos7-x86_64/intel-18.0.1/py-numpy-1.14.3-4qfyeaageyyr3bbmeuhfvyvupd3mstns/lib/python3.6/site-packages/numpy/core/include -Iextern -I/usr/local/include -I/usr/include -I. -I/blu\r\n            es/gpfs/home/sajid/packages/spack/opt/spack/linux-centos7-x86_64/intel-18.0.1/python-3.6.5-oz2gaotbbnlmrgb76uq2gt7nx5wnbi2n/include/python3.6m -c extern/libqhull/poly2.c -o build/\r\n            temp.linux-x86_64-3.6/extern/libqhull/poly2.o\r\n  >> 591    extern/libqhull/poly2.c(2987): error: a value of type \"void *\" cannot be assigned to an entity of type \"double *\"\r\n     592              newfacet->normal= qh_memalloc(qh normal_size);\r\n     593                              ^\r\n     594\r\n  >> 595    extern/libqhull/poly2.c(2993): error: a value of type \"void *\" cannot be assigned to an entity of type \"double *\"\r\n     596              newfacet->center= qh_memalloc(qh center_size);\r\n     597                              ^\r\n     598\r\n     599    extern/libqhull/poly2.c(3221): warning #111: statement is unreachable\r\n     600        return False; /* avoid warnings */\r\n     601        ^\r\n\r\nSee build log for details:\r\n  /blues/gpfs/home/sajid/packages/spack/var/spack/stage/py-matplotlib-2.2.2-cxqllbit2yxsofg33cgo4epfz6xlgjq7/matplotlib-2.2.2/spack-build.out\r\n```\r\n\r\n### Build Log :\r\n\r\nBuild log is [here](https://pastebin.com/XTzZgg7x).\r\n\r\n### Additional info : \r\n\r\n 1. linux-centos7-x86_64\r\n 2. intel@18.0.1\r\n 3. including [5321](https://github.com/spack/spack/pull/5321) in the build recipe. icpc is being used but the build still fails.\r\n 4. spack repo is ```scheibelp/bugfix/pkgconfig-cpath``` to fix the freetype header issue as per [8070](https://github.com/spack/spack/pull/8070)\r\n 5. It looks like there was a [similar issue](https://github.com/matplotlib/matplotlib/issues/4518) with qhull and intel compilers which was supposedly fixed yet the above error occurs.",
    "performed_via_github_app": null
}