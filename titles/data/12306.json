{
    "url": "https://api.github.com/repos/spack/spack/issues/12306",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/12306/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/12306/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/12306/events",
    "html_url": "https://github.com/spack/spack/issues/12306",
    "id": 478010903,
    "node_id": "MDU6SXNzdWU0NzgwMTA5MDM=",
    "number": 12306,
    "title": "Error when building automake from spec file",
    "user": {
        "login": "obreitwi",
        "id": 123140,
        "node_id": "MDQ6VXNlcjEyMzE0MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/123140?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/obreitwi",
        "html_url": "https://github.com/obreitwi",
        "followers_url": "https://api.github.com/users/obreitwi/followers",
        "following_url": "https://api.github.com/users/obreitwi/following{/other_user}",
        "gists_url": "https://api.github.com/users/obreitwi/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/obreitwi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/obreitwi/subscriptions",
        "organizations_url": "https://api.github.com/users/obreitwi/orgs",
        "repos_url": "https://api.github.com/users/obreitwi/repos",
        "events_url": "https://api.github.com/users/obreitwi/events{/privacy}",
        "received_events_url": "https://api.github.com/users/obreitwi/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 512483390,
            "node_id": "MDU6TGFiZWw1MTI0ODMzOTA=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-medium",
            "name": "impact-medium",
            "color": "fef2c0",
            "default": false,
            "description": ""
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "scheibelp",
            "id": 1659704,
            "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scheibelp",
            "html_url": "https://github.com/scheibelp",
            "followers_url": "https://api.github.com/users/scheibelp/followers",
            "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
            "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
            "organizations_url": "https://api.github.com/users/scheibelp/orgs",
            "repos_url": "https://api.github.com/users/scheibelp/repos",
            "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scheibelp/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 2,
    "created_at": "2019-08-07T15:53:01Z",
    "updated_at": "2019-08-13T10:19:16Z",
    "closed_at": "2019-08-13T10:19:16Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "body": "While building `automake` the \"regular\" way (i.e., `spack install autoamke`) works, when building from a spec file, `autoconf` is missing.\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack spec -y automake %gcc@8.3.0 > automake.yaml\r\n$ spack --verbose install -f automake.yaml\r\n```\r\n\r\n### Error Message\r\n\r\n```console\r\n==> Installing automake\r\n==> Searching for binary cache of automake\r\n==> Finding buildcaches in /wang/environment/software/jessie/spack/mirror/build_cache\r\n==> Finding buildcaches in /opt/build_cache/build_cache\r\n==> No binary for automake found: installing from source\r\n==> Fetching file:///opt/build_cache/automake/automake-1.16.1.tar.gz\r\ncurl: (37) Couldn't open file /opt/build_cache/automake/automake-1.16.1.tar.gz\r\n==> Fetching from file:///opt/build_cache/automake/automake-1.16.1.tar.gz failed.\r\n==> Fetching file:///wang/environment/software/jessie/spack/mirror/automake/automake-1.16.1.tar.gz\r\n######################################################################## 100.0%\r\n==> Staging archive: /fasthome/obreitwi/sandboxes/2019-08-07_spack_from_file/spack/var/spack/stage/automake-1.16.1-xqnhkwm445wuehl53lbthk2qredk2kfj/automake-1.16.1.tar.gz                                                                                                                                                    \r\n==> Created stage in /fasthome/obreitwi/sandboxes/2019-08-07_spack_from_file/spack/var/spack/stage/automake-1.16.1-xqnhkwm445wuehl53lbthk2qredk2kfj\r\n==> Ran patch() for automake\r\n==> Building automake [AutotoolsPackage]\r\n==> Executing phase: 'autoreconf'\r\n==> Executing phase: 'configure'\r\n==> [2019-08-07-15:42:54.768883] '/fasthome/obreitwi/sandboxes/2019-08-07_spack_from_file/spack/var/spack/stage/automake-1.16.1-xqnhkwm445wuehl53lbthk2qredk2kfj/spack-src/configure' '--prefix=/fasthome/obreitwi/sandboxes/2019-08-07_spack_from_file/spack/opt/spack/linux-debian9-x86_64/gcc-8.3.0/automake-1.16.1-xqnhkwm445wuehl53lbthk2qredk2kfj'\r\nchecking whether make supports nested variables... yes\r\nchecking build system type... x86_64-pc-linux-gnu\r\nchecking host system type... x86_64-pc-linux-gnu\r\nchecking for a BSD-compatible install... /usr/bin/install -c\r\nchecking whether build environment is sane... yes\r\nchecking for a thread-safe mkdir -p... /bin/mkdir -p\r\nchecking for gawk... gawk\r\nchecking whether make sets $(MAKE)... yes\r\nchecking whether ln -s works... yes\r\nchecking for perl... /fasthome/obreitwi/sandboxes/2019-08-07_spack_from_file/spack/opt/spack/linux-debian9-x86_64/gcc-8.3.0/perl-5.26.2-asacrqlh3dd6tgib5eps7xefe3zyj5zg/bin/perl                                                                                                                                             \r\nchecking for tex... tex\r\nchecking for yacc... no\r\nchecking for byacc... no\r\nchecking for bison... no\r\nchecking for lex... no\r\nchecking for flex... no\r\nchecking whether autoconf is installed... no\r\nconfigure: error: Autoconf 2.65 or better is required.\r\n    Please make sure it is installed and in your PATH.\r\n==> Error: ProcessError: Command exited with status 1:\r\n    '/fasthome/obreitwi/sandboxes/2019-08-07_spack_from_file/spack/var/spack/stage/automake-1.16.1-xqnhkwm445wuehl53lbthk2qredk2kfj/spack-src/configure' '--prefix=/fasthome/obreitwi/sandboxes/2019-08-07_spack_from_file/spack/opt/spack/linux-debian9-x86_64/gcc-8.3.0/automake-1.16.1-xqnhkwm445wuehl53lbthk2qredk2kfj'   \r\n\r\n1 error found in build log:\r\n     15    checking for yacc... no\r\n     16    checking for byacc... no\r\n     17    checking for bison... no\r\n     18    checking for lex... no\r\n     19    checking for flex... no\r\n     20    checking whether autoconf is installed... no\r\n  >> 21    configure: error: Autoconf 2.65 or better is required.\r\n     22        Please make sure it is installed and in your PATH.\r\n```\r\n\r\n### Contents of the spec file: `automake.yaml`\r\n```yaml\r\nspec:\r\n- automake:\r\n    version: 1.16.1\r\n    arch:\r\n      platform: linux\r\n      platform_os: debian9\r\n      target: x86_64\r\n    compiler:\r\n      name: gcc\r\n      version: 8.3.0\r\n    namespace: builtin\r\n    parameters:\r\n      cflags: []\r\n      cppflags: []\r\n      cxxflags: []\r\n      fflags: []\r\n      ldflags: []\r\n      ldlibs: []\r\n    dependencies:\r\n      perl:\r\n        hash: asacrqlh3dd6tgib5eps7xefe3zyj5zg\r\n        type:\r\n        - build\r\n        - run\r\n    hash: xqnhkwm445wuehl53lbthk2qredk2kfj\r\n- perl:\r\n    version: 5.26.2\r\n    arch:\r\n      platform: linux\r\n      platform_os: debian9\r\n      target: x86_64\r\n    compiler:\r\n      name: gcc\r\n      version: 8.3.0\r\n    namespace: builtin\r\n    parameters:\r\n      cpanm: true\r\n      patches:\r\n      - 0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac\r\n      shared: true\r\n      threads: true\r\n      cflags: []\r\n      cppflags: []\r\n      cxxflags: []\r\n      fflags: []\r\n      ldflags: []\r\n      ldlibs: []\r\n    patches:\r\n    - 0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac\r\n    dependencies:\r\n      gdbm:\r\n        hash: pdri3m3allxqpiwdikljeazpnuc5sevj\r\n        type:\r\n        - build\r\n        - link\r\n    hash: asacrqlh3dd6tgib5eps7xefe3zyj5zg\r\n- gdbm:\r\n    version: 1.18.1\r\n    arch:\r\n      platform: linux\r\n      platform_os: debian9\r\n      target: x86_64\r\n    compiler:\r\n      name: gcc\r\n      version: 8.3.0\r\n    namespace: builtin\r\n    parameters:\r\n      cflags: []\r\n      cppflags: []\r\n      cxxflags: []\r\n      fflags: []\r\n      ldflags: []\r\n      ldlibs: []\r\n    dependencies:\r\n      readline:\r\n        hash: bvf6tzqqhxktmj6ewh4lhnpqivcvneid\r\n        type:\r\n        - build\r\n        - link\r\n    hash: pdri3m3allxqpiwdikljeazpnuc5sevj\r\n- readline:\r\n    version: '7.0'\r\n    arch:\r\n      platform: linux\r\n      platform_os: debian9\r\n      target: x86_64\r\n    compiler:\r\n      name: gcc\r\n      version: 8.3.0\r\n    namespace: builtin\r\n    parameters:\r\n      cflags: []\r\n      cppflags: []\r\n      cxxflags: []\r\n      fflags: []\r\n      ldflags: []\r\n      ldlibs: []\r\n    dependencies:\r\n      ncurses:\r\n        hash: r6gwysm6ahzhqdnp7gt5ygdge6jjw3yw\r\n        type:\r\n        - build\r\n        - link\r\n    hash: bvf6tzqqhxktmj6ewh4lhnpqivcvneid\r\n- ncurses:\r\n    version: '6.1'\r\n    arch:\r\n      platform: linux\r\n      platform_os: debian9\r\n      target: x86_64\r\n    compiler:\r\n      name: gcc\r\n      version: 8.3.0\r\n    namespace: builtin\r\n    parameters:\r\n      symlinks: false\r\n      termlib: false\r\n      cflags: []\r\n      cppflags: []\r\n      cxxflags: []\r\n      fflags: []\r\n      ldflags: []\r\n      ldlibs: []\r\n    hash: r6gwysm6ahzhqdnp7gt5ygdge6jjw3yw\r\n```\r\n\r\nAfterwards, only the following packages are installed:\r\n```console\r\n$ spack find -dvL\r\n==> 4 installed packages\r\n-- linux-debian9-x86_64 / gcc@8.3.0 -----------------------------\r\npdri3m3allxqpiwdikljeazpnuc5sevj    gdbm@1.18.1\r\nbvf6tzqqhxktmj6ewh4lhnpqivcvneid        ^readline@7.0\r\nr6gwysm6ahzhqdnp7gt5ygdge6jjw3yw            ^ncurses@6.1~symlinks~termlib\r\n\r\nr6gwysm6ahzhqdnp7gt5ygdge6jjw3yw    ncurses@6.1~symlinks~termlib\r\n\r\nasacrqlh3dd6tgib5eps7xefe3zyj5zg    perl@5.26.2+cpanm patches=0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac +shared+threads\r\npdri3m3allxqpiwdikljeazpnuc5sevj        ^gdbm@1.18.1\r\nbvf6tzqqhxktmj6ewh4lhnpqivcvneid            ^readline@7.0\r\nr6gwysm6ahzhqdnp7gt5ygdge6jjw3yw                ^ncurses@6.1~symlinks~termlib\r\n\r\nbvf6tzqqhxktmj6ewh4lhnpqivcvneid    readline@7.0\r\nr6gwysm6ahzhqdnp7gt5ygdge6jjw3yw        ^ncurses@6.1~symlinks~termlib\r\n```\r\n\r\nI have not yet investigated as to why the `autoconf` binaries are not added to the environment in case the user specifies a spec yaml file.",
    "performed_via_github_app": null
}