{
    "url": "https://api.github.com/repos/spack/spack/issues/13797",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/13797/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/13797/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/13797/events",
    "html_url": "https://github.com/spack/spack/pull/13797",
    "id": 525339749,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MzQyOTUxMTE2",
    "number": 13797,
    "title": "Buildcache: Install into non-default directory layouts",
    "user": {
        "login": "gartung",
        "id": 4292184,
        "node_id": "MDQ6VXNlcjQyOTIxODQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4292184?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gartung",
        "html_url": "https://github.com/gartung",
        "followers_url": "https://api.github.com/users/gartung/followers",
        "following_url": "https://api.github.com/users/gartung/following{/other_user}",
        "gists_url": "https://api.github.com/users/gartung/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/gartung/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/gartung/subscriptions",
        "organizations_url": "https://api.github.com/users/gartung/orgs",
        "repos_url": "https://api.github.com/users/gartung/repos",
        "events_url": "https://api.github.com/users/gartung/events{/privacy}",
        "received_events_url": "https://api.github.com/users/gartung/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 880675484,
            "node_id": "MDU6TGFiZWw4ODA2NzU0ODQ=",
            "url": "https://api.github.com/repos/spack/spack/labels/binary-packages",
            "name": "binary-packages",
            "color": "fc5fb3",
            "default": false,
            "description": ""
        },
        {
            "id": 759411369,
            "node_id": "MDU6TGFiZWw3NTk0MTEzNjk=",
            "url": "https://api.github.com/repos/spack/spack/labels/buildcache",
            "name": "buildcache",
            "color": "bf354c",
            "default": false,
            "description": null
        },
        {
            "id": 73908756,
            "node_id": "MDU6TGFiZWw3MzkwODc1Ng==",
            "url": "https://api.github.com/repos/spack/spack/labels/feature",
            "name": "feature",
            "color": "84b6eb",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "scheibelp",
        "id": 1659704,
        "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
        "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/scheibelp",
        "html_url": "https://github.com/scheibelp",
        "followers_url": "https://api.github.com/users/scheibelp/followers",
        "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
        "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
        "organizations_url": "https://api.github.com/users/scheibelp/orgs",
        "repos_url": "https://api.github.com/users/scheibelp/repos",
        "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
        "received_events_url": "https://api.github.com/users/scheibelp/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "scheibelp",
            "id": 1659704,
            "node_id": "MDQ6VXNlcjE2NTk3MDQ=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1659704?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/scheibelp",
            "html_url": "https://github.com/scheibelp",
            "followers_url": "https://api.github.com/users/scheibelp/followers",
            "following_url": "https://api.github.com/users/scheibelp/following{/other_user}",
            "gists_url": "https://api.github.com/users/scheibelp/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/scheibelp/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/scheibelp/subscriptions",
            "organizations_url": "https://api.github.com/users/scheibelp/orgs",
            "repos_url": "https://api.github.com/users/scheibelp/repos",
            "events_url": "https://api.github.com/users/scheibelp/events{/privacy}",
            "received_events_url": "https://api.github.com/users/scheibelp/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 8,
    "created_at": "2019-11-20T00:05:33Z",
    "updated_at": "2020-03-16T13:49:04Z",
    "closed_at": "2020-03-16T13:42:24Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/13797",
        "html_url": "https://github.com/spack/spack/pull/13797",
        "diff_url": "https://github.com/spack/spack/pull/13797.diff",
        "patch_url": "https://github.com/spack/spack/pull/13797.patch"
    },
    "body": "Store a dictionary mapping of original dependency prefixes to dependency hashes. \r\n\r\nNote: old buildcaches will not have the dictionary needed to relocate into a non-default layout.\r\n\r\nUse the loaded spec to grab the new dependency prefixes in the new directory layout.\r\n\r\nMap the original dependency prefixes to the new dependency prefixes using the dependency hashes.\r\n\r\nUse the dependency prefixes map to replace original rpaths with new rpaths preserving the order. \r\nFor mach-o binaries, use the dependency prefixes map to replace the dependency library entires for libraries and executables and the replace the library id for libraries. \r\n\r\nOn Linux, patchelf is used to replace the rpaths of elf binaries.\r\nOn macOS, install_name_tool is used to replace the rpaths and  dependency libraries  of mach-o binaries and the id of mach-o libraries.\r\nOn Linux, macholib is used to replace the dependency libraries of mach-o binaries and the id of mach-o libraries.\r\n\r\nBinary text with padding replacement is attempted for all binaries for the following paths:\r\nspack layout root\r\nspack prefix\r\nsbang script location\r\ndependency prefixes\r\npackage prefix\r\n\r\nText replacement is attempted for all text files using the paths above.\r\n\r\nRelatived rpaths are generated for the new directory layout as follows. The old rpaths are recreated by getting the nromalized path of the directory name of the original file path name added combined with the relative rpath. The old rpaths are then replace with new rpaths using the prefix to prefix dictionary. Then the relativized rpath is then calculated with respect to the new directory layout. The same thing is done with relativized symbolic links.\r\n\r\nSymbolic links to the absolute path of the package install prefix are replaced, all others produce warnings.",
    "performed_via_github_app": null
}