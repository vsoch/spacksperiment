{
    "url": "https://api.github.com/repos/spack/spack/issues/11125",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/11125/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/11125/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/11125/events",
    "html_url": "https://github.com/spack/spack/issues/11125",
    "id": 430082026,
    "node_id": "MDU6SXNzdWU0MzAwODIwMjY=",
    "number": 11125,
    "title": "Installation issue: charmpp ",
    "user": {
        "login": "hongyx11",
        "id": 16175755,
        "node_id": "MDQ6VXNlcjE2MTc1NzU1",
        "avatar_url": "https://avatars.githubusercontent.com/u/16175755?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hongyx11",
        "html_url": "https://github.com/hongyx11",
        "followers_url": "https://api.github.com/users/hongyx11/followers",
        "following_url": "https://api.github.com/users/hongyx11/following{/other_user}",
        "gists_url": "https://api.github.com/users/hongyx11/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/hongyx11/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hongyx11/subscriptions",
        "organizations_url": "https://api.github.com/users/hongyx11/orgs",
        "repos_url": "https://api.github.com/users/hongyx11/repos",
        "events_url": "https://api.github.com/users/hongyx11/events{/privacy}",
        "received_events_url": "https://api.github.com/users/hongyx11/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2019-04-06T22:12:35Z",
    "updated_at": "2019-09-09T11:20:19Z",
    "closed_at": "2019-04-07T21:05:40Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "Charmpp install failed because of MPI\r\n\r\nI just want to install charmpp but encounter the MPI problem, it's g++ and -lmpi problem, I think g++ needs to use -lmpi_cxx library, weird.\r\n\r\n```console\r\n$ spack location -s charmpp\r\n\r\n/home/hongy0a/Github/spack/var/spack/stage/charmpp-6.9.0-klaagpebpcsooek3pzxsgwcl5exbdyxl\r\n```\r\n\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\n$ spack install charmpp backend=mpi +pthreads\r\n```\r\n### Platform and user environment\r\n\r\nPlease report your OS here:\r\n```commandline\r\n$ uname -a \r\nLinux buraq 4.4.0-142-generic #168-Ubuntu SMP Wed Jan 16 21:00:45 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n$ lsb_release -d\r\nDescription:\tUbuntu 16.04.6 LTS\r\n``` \r\n\r\n### Additional information\r\n\r\nSometimes the issue benefits from additional details. In these cases there are\r\na few things we can suggest doing. First of all, you can post the full output of:\r\n```console\r\n$ spack spec --install-status charmpp\r\n\r\nInput spec\r\n--------------------------------\r\n -   charmpp\r\n\r\nConcretized\r\n--------------------------------\r\n -   charmpp@6.9.0%gcc@5.5.0 backend=netlrts build-target=LIBS ~cuda~omp~papi+production~pthreads+shared+smp~syncft~tcp~tracing arch=linux-ubuntu16.04-x86_64\r\n\r\n```\r\nto show people whether Spack installed a faulty software or if it was not able to\r\nbuild it at all. \r\n\r\nIf your build didn't make it past the configure stage, Spack as also commands to parse \r\nlogs and report error and warning messages:\r\n```console\r\n$ spack log-parse --show=errors,warnings <file-to-parse>\r\n\r\n```\r\n15 errors\r\n5 warnings\r\n     83      make[1]: Entering directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp'\r\n     84      autoreconf\r\n     85      autoheader\r\n  >> 86      automake: warning: am_libhwloc_embedded_la_rpath was already defined in condition TRUE, which includes condition !HWLOC_BUILD_STANDALONE ...\r\n     87      configure.ac:2803: ... 'am_libhwloc_embedded_la_rpath' previously defined here\r\n     88      ./configure --disable-controlpoint --disable-tracing --disable-tracing-commthread --disable-charmdebug --disable-replay --disable-error-checking --disable-stats\r\n  >> 89      Error checking is disabled\r\n     90      AMPI error checking is enabled\r\n     91      Statistics collection is disabled\r\n     92      Charm tracing is disabled\r\n\r\n     ...\r\n\r\n     878     if [ 0 -gt 0 ]; then\tmake -f Makefile_windows;\\\r\n     879     else make -f Makefile_default;\tfi\r\n     880     make[2]: Entering directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/boost-contex\r\n             t'\r\n  >> 881     make[2]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.\r\n     882     ../../bin/charmc -c jump_x86_64_sysv_elf_gas.S\r\n     883     ../bin/charmc  -optimize -production  -build-shared -DCMK_NOT_USE_CONVERSE=1 ccs-client.c\r\n     884     ar: creating ../lib/libldb-rand.a\r\n\r\n     ...\r\n\r\n     1070    make[1]: Entering directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs/ck-libs\r\n             /metis'\r\n     1071    make -C GKlib all;\r\n     1072    make[2]: Entering directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs/ck-libs\r\n             /metis'\r\n  >> 1073    make[2]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.\r\n     1074    ../../../../../bin/charmc -I. -I../GKlib -optimize -production  -build-shared    -c -o b64.o b64.c\r\n     1075    ../bin/charmc  -optimize -production  -build-shared -I.   -c -o EveryLB.o EveryLB.C\r\n     1076    ../bin/charmc  -optimize -production  -build-shared -o ../lib/libck.a trace-common.o tracec.o tracef.o init.o register.o qd.o ck.o msgalloc.o ckfutures.o ckIgetCont\r\n             rol.o debug-message.o debug-charm.o ckcallback.o cklocation.o ckmulticast.o ckarrayoptions.o ckarray.o ckreduction.o ckrdma.o waitqd.o LBDatabase.o MetaBalancer.o w\r\n             eakTest.o treeTest.o forestTest.o readmodel.o lbdb.o lbdbf.o ckobjQ.o LBAgent.o LBProfit.o ckcheckpoint.o ckmemcheckpoint.o ckevacuation.o ckmessagelogging.o ckcaus\r\n             almlog.o ckobjid.o LBDBManager.o LBComm.o LBObj.o LBMachineUtil.o CentralPredictor.o BaseLB.o CentralLB.o HybridBaseLB.o NborBaseLB.o DistBaseLB.o ckgraphTemp.o ckg\r\n             raph.o LButil.o RefinerTemp.o Refiner.o RefinerApprox.o manager.o RefinerComm.o bitvecset.o ckset.o ckheap.o CommLBHeap.o NullLB.o LBSimulation.o modifyScheduler.o\r\n             charmProjections.o cktiming.o ckbitvector.o pathHistory.o controlPoints.o arrayRedistributor.o cp_effects.o trace-controlPoints.o mpi-interoperate.o ckregex.o sdag.\r\n             o\r\n\r\n     ...\r\n\r\n     1345    make[2]: Leaving directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs/ck-libs/\r\n             metis/GKlib'\r\n     1346    make -C libmetis all;\r\n     1347    make[2]: Entering directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs/ck-libs\r\n             /metis'\r\n  >> 1348    make[2]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.\r\n     1349    ../../../../../bin/charmc -I. -I../GKlib -optimize -production  -build-shared    -c -o auxapi.o auxapi.c\r\n     1350    ../../../../../bin/charmc -I. -I../GKlib -optimize -production  -build-shared    -c -o balance.o balance.c\r\n     1351    ../../../../../bin/charmc -I. -I../GKlib -optimize -production  -build-shared    -c -o bucketsort.o bucketsort.c\r\n\r\n     ...\r\n\r\n     1798    checking if darray and subarray constructors are defined in the MPI implementation... no\r\n     1799    checking for weak symbol support... no\r\n     1800    checking whether file locks work with NFS... no\r\n  >> 1801    Warning: File locks do not work with NFS.  See the Installation and\r\n     1802    users manual for instructions on fixing this\r\n     1803    checking for strerror()... no\r\n     1804    checking for sys_errlist... no\r\n     1805    checking if a simple MPI program compiles and links... /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi\r\n             5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o): In function `MPI::Op::Init(void (*)(void const*, void*, int, MPI::Datatype const&), bool)':\r\n  >> 1806    mpi-interoperate.C:(.text._ZN3MPI2Op4InitEPFvPKvPviRKNS_8DatatypeEEb[_ZN3MPI2Op4InitEPFvPKvPviRKNS_8DatatypeEEb]+0x15): undefined reference to `ompi_mpi_cxx_op_inte\r\n             rcept'\r\n     1807    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o): In fu\r\n             nction `MPI::Intracomm::Clone() const':\r\n  >> 1808    mpi-interoperate.C:(.text._ZNK3MPI9Intracomm5CloneEv[_ZNK3MPI9Intracomm5CloneEv]+0x2a): undefined reference to `MPI::Comm::Comm()'\r\n     1809    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o): In fu\r\n             nction `MPI::Graphcomm::Clone() const':\r\n  >> 1810    mpi-interoperate.C:(.text._ZNK3MPI9Graphcomm5CloneEv[_ZNK3MPI9Graphcomm5CloneEv]+0x25): undefined reference to `MPI::Comm::Comm()'\r\n     1811    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o): In fu\r\n             nction `MPI::Cartcomm::Sub(bool const*) const':\r\n  >> 1812    mpi-interoperate.C:(.text._ZNK3MPI8Cartcomm3SubEPKb[_ZNK3MPI8Cartcomm3SubEPKb]+0x7d): undefined reference to `MPI::Comm::Comm()'\r\n     1813    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o): In fu\r\n             nction `MPI::Intracomm::Create_graph(int, int const*, int const*, bool) const':\r\n  >> 1814    mpi-interoperate.C:(.text._ZNK3MPI9Intracomm12Create_graphEiPKiS2_b[_ZNK3MPI9Intracomm12Create_graphEiPKiS2_b]+0x29): undefined reference to `MPI::Comm::Comm()'\r\n     1815    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o): In fu\r\n             nction `MPI::Cartcomm::Clone() const':\r\n  >> 1816    mpi-interoperate.C:(.text._ZNK3MPI8Cartcomm5CloneEv[_ZNK3MPI8Cartcomm5CloneEv]+0x25): undefined reference to `MPI::Comm::Comm()'\r\n     1817    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o):mpi-in\r\n             teroperate.C:(.text._ZNK3MPI9Intracomm11Create_cartEiPKiPKbb[_ZNK3MPI9Intracomm11Create_cartEiPKiPKbb]+0x87): more undefined references to `MPI::Comm::Comm()' follo\r\n             w\r\n  >> 1818    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o):(.data\r\n             .rel.ro._ZTVN3MPI8DatatypeE[_ZTVN3MPI8DatatypeE]+0x78): undefined reference to `MPI::Datatype::Free()'\r\n  >> 1819    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/../lib/libck.a(mpi-interoperate.o):(.data\r\n             .rel.ro._ZTVN3MPI3WinE[_ZTVN3MPI3WinE]+0x48): undefined reference to `MPI::Win::Free()'\r\n  >> 1820    collect2: error: ld returned 1 exit status\r\n  >> 1821    Fatal Error by charmc in directory /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs/c\r\n             k-libs/ampi/romio\r\n     1822       Command g++ -rdynamic -D_REENTRANT -O -O2 -L/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/openmpi-3.1.3-4web3zmys3nj6icwky2r6jw2y67oot5\r\n             2/lib -fPIC mpitest.o moduleinit16896.o -L/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin\r\n             /../lib -lmoduletcharm -lmoduleampi -lmoduletcharmmain /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi\r\n             5mivvoppc/lib/libmoduleampi.a -lampi-compat -lckmain -lck -lmemory-default -lthreads-default -lconv-machine -lconv-core -ltmgr -lconv-util -lconv-partition -lhwloc_\r\n             embedded -lm -lmemory-default -lthreads-default -lldb-rand -lconv-ldb -lpthread -lckqt -lckqt -lpthread -ldl -lmoduletcharmmain -lmoduleampi -lmoduletcharm -ltcharm\r\n             -compat -lmoduleNDMeshStreamer -lmodulecompletion -lmpi -lz -lm /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyz\r\n             dncizzumi5mivvoppc/bin/../lib/conv-static.o -o conftest returned error code 1\r\n     1823    charmc exiting...\r\n     1824\r\n\r\n     ...\r\n\r\n     1827    *# MPI implementation, the include path for mpi.h, and the MPI library to link\r\n     1828    /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/bin/ampicc -optimize -production -build-share\r\n             d  -O -I/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/include -o conftest mpitest.c /home/h\r\n             ongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/lib/libmoduleampi.a\r\n     1829    Makefile:47: recipe for target '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/lib/libampiro\r\n             mio.a' failed\r\n  >> 1830    make[3]: *** [/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/lib/libampiromio.a] Error 1\r\n     1831    make[3]: Leaving directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs/ck-libs/\r\n             ampi'\r\n     1832    Makefile:19: recipe for target 'ampi' failed\r\n  >> 1833    make[2]: *** [ampi] Error 2\r\n     1834    make[2]: Leaving directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs/ck-libs'\r\n     1835    Makefile:9: recipe for target 'charmlibs' failed\r\n  >> 1836    make[1]: *** [charmlibs] Error 2\r\n     1837    make[1]: Leaving directory '/home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp/libs'\r\n     1838    Makefile:727: recipe for target 'CHARMLIBS' failed\r\n  >> 1839    make: *** [CHARMLIBS] Error 2\r\n     1840    -------------------------------------------------\r\n     1841    Charm++ NOT BUILT. Either cd into /home/hongy0a/Github/spack/opt/spack/linux-ubuntu16.04-x86_64/gcc-5.5.0/charmpp-6.9.0-onicsqnegfzkyzdncizzumi5mivvoppc/tmp and try\r\n     1842    to resolve the problems yourself, visit\r\n\r\n\r\n\r\n\r\n",
    "performed_via_github_app": null
}