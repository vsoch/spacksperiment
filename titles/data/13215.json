{
    "url": "https://api.github.com/repos/spack/spack/issues/13215",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/13215/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/13215/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/13215/events",
    "html_url": "https://github.com/spack/spack/issues/13215",
    "id": 506862293,
    "node_id": "MDU6SXNzdWU1MDY4NjIyOTM=",
    "number": 13215,
    "title": "externalMPI: C compiler cannot create executables (on PSC Bridges )",
    "user": {
        "login": "SheraLee",
        "id": 33297023,
        "node_id": "MDQ6VXNlcjMzMjk3MDIz",
        "avatar_url": "https://avatars.githubusercontent.com/u/33297023?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/SheraLee",
        "html_url": "https://github.com/SheraLee",
        "followers_url": "https://api.github.com/users/SheraLee/followers",
        "following_url": "https://api.github.com/users/SheraLee/following{/other_user}",
        "gists_url": "https://api.github.com/users/SheraLee/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/SheraLee/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/SheraLee/subscriptions",
        "organizations_url": "https://api.github.com/users/SheraLee/orgs",
        "repos_url": "https://api.github.com/users/SheraLee/repos",
        "events_url": "https://api.github.com/users/SheraLee/events{/privacy}",
        "received_events_url": "https://api.github.com/users/SheraLee/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 455855856,
            "node_id": "MDU6TGFiZWw0NTU4NTU4NTY=",
            "url": "https://api.github.com/repos/spack/spack/labels/external-packages",
            "name": "external-packages",
            "color": "c5def5",
            "default": false,
            "description": null
        },
        {
            "id": 446632829,
            "node_id": "MDU6TGFiZWw0NDY2MzI4Mjk=",
            "url": "https://api.github.com/repos/spack/spack/labels/modules",
            "name": "modules",
            "color": "fef2c0",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2019-10-14T20:37:47Z",
    "updated_at": "2019-11-12T02:11:28Z",
    "closed_at": "2019-11-12T02:11:28Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "I am trying to create a package with external MPI on PSC Bridges. Spack can find the module correctly, and I can build with %intel ^mvapich2,  but for other compiler and MPI when configuring there \"configure: error: C compiler cannot create executables\".\r\n\r\nThe package can be configured successfully without spack when using  `./configure --enable-fftw CXX=mpiicpc CC=mpiicc FC=mpiifort \r\n`\r\n\r\nOne of my guesses is that I did not set up the environment properly, because in the config.log its says `None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc: No such file or directory`\r\n\r\nHere is what I did, and it seems works on other platforms:\r\n```\r\n     def setup_environment(self, spack_env, run_env):\r\n        spec = self.spec\r\n\r\n        spack_env.set('CC', spec['mpi'].mpicc)\r\n        spack_env.set('FC', spec['mpi'].mpifc)\r\n        spack_env.set('CXX', spec['mpi'].mpicxx)\r\n\r\n```\r\nThe officer guide is here: https://www.psc.edu/bridges/user-guide/programming-environment\r\n<img width=\"497\" alt=\"Screen Shot 2019-10-14 at 1 18 01 PM\" src=\"https://user-images.githubusercontent.com/33297023/66780521-dd28a400-ee85-11e9-84bd-56ed60945876.png\">\r\n<img width=\"472\" alt=\"Screen Shot 2019-10-14 at 1 24 07 PM\" src=\"https://user-images.githubusercontent.com/33297023/66780540-e9acfc80-ee85-11e9-9bd0-7da9ee97ef94.png\">\r\n<img width=\"485\" alt=\"Screen Shot 2019-10-14 at 1 24 23 PM\" src=\"https://user-images.githubusercontent.com/33297023/66780559-f5002800-ee85-11e9-95ad-ba13f73d7c77.png\">\r\n\r\n**Config.log** when run `spack install --dirty p3dfft-3%intel ^openmpi  `\r\n```\r\nThis file contains any messages produced by compilers while\r\nrunning configure, to aid debugging if configure makes a mistake.\r\n\r\nIt was created by P3DFFT++ configure 3.0.0, which was\r\ngenerated by GNU Autoconf 2.69.  Invocation command line was\r\n\r\n  $ ./configure --prefix=/home/shera/spack/opt/spack/linux-centos7-x86_64/intel-19.0.3.199/p3dfft-3-0.0.0-mylsoautcrqaklh4h4j4nhmuoa5tg6if --enable-fftw --with-fftw-lib= /opt/packages/fftw3/fftw-3.3.4/install/lib --with-fftw-inc= /opt/packages/fftw3/fftw-3.3.4/install/include\r\n\r\n## --------- ##\r\n## Platform. ##\r\n## --------- ##\r\n\r\nhostname = br006.pvt.bridges.psc.edu\r\nuname -m = x86_64\r\nuname -r = 3.10.0-693.21.1.el7.x86_64\r\nuname -s = Linux\r\nuname -v = #1 SMP Wed Mar 7 19:03:37 UTC 2018\r\n\r\n/usr/bin/uname -p = x86_64\r\n/bin/uname -X     = unknown\r\n\r\n/bin/arch              = x86_64\r\n/usr/bin/arch -k       = unknown\r\n/usr/convex/getsysinfo = unknown\r\n/usr/bin/hostinfo      = unknown\r\n/bin/machine           = unknown\r\n/usr/bin/oslevel       = unknown\r\n/bin/universe          = unknown\r\n\r\nPATH: None/compilers_and_libraries/linux/mpi/intel64/bin\r\nPATH: /home/shera/spack/lib/spack/env/intel\r\nPATH: /home/shera/spack/lib/spack/env/case-insensitive\r\nPATH: /home/shera/spack/lib/spack/env\r\nPATH: /opt/intel/advisor_2019.3.0.591490/bin64\r\nPATH: /opt/intel/vtune_amplifier_2019.3.0.591499/bin64\r\nPATH: /opt/intel/inspector_2019.3.0.591484/bin64\r\nPATH: /opt/intel/itac/2019.3.032/intel64/bin\r\nPATH: /opt/intel/clck/2019.2.1/bin/intel64\r\nPATH: /opt/intel/compilers_and_libraries_2019.3.199/linux/bin/intel64\r\nPATH: /opt/intel/compilers_and_libraries_2019.3.199/linux/mpi/intel64/libfabric/bin\r\nPATH: /opt/intel/compilers_and_libraries_2019.3.199/linux/mpi/intel64/bin\r\nPATH: /opt/intel/debugger_2019/gdb/intel64/bin\r\nPATH: /opt/packages/fftw3/fftw-3.3.4/install/bin\r\nPATH: /opt/packages/pgi/linux86-64/2018/mpi/openmpi-2.1.2/bin\r\nPATH: /opt/packages/pgi/linux86-64/18.1/bin\r\nPATH: /home/shera/spack/bin\r\nPATH: /usr/lib64/qt-3.3/bin\r\nPATH: /usr/lib64/ccache\r\nPATH: /usr/local/bin\r\nPATH: /usr/bin\r\nPATH: /usr/local/sbin\r\nPATH: /usr/sbin\r\nPATH: /opt/puppetlabs/puppet/bin\r\nPATH: /bin\r\nPATH: /sbin\r\nPATH: /opt/puppetlabs/bin\r\nPATH: /home/shera/.local/bin\r\nPATH: /home/shera/bin\r\nPATH: /opt/intel/parallel_studio_xe_2019.3.062/bin\r\n\r\n\r\n## ----------- ##\r\n## Core tests. ##\r\n## ----------- ##\r\n\r\nconfigure:2373: checking for a BSD-compatible install\r\nconfigure:2441: result: /usr/bin/install -c\r\nconfigure:2452: checking whether build environment is sane\r\nconfigure:2507: result: yes\r\nconfigure:2658: checking for a thread-safe mkdir -p\r\nconfigure:2697: result: /usr/bin/mkdir -p\r\nconfigure:2704: checking for gawk\r\nconfigure:2720: found /usr/bin/gawk\r\nconfigure:2731: result: gawk\r\nconfigure:2742: checking whether make sets $(MAKE)\r\nconfigure:2764: result: yes\r\nconfigure:2793: checking whether make supports nested variables\r\nconfigure:2810: result: yes\r\nconfigure:2940: checking whether to enable maintainer-specific portions of Makefiles\r\nconfigure:2949: result: no\r\nconfigure:2979: checking whether to use IBM compiler\r\nconfigure:2988: result: no\r\nconfigure:2999: checking whether to use Intel compiler\r\nconfigure:3008: result: no\r\nconfigure:3019: checking whether to use PGI compiler\r\nconfigure:3028: result: no\r\nconfigure:3039: checking whether to use Cray compiler\r\nconfigure:3048: result: no\r\nconfigure:3059: checking whether to use GNU compiler\r\nconfigure:3068: result: no\r\nconfigure:3080: no compiler selected...defaulting to Intel\r\nconfigure:3099: checking whether to use TIMERS\r\nconfigure:3112: result: no\r\nconfigure:3116: checking whether to use FFTW library\r\nconfigure:3133: result: yes\r\nconfigure:3136: checking whether to use ESSL library\r\nconfigure:3153: result: no\r\nconfigure:3156: checking whether to use MKL library\r\nconfigure:3173: result: no\r\nconfigure:3177: checking fftw lib location\r\nconfigure:3188: result:  /opt/packages/fftw3/fftw-3.3.4/install/lib\r\nconfigure:3196: checking fftw inc location\r\nconfigure:3207: result:  /opt/packages/fftw3/fftw-3.3.4/install/include\r\nconfigure:3268: checking for gcc\r\nconfigure:3295: result: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc\r\nconfigure:3524: checking for C compiler version\r\nconfigure:3533: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc --version >&5\r\n./configure: line 3535: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc: No such file or directory\r\nconfigure:3544: $? = 127\r\nconfigure:3533: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc -v >&5\r\n./configure: line 3535: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc: No such file or directory\r\nconfigure:3544: $? = 127\r\nconfigure:3533: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc -V >&5\r\n./configure: line 3535: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc: No such file or directory\r\nconfigure:3544: $? = 127\r\nconfigure:3533: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc -qversion >&5\r\n./configure: line 3535: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc: No such file or directory\r\nconfigure:3544: $? = 127\r\nconfigure:3564: checking whether the C compiler works\r\nconfigure:3586: None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc    conftest.c  >&5\r\n./configure: line 3588: **None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc: No such file or directory**\r\nconfigure:3590: $? = 127\r\nconfigure:3628: result: no\r\nconfigure: failed program was:\r\n| /* confdefs.h */\r\n| #define PACKAGE_NAME \"P3DFFT++\"\r\n| #define PACKAGE_TARNAME \"p3dfft--\"\r\n| #define PACKAGE_VERSION \"3.0.0\"\r\n| #define PACKAGE_STRING \"P3DFFT++ 3.0.0\"\r\n| #define PACKAGE_BUGREPORT \"dmitry@sdsc.edu\"\r\n| #define PACKAGE_URL \"\"\r\n| #define PACKAGE \"p3dfft--\"\r\n| #define VERSION \"3.0.0\"\r\n| #define INTEL 1\r\n| #define FFTW 1\r\n| /* end confdefs.h.  */\r\n| \r\n| int\r\n| main ()\r\n| {\r\n| \r\n|   ;\r\n|   return 0;\r\n| }\r\nconfigure:3633: error: in `/tmp/shera/spack-stage/spack-stage-5Z90XY/spack-src':\r\nconfigure:3635: error: C compiler cannot create executables\r\nSee `config.log' for more details\r\n\r\n## ---------------- ##\r\n## Cache variables. ##\r\n## ---------------- ##\r\n\r\nac_cv_env_CCC_set=\r\nac_cv_env_CCC_value=\r\nac_cv_env_CC_set=set\r\nac_cv_env_CC_value=None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc\r\nac_cv_env_CFLAGS_set=\r\nac_cv_env_CFLAGS_value=\r\nac_cv_env_CPPFLAGS_set=\r\nac_cv_env_CPPFLAGS_value=\r\nac_cv_env_CPP_set=\r\nac_cv_env_CPP_value=\r\nac_cv_env_CXXFLAGS_set=\r\nac_cv_env_CXXFLAGS_value=\r\nac_cv_env_CXX_set=set\r\nac_cv_env_CXX_value=None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicpc\r\nac_cv_env_FCFLAGS_set=\r\nac_cv_env_FCFLAGS_value=\r\nac_cv_env_FC_set=set\r\nac_cv_env_FC_value=None/compilers_and_libraries/linux/mpi/intel64/bin/mpiifort\r\nac_cv_env_LDFLAGS_set=\r\nac_cv_env_LDFLAGS_value=\r\nac_cv_env_LIBS_set=\r\nac_cv_env_LIBS_value=\r\nac_cv_env_build_alias_set=\r\nac_cv_env_build_alias_value=\r\nac_cv_env_host_alias_set=\r\nac_cv_env_host_alias_value=\r\nac_cv_env_target_alias_set=\r\nac_cv_env_target_alias_value=\r\nac_cv_path_install='/usr/bin/install -c'\r\nac_cv_path_mkdir=/usr/bin/mkdir\r\nac_cv_prog_AWK=gawk\r\nac_cv_prog_ac_ct_CC=None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc\r\nac_cv_prog_make_make_set=yes\r\nam_cv_make_support_nested_variables=yes\r\n\r\n## ----------------- ##\r\n## Output variables. ##\r\n## ----------------- ##\r\n\r\nACLOCAL='${SHELL} /tmp/shera/spack-stage/spack-stage-5Z90XY/spack-src/missing aclocal-1.15'\r\nAMTAR='$${TAR-tar}'\r\nAM_BACKSLASH='\\'\r\nAM_DEFAULT_V='$(AM_DEFAULT_VERBOSITY)'\r\nAM_DEFAULT_VERBOSITY='1'\r\nAM_V='$(V)'\r\nAR=''\r\nAUTOCONF='${SHELL} /tmp/shera/spack-stage/spack-stage-5Z90XY/spack-src/missing autoconf'\r\nAUTOHEADER='${SHELL} /tmp/shera/spack-stage/spack-stage-5Z90XY/spack-src/missing autoheader'\r\nAUTOMAKE='${SHELL} /tmp/shera/spack-stage/spack-stage-5Z90XY/spack-src/missing automake-1.15'\r\nAWK='gawk'\r\nCC='None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc'\r\nCFLAGS=''\r\nCPP=''\r\nCPPFLAGS=''\r\nCXX='None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicpc'\r\nCXXFLAGS=''\r\nCYGPATH_W='echo'\r\nDEFS=''\r\nECHO_C=''\r\nECHO_N='-n'\r\nECHO_T=''\r\nEGREP=''\r\nESSL_INC=''\r\nESSL_LIB=''\r\nEXEEXT=''\r\nFC='None/compilers_and_libraries/linux/mpi/intel64/bin/mpiifort'\r\nFCFLAGS=''\r\nFFTWF_LIB=''\r\nFFTW_INC=''\r\nFFTW_LIB=''\r\nGIT_DATE=''\r\nGIT_VERSION=''\r\nGREP=''\r\nINSTALL_DATA='${INSTALL} -m 644'\r\nINSTALL_PROGRAM='${INSTALL}'\r\nINSTALL_SCRIPT='${INSTALL}'\r\nINSTALL_STRIP_PROGRAM='$(install_sh) -c -s'\r\nLDFLAGS=''\r\nLIBOBJS=''\r\nLIBS=''\r\nLTLIBOBJS=''\r\nMAINT='#'\r\nMAINTAINER_MODE_FALSE=''\r\nMAINTAINER_MODE_TRUE='#'\r\nMAKEINFO='${SHELL} /tmp/shera/spack-stage/spack-stage-5Z90XY/spack-src/missing makeinfo'\r\nMKDIR_P='/usr/bin/mkdir -p'\r\nMKL_INC=''\r\nMKL_LIB=''\r\nOBJEXT=''\r\nPACKAGE='p3dfft--'\r\nPACKAGE_BUGREPORT='dmitry@sdsc.edu'\r\nPACKAGE_NAME='P3DFFT++'\r\nPACKAGE_STRING='P3DFFT++ 3.0.0'\r\nPACKAGE_TARNAME='p3dfft--'\r\nPACKAGE_URL=''\r\nPACKAGE_VERSION='3.0.0'\r\nPATH_SEPARATOR=':'\r\nRANLIB=''\r\nSET_MAKE=''\r\nSHELL='/bin/sh'\r\nSTRIP=''\r\nVERSION='3.0.0'\r\nac_ct_AR=''\r\nac_ct_CC='None/compilers_and_libraries/linux/mpi/intel64/bin/mpiicc'\r\nac_ct_CXX=''\r\nac_ct_FC=''\r\nam__EXEEXT_FALSE=''\r\nam__EXEEXT_TRUE=''\r\nam__isrc=''\r\nam__leading_dot='.'\r\nam__tar='$${TAR-tar} chof - \"$$tardir\"'\r\nam__untar='$${TAR-tar} xf -'\r\nbindir='${exec_prefix}/bin'\r\nbuild_alias=''\r\ndatadir='${datarootdir}'\r\ndatarootdir='${prefix}/share'\r\ndocdir='${datarootdir}/doc/${PACKAGE_TARNAME}'\r\ndvidir='${docdir}'\r\nexec_prefix='NONE'\r\nhost_alias=''\r\nhtmldir='${docdir}'\r\nincludedir='${prefix}/include'\r\ninfodir='${datarootdir}/info'\r\ninstall_sh='${SHELL} /tmp/shera/spack-stage/spack-stage-5Z90XY/spack-src/install-sh'\r\nlibdir='${exec_prefix}/lib'\r\nlibexecdir='${exec_prefix}/libexec'\r\nlocaledir='${datarootdir}/locale'\r\nlocalstatedir='${prefix}/var'\r\nmandir='${datarootdir}/man'\r\nmkdir_p='$(MKDIR_P)'\r\noldincludedir='/usr/include'\r\npdfdir='${docdir}'\r\nprefix='/home/shera/spack/opt/spack/linux-centos7-x86_64/intel-19.0.3.199/p3dfft-3-0.0.0-mylsoautcrqaklh4h4j4nhmuoa5tg6if'\r\nprogram_transform_name='s,x,x,'\r\npsdir='${docdir}'\r\nsbindir='${exec_prefix}/sbin'\r\nsharedstatedir='${prefix}/com'\r\nsysconfdir='${prefix}/etc'\r\ntarget_alias=''\r\n\r\n## ----------- ##\r\n## confdefs.h. ##\r\n## ----------- ##\r\n\r\n/* confdefs.h */\r\n#define PACKAGE_NAME \"P3DFFT++\"\r\n#define PACKAGE_TARNAME \"p3dfft--\"\r\n#define PACKAGE_VERSION \"3.0.0\"\r\n#define PACKAGE_STRING \"P3DFFT++ 3.0.0\"\r\n#define PACKAGE_BUGREPORT \"dmitry@sdsc.edu\"\r\n#define PACKAGE_URL \"\"\r\n#define PACKAGE \"p3dfft--\"\r\n#define VERSION \"3.0.0\"\r\n#define INTEL 1\r\n#define FFTW 1\r\n\r\nconfigure: exit 77\r\n```",
    "performed_via_github_app": null
}