{
    "url": "https://api.github.com/repos/spack/spack/issues/24514",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/24514/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/24514/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/24514/events",
    "html_url": "https://github.com/spack/spack/pull/24514",
    "id": 929724008,
    "node_id": "MDExOlB1bGxSZXF1ZXN0Njc3NTMzNjg3",
    "number": 24514,
    "title": "Filter padding out of build output when using `padded_length`",
    "user": {
        "login": "tgamblin",
        "id": 299842,
        "node_id": "MDQ6VXNlcjI5OTg0Mg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/299842?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tgamblin",
        "html_url": "https://github.com/tgamblin",
        "followers_url": "https://api.github.com/users/tgamblin/followers",
        "following_url": "https://api.github.com/users/tgamblin/following{/other_user}",
        "gists_url": "https://api.github.com/users/tgamblin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tgamblin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tgamblin/subscriptions",
        "organizations_url": "https://api.github.com/users/tgamblin/orgs",
        "repos_url": "https://api.github.com/users/tgamblin/repos",
        "events_url": "https://api.github.com/users/tgamblin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tgamblin/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 1445245539,
            "node_id": "MDU6TGFiZWwxNDQ1MjQ1NTM5",
            "url": "https://api.github.com/repos/spack/spack/labels/build",
            "name": "build",
            "color": "a83f25",
            "default": false,
            "description": "General build capability"
        },
        {
            "id": 446645732,
            "node_id": "MDU6TGFiZWw0NDY2NDU3MzI=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-environment",
            "name": "build-environment",
            "color": "bfdadc",
            "default": false,
            "description": null
        },
        {
            "id": 1491155556,
            "node_id": "MDU6TGFiZWwxNDkxMTU1NTU2",
            "url": "https://api.github.com/repos/spack/spack/labels/ci",
            "name": "ci",
            "color": "9891e0",
            "default": false,
            "description": "Issues related to Continuous Integration"
        },
        {
            "id": 3033683528,
            "node_id": "MDU6TGFiZWwzMDMzNjgzNTI4",
            "url": "https://api.github.com/repos/spack/spack/labels/logging",
            "name": "logging",
            "color": "B0F68E",
            "default": false,
            "description": ""
        },
        {
            "id": 456341797,
            "node_id": "MDU6TGFiZWw0NTYzNDE3OTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/tests",
            "name": "tests",
            "color": "b60205",
            "default": false,
            "description": "General test capability(ies)"
        },
        {
            "id": 994582045,
            "node_id": "MDU6TGFiZWw5OTQ1ODIwNDU=",
            "url": "https://api.github.com/repos/spack/spack/labels/utilities",
            "name": "utilities",
            "color": "73e251",
            "default": false,
            "description": ""
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "zackgalbreath",
        "id": 224720,
        "node_id": "MDQ6VXNlcjIyNDcyMA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/224720?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/zackgalbreath",
        "html_url": "https://github.com/zackgalbreath",
        "followers_url": "https://api.github.com/users/zackgalbreath/followers",
        "following_url": "https://api.github.com/users/zackgalbreath/following{/other_user}",
        "gists_url": "https://api.github.com/users/zackgalbreath/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/zackgalbreath/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/zackgalbreath/subscriptions",
        "organizations_url": "https://api.github.com/users/zackgalbreath/orgs",
        "repos_url": "https://api.github.com/users/zackgalbreath/repos",
        "events_url": "https://api.github.com/users/zackgalbreath/events{/privacy}",
        "received_events_url": "https://api.github.com/users/zackgalbreath/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "zackgalbreath",
            "id": 224720,
            "node_id": "MDQ6VXNlcjIyNDcyMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/224720?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/zackgalbreath",
            "html_url": "https://github.com/zackgalbreath",
            "followers_url": "https://api.github.com/users/zackgalbreath/followers",
            "following_url": "https://api.github.com/users/zackgalbreath/following{/other_user}",
            "gists_url": "https://api.github.com/users/zackgalbreath/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/zackgalbreath/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/zackgalbreath/subscriptions",
            "organizations_url": "https://api.github.com/users/zackgalbreath/orgs",
            "repos_url": "https://api.github.com/users/zackgalbreath/repos",
            "events_url": "https://api.github.com/users/zackgalbreath/events{/privacy}",
            "received_events_url": "https://api.github.com/users/zackgalbreath/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2021-06-25T00:41:44Z",
    "updated_at": "2021-07-12T21:48:53Z",
    "closed_at": "2021-07-12T21:48:52Z",
    "author_association": "MEMBER",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/24514",
        "html_url": "https://github.com/spack/spack/pull/24514",
        "diff_url": "https://github.com/spack/spack/pull/24514.diff",
        "patch_url": "https://github.com/spack/spack/pull/24514.patch"
    },
    "body": "Spack allows users to set `padded_length` to pad out the installation path in build farms so that any binaries created are more easily relocatable. The issue with this is that the padding dominates installation output and makes it difficult to see what is going on. The padding also causes logs to easily exceed size limits for things like GitLab artifacts.\r\n\r\nThis PR fixes this by adding a filter in the logger daemon. If you use a setting like this:\r\n\r\n```yaml\r\nconfig:\r\n    install_tree:\r\n        padded_length: 512\r\n```\r\n\r\nThen lines like this in the output:\r\n\r\n```console\r\n==> './configure' '--prefix=/Users/gamblin2/padding-log-test/opt/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_placeholder__/__spack_path_pla/darwin-bigsur-skylake/apple-clang-12.0.5/zlib-1.2.11-74mwnxgn6nujehpyyalhwizwojwn5zga\r\n```\r\n\r\nwill be replaced with the much more readable:\r\n\r\n```console\r\n==> './configure' '--prefix=/Users/gamblin2/padding-log-test/opt/[padded-to-512-chars]/darwin-bigsur-skylake/apple-clang-12.0.5/zlib-1.2.11-74mwnxgn6nujehpyyalhwizwojwn5zga\r\n```\r\n\r\nYou can see that the padding has been replaced with `[padded-to-512-chars]` to indicate the total number of characters in the padded prefix. Over a long log file, this should save a lot of space and allow us to see error messages in GitHub/GitLab log output.\r\n\r\nThe *actual* build logs still have full paths in them. Also lines that are output by Spack and not by a package build are not filtered and will still display the fully padded path. There aren't that many of these, so the change should still help reduce file size and readability quite a bit.",
    "performed_via_github_app": null
}