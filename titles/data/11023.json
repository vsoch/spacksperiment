{
    "url": "https://api.github.com/repos/spack/spack/issues/11023",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/11023/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/11023/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/11023/events",
    "html_url": "https://github.com/spack/spack/issues/11023",
    "id": 425681381,
    "node_id": "MDU6SXNzdWU0MjU2ODEzODE=",
    "number": 11023,
    "title": "concretizer not using available compiler version from packages.yaml",
    "user": {
        "login": "gonsie",
        "id": 135808,
        "node_id": "MDQ6VXNlcjEzNTgwOA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/135808?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gonsie",
        "html_url": "https://github.com/gonsie",
        "followers_url": "https://api.github.com/users/gonsie/followers",
        "following_url": "https://api.github.com/users/gonsie/following{/other_user}",
        "gists_url": "https://api.github.com/users/gonsie/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/gonsie/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/gonsie/subscriptions",
        "organizations_url": "https://api.github.com/users/gonsie/orgs",
        "repos_url": "https://api.github.com/users/gonsie/repos",
        "events_url": "https://api.github.com/users/gonsie/events{/privacy}",
        "received_events_url": "https://api.github.com/users/gonsie/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 512483297,
            "node_id": "MDU6TGFiZWw1MTI0ODMyOTc=",
            "url": "https://api.github.com/repos/spack/spack/labels/impact-low",
            "name": "impact-low",
            "color": "fef2c0",
            "default": false,
            "description": ""
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": {
        "login": "tgamblin",
        "id": 299842,
        "node_id": "MDQ6VXNlcjI5OTg0Mg==",
        "avatar_url": "https://avatars.githubusercontent.com/u/299842?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tgamblin",
        "html_url": "https://github.com/tgamblin",
        "followers_url": "https://api.github.com/users/tgamblin/followers",
        "following_url": "https://api.github.com/users/tgamblin/following{/other_user}",
        "gists_url": "https://api.github.com/users/tgamblin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tgamblin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tgamblin/subscriptions",
        "organizations_url": "https://api.github.com/users/tgamblin/orgs",
        "repos_url": "https://api.github.com/users/tgamblin/repos",
        "events_url": "https://api.github.com/users/tgamblin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tgamblin/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "tgamblin",
            "id": 299842,
            "node_id": "MDQ6VXNlcjI5OTg0Mg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/299842?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/tgamblin",
            "html_url": "https://github.com/tgamblin",
            "followers_url": "https://api.github.com/users/tgamblin/followers",
            "following_url": "https://api.github.com/users/tgamblin/following{/other_user}",
            "gists_url": "https://api.github.com/users/tgamblin/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/tgamblin/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/tgamblin/subscriptions",
            "organizations_url": "https://api.github.com/users/tgamblin/orgs",
            "repos_url": "https://api.github.com/users/tgamblin/repos",
            "events_url": "https://api.github.com/users/tgamblin/events{/privacy}",
            "received_events_url": "https://api.github.com/users/tgamblin/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 1,
    "created_at": "2019-03-26T22:43:52Z",
    "updated_at": "2020-02-13T09:35:21Z",
    "closed_at": null,
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I distribute instructions to my users about building spack packages. I include a copy of `packages.yaml` which users are instructed to copy to `~/.spack`. This file lists many versions of system installed packages, which depend on many compilers.\r\n\r\nThe issue is, the spack concretize picks a compiler version from the packages.yaml without checking if that compiler is available in the user's compilers.yaml.\r\n\r\n### Steps to reproduce the issue\r\n\r\nFor a new spack user:\r\n\r\n```console\r\n$ spack compiler find\r\n==> Added 2 new compilers to /g/g0/gonsie/.spack/linux/compilers.yaml\r\n    gcc@4.9.3      intel@18.0.1\r\n\r\n$ cat > ~/.spack/packages.yaml <<EOT\r\npackages:\r\n  libarchive:\r\n    buildable: False\r\n    paths:\r\n      libarchive : /usr/\r\n  openmpi:\r\n    buildable: false\r\n  mvapich2:\r\n    paths:\r\n      mvapich2@2.2%gcc@4.9.3 arch=linux-rhel7-x86_64: /usr/tce/packages/mvapich2/mvapich2-2.2-gcc-4.9.3/\r\n      mvapich2@2.2%intel@18.0.1 arch=linux-rhel7-x86_64: /usr/tce/packages/mvapich2/mvapich2-2.2-intel-18.0.1/\r\n      mvapich2@2.3%gcc@7.3.0 arch=linux-rhel7-x86_64: /usr/tce/packages/mvapich2/mvapich2-2.3-gcc-7.3.0/\r\n      mvapich2@2.3%gcc@7.1.0 arch=linux-rhel7-x86_64: /usr/tce/packages/mvapich2/mvapich2-2.3-gcc-7.1.0/\r\n    buildable: false\r\n  cmake:\r\n    paths:\r\n      cmake@3.9.2 arch=linux-rhel7-x86_64: /usr/tce/packages/cmake/cmake-3.9.2/\r\n    buildable: false\r\nEOT\r\n\r\n$ spack spec mpifileutils\r\nInput spec\r\n--------------------------------\r\nmpifileutils\r\n\r\nConcretized\r\n--------------------------------\r\n==> Error: No compilers with spec gcc@7.1.0 found for operating system rhel7 and target x86_64.\r\nRun 'spack compiler find' to add compilers....\r\n```\r\n\r\nWhat is very strange is that spack indicates it is expecting gcc@7.1.0, *always*. There is no ordering within the packages.yaml file that I can do to change this error.\r\n\r\nI have a workaround (mpifileutils%gcc@4.9.3) but this is super weird. \r\n\r\n----\r\nEdits: typos",
    "performed_via_github_app": null
}