{
    "url": "https://api.github.com/repos/spack/spack/issues/7174",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/7174/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/7174/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/7174/events",
    "html_url": "https://github.com/spack/spack/issues/7174",
    "id": 294063423,
    "node_id": "MDU6SXNzdWUyOTQwNjM0MjM=",
    "number": 7174,
    "title": "self-referencing symlink failure",
    "user": {
        "login": "tagardi",
        "id": 35976377,
        "node_id": "MDQ6VXNlcjM1OTc2Mzc3",
        "avatar_url": "https://avatars.githubusercontent.com/u/35976377?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/tagardi",
        "html_url": "https://github.com/tagardi",
        "followers_url": "https://api.github.com/users/tagardi/followers",
        "following_url": "https://api.github.com/users/tagardi/following{/other_user}",
        "gists_url": "https://api.github.com/users/tagardi/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/tagardi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/tagardi/subscriptions",
        "organizations_url": "https://api.github.com/users/tagardi/orgs",
        "repos_url": "https://api.github.com/users/tagardi/repos",
        "events_url": "https://api.github.com/users/tagardi/events{/privacy}",
        "received_events_url": "https://api.github.com/users/tagardi/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2018-02-03T00:26:54Z",
    "updated_at": "2018-02-06T12:57:29Z",
    "closed_at": "2018-02-06T12:56:41Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "Summary\r\n\r\nI'm trying to write a very simple new package for the x264 library used by ffmpeg.  The package.py file looks like this:\r\n```python\r\nfrom spack import *\r\n\r\nclass Libx264(AutotoolsPackage):\r\n    \"\"\"This installs x264, a free software library and application for encoding video streams into the H.264/MPEG-4 AVC compression format, released under the terms of the GNU GPL.\"\"\"\r\n\r\n    # FIXME: Add a proper url for your package's homepage here.\r\n    homepage = \"http://www.videolan.org/developers/x264.html\"\r\n    url      = \"ftp://ftp.videolan.org/pub/videolan/x264/snapshots/x264-snapshot-20180201-2245-stable.tar.bz2\"\r\n\r\n    version('264-snapshot-20180201-2245', '8b4ccde2d6746fbb9f8672d8b41efe8e')\r\n\r\n    # FIXME: Add dependencies if required.\r\n    # depends_on('foo')\r\n\r\n    def configure_args(self):\r\n        # FIXME: Add arguments other than --prefix\r\n        # FIXME: If not needed delete this function\r\n        args = ['--disable-asm']\r\n        return args\r\n```\r\n### Expected Result\r\n\r\nWhen manually executing configure, make, etc. this code builds out of the box, so I expected this should be relatively simple.\r\n\r\n### Actual Result\r\n\r\nInstead, it appears that during the \"autoreconf\" process the Makefile is replaced by a self-referencing soft link.  This causes the \"spack install libx264\" command to fail with the error \"make: Makefile: Too many levels of symbolic links\".\r\n\r\n### Steps to reproduce the issue\r\n\r\nSimply adding the above package.py file in builtin/packages/libx264/package.py and executing\r\n\r\n```console\r\n$ spack install libx264\r\n```\r\nshould reproduce the problem.\r\n\r\n### Information on your system\r\n\r\nThis problem occurs on darwin, el capitan, 10.11.6\r\n\r\nI've seen issues of this sort reported in the past.  Any thoughts on how to resolve this?\r\nThanks!",
    "performed_via_github_app": null
}