{
    "url": "https://api.github.com/repos/spack/spack/issues/6143",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/6143/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/6143/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/6143/events",
    "html_url": "https://github.com/spack/spack/issues/6143",
    "id": 271227589,
    "node_id": "MDU6SXNzdWUyNzEyMjc1ODk=",
    "number": 6143,
    "title": "Error building elpa: AttributeError: 'Spec' object has no attribute 'mpicc'",
    "user": {
        "login": "baip",
        "id": 6233512,
        "node_id": "MDQ6VXNlcjYyMzM1MTI=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6233512?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/baip",
        "html_url": "https://github.com/baip",
        "followers_url": "https://api.github.com/users/baip/followers",
        "following_url": "https://api.github.com/users/baip/following{/other_user}",
        "gists_url": "https://api.github.com/users/baip/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/baip/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/baip/subscriptions",
        "organizations_url": "https://api.github.com/users/baip/orgs",
        "repos_url": "https://api.github.com/users/baip/repos",
        "events_url": "https://api.github.com/users/baip/events{/privacy}",
        "received_events_url": "https://api.github.com/users/baip/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        },
        {
            "id": 446645732,
            "node_id": "MDU6TGFiZWw0NDY2NDU3MzI=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-environment",
            "name": "build-environment",
            "color": "bfdadc",
            "default": false,
            "description": null
        },
        {
            "id": 446632829,
            "node_id": "MDU6TGFiZWw0NDY2MzI4Mjk=",
            "url": "https://api.github.com/repos/spack/spack/labels/modules",
            "name": "modules",
            "color": "fef2c0",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "alalazo",
        "id": 4199709,
        "node_id": "MDQ6VXNlcjQxOTk3MDk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alalazo",
        "html_url": "https://github.com/alalazo",
        "followers_url": "https://api.github.com/users/alalazo/followers",
        "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
        "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
        "organizations_url": "https://api.github.com/users/alalazo/orgs",
        "repos_url": "https://api.github.com/users/alalazo/repos",
        "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alalazo/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "alalazo",
            "id": 4199709,
            "node_id": "MDQ6VXNlcjQxOTk3MDk=",
            "avatar_url": "https://avatars.githubusercontent.com/u/4199709?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/alalazo",
            "html_url": "https://github.com/alalazo",
            "followers_url": "https://api.github.com/users/alalazo/followers",
            "following_url": "https://api.github.com/users/alalazo/following{/other_user}",
            "gists_url": "https://api.github.com/users/alalazo/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/alalazo/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/alalazo/subscriptions",
            "organizations_url": "https://api.github.com/users/alalazo/orgs",
            "repos_url": "https://api.github.com/users/alalazo/repos",
            "events_url": "https://api.github.com/users/alalazo/events{/privacy}",
            "received_events_url": "https://api.github.com/users/alalazo/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 10,
    "created_at": "2017-11-04T21:24:59Z",
    "updated_at": "2019-04-05T11:23:47Z",
    "closed_at": "2019-04-05T11:23:46Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I was trying to do: `spack install elpa %gcc@6.4.0 ^intel-mkl@2018.0.128 ^intel-mpi@2018.0.128` on Rocks cluster 6.2/CentOS 6.6, but in the install phase, it gives the error in the title. The spack-build.out indicates however that the build was successful:\r\n\r\n    ----------------------------------------------------------------------\r\n    Libraries have been installed in:\r\n       /share/apps/spack/opt/spack/linux-centos6-x86_64/gcc-7.2.0/elpa-2016.05.004-7r6rtnnke4rasnbmww6thzgdv57b2nmj/lib\r\n\r\n    If you ever happen to want to link against installed libraries\r\n    in a given directory, LIBDIR, you must either use libtool, and\r\n    specify the full pathname of the library, or use the '-LLIBDIR'\r\n    flag during linking and do at least one of the following:\r\n      - add LIBDIR to the 'LD_LIBRARY_PATH' environment variable\r\n        during execution\r\n      - add LIBDIR to the 'LD_RUN_PATH' environment variable\r\n        during linking\r\n      - use the '-Wl,-rpath -Wl,LIBDIR' linker flag\r\n      - have your system administrator add LIBDIR to '/etc/ld.so.conf'\r\n    \r\n    See any operating system documentation about shared libraries for\r\n    more information, such as the ld(1) and ld.so(8) manual pages.\r\n     ----------------------------------------------------------------------\r\n    /bin/mkdir -p '/share/apps/spack/opt/spack/linux-centos6-x86_64/gcc-7.2.0/elpa-2016.05.004-7r6rtnnke4rasnbmww6thzgdv57b2nmj/bin'\r\n     /bin/sh ./libtool   --mode=install /usr/bin/install -c elpa2_print_kernels '/share/apps/spack/opt/spack/linux-centos6-x86_64/gcc-7.2.0/elpa-2016.05.004-7r6rtnnke4rasnbmww6thzgdv57b2nmj/bin'\r\n    libtool: install: /usr/bin/install -c .libs/elpa2_print_kernels /share/apps/spack/opt/spack/linux-centos6-x86_64/gcc-7.2.0/elpa-2016.05.004-7r6rtnnke4rasnbmww6thzgdv57b2nmj/bin/elpa2_print_kernels\r\n    make[2]: Leaving directory `/tmp/soft/spack-stage/spack-stage-aaRYV2/elpa-2016.05.004/spack-build'\r\n    make[1]: Leaving directory `/tmp/soft/spack-stage/spack-stage-aaRYV2/elpa-2016.05.004/spack-build'\r\n\r\nThe full error logs are:\r\n\r\n    ==> intel-mkl is already installed in /share/apps/spack/opt/spack/linux-centos6-x86_64/gcc-6.4.0/intel-mkl-2018.0.128-ghtmbtscrmcextiiwijcgh2pv2xftq6r                                       \r\n    ==> intel-mpi is already installed in /share/apps/spack/opt/spack/linux-centos6-x86_64/gcc-6.4.0/intel-mpi-2018.0.128-hfjbyb3cljw5ej2xtil6vujvjrvywbc2                                       \r\n    ==> Installing elpa                                                                                                                                                                          \r\n    ('spec-mpi', ['__class__', '__contains__', '__delattr__', '__dict__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__init__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_add_dependency', '_add_flag', '_add_version', '_autospec', '_cmp_key', '_cmp_key_cache', '_cmp_node', '_concrete', '_concretize_helper', '_constrain_dependencies', '_dependencies', '_dependents', '_dup', '_dup_deps', '_eq_dag', '_evaluate_dependency_conditions', '_expand_virtual_packages', '_find_deps', '_find_provider', '_hash', '_install_status', '_installed_explicitly', '_mark_concrete', '_merge_dependency', '_normal', '_normalize_helper', '_replace_with', '_set_architecture', '_set_compiler', '_set_test_prefix', 'architecture', 'cformat', 'colorized', 'command', 'common_dependencies', 'compiler', 'compiler_flags', 'concrete', 'concretize', 'concretized', 'constrain', 'constrained', 'copy', 'cshort_spec', 'dag_hash', 'dag_hash_bit_prefix', 'dep_difference', 'dep_string', 'dependencies', 'dependencies_dict', 'dependents', 'dependents_dict', 'eq_dag', 'eq_node', 'external', 'external_module', 'external_path', 'flat_dependencies', 'format', 'from_dict', 'from_json', 'from_literal', 'from_node_dict', 'from_yaml', 'fullname', 'get_dependency', 'headers', 'index', 'is_virtual', 'last_query', 'libs', 'mpicc', 'mpicxx', 'mpif77', 'mpifc', 'name', 'namespace', 'ne_dag', 'ne_node', 'normalize', 'normalized', 'package', 'package_class', 'patches', 'prefix', 'read_yaml_dep_specs', 'root', 'satisfies', 'satisfies_dependencies', 'short_spec', 'sorted_deps', 'to_dict', 'to_json', 'to_node_dict', 'to_yaml', 'traverse', 'traverse_edges', 'tree', 'validate_or_raise', 'variants', 'version', 'versions', 'virtual', 'virtual_dependencies'])\r\n    ==> Warning: Suspicious requests to set or unset 'CC' found\r\n    ==> Warning:            env.set('CC', join_path(link_dir, compiler.link_paths['cc'])) at /share/apps/spack/lib/spack/spack/build_environment.py:148\r\n    ==> Warning:    --->    spack_env.set('CC', spec['mpi'].mpicc) at /share/apps/spack/var/spack/repos/builtin/packages/elpa/package.py:72\r\n    ==> Warning: Suspicious requests to set or unset 'CXX' found\r\n    ==> Warning:            env.set('CXX', join_path(link_dir, compiler.link_paths['cxx'])) at /share/apps/spack/lib/spack/spack/build_environment.py:151\r\n    ==> Warning:    --->    spack_env.set('CXX', spec['mpi'].mpicxx) at /share/apps/spack/var/spack/repos/builtin/packages/elpa/package.py:74\r\n    ==> Warning: Suspicious requests to set or unset 'FC' found\r\n    ==> Warning:            env.set('FC', join_path(link_dir, compiler.link_paths['fc'])) at /share/apps/spack/lib/spack/spack/build_environment.py:157\r\n    ==> Warning:    --->    spack_env.set('FC', spec['mpi'].mpifc) at /share/apps/spack/var/spack/repos/builtin/packages/elpa/package.py:73\r\n    ==> Using cached archive: /share/apps/spack/var/spack/cache/elpa/elpa-2016.05.004.tar.gz\r\n    ==> Staging archive: /share/apps/spack/var/spack/stage/elpa-2016.05.004-7r6rtnnke4rasnbmww6thzgdv57b2nmj/elpa-2016.05.004.tar.gz\r\n    ==> Created stage in /share/apps/spack/var/spack/stage/elpa-2016.05.004-7r6rtnnke4rasnbmww6thzgdv57b2nmj\r\n    ==> No patches needed for elpa\r\n    ==> Building elpa [AutotoolsPackage]\r\n    ==> Executing phase: 'autoreconf'\r\n    ==> Executing phase: 'configure'\r\n    ==> Executing phase: 'build'\r\n    ==> Executing phase: 'install'\r\n    ('spec-mpi', ['__class__', '__contains__', '__delattr__', '__dict__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__gt__', '__hash__', '__init__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_add_dependency', '_add_flag', '_add_version', '_autospec', '_cmp_key', '_cmp_key_cache', '_cmp_node', '_concrete', '_concretize_helper', '_constrain_dependencies', '_dependencies', '_dependents', '_dup', '_dup_deps', '_eq_dag', '_evaluate_dependency_conditions', '_expand_virtual_packages', '_find_deps', '_find_provider', '_hash', '_install_status', '_installed_explicitly', '_mark_concrete', '_merge_dependency', '_normal', '_normalize_helper', '_replace_with', '_set_architecture', '_set_compiler', '_set_test_prefix', 'architecture', 'cformat', 'colorized', 'command', 'common_dependencies', 'compiler', 'compiler_flags', 'concrete', 'concretize', 'concretized', 'constrain', 'constrained', 'copy', 'cshort_spec', 'dag_hash', 'dag_hash_bit_prefix', 'dep_difference', 'dep_string', 'dependencies', 'dependencies_dict', 'dependents', 'dependents_dict', 'eq_dag', 'eq_node', 'external', 'external_module', 'external_path', 'flat_dependencies', 'format', 'from_dict', 'from_json', 'from_literal', 'from_node_dict', 'from_yaml', 'fullname', 'get_dependency', 'headers', 'index', 'is_virtual', 'last_query', 'libs', 'name', 'namespace', 'ne_dag', 'ne_node', 'normalize', 'normalized', 'package', 'package_class', 'patches', 'prefix', 'read_yaml_dep_specs', 'root', 'satisfies', 'satisfies_dependencies', 'short_spec', 'sorted_deps', 'to_dict', 'to_json', 'to_node_dict', 'to_yaml', 'traverse', 'traverse_edges', 'tree', 'validate_or_raise', 'variants', 'version', 'versions', 'virtual', 'virtual_dependencies'])\r\n    ==> Error: AttributeError: 'Spec' object has no attribute 'mpicc'\r\n\r\n    /share/apps/spack/var/spack/repos/builtin/packages/elpa/package.py:71, in setup_environment:\r\n         3             spec = self.spec\r\n         4\r\n         5             print('spec-mpi', dir(spec['mpi']))\r\n      >> 6             spack_env.set('CC', spec['mpi'].mpicc)\r\n         7             spack_env.set('FC', spec['mpi'].mpifc)\r\n         8             spack_env.set('CXX', spec['mpi'].mpicxx)\r\n",
    "performed_via_github_app": null
}