{
    "url": "https://api.github.com/repos/spack/spack/issues/2059",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/2059/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/2059/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/2059/events",
    "html_url": "https://github.com/spack/spack/issues/2059",
    "id": 184106093,
    "node_id": "MDU6SXNzdWUxODQxMDYwOTM=",
    "number": 2059,
    "title": "Conflict between Spack and Lua auto-builders",
    "user": {
        "login": "hartzell",
        "id": 312978,
        "node_id": "MDQ6VXNlcjMxMjk3OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/312978?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hartzell",
        "html_url": "https://github.com/hartzell",
        "followers_url": "https://api.github.com/users/hartzell/followers",
        "following_url": "https://api.github.com/users/hartzell/following{/other_user}",
        "gists_url": "https://api.github.com/users/hartzell/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/hartzell/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hartzell/subscriptions",
        "organizations_url": "https://api.github.com/users/hartzell/orgs",
        "repos_url": "https://api.github.com/users/hartzell/repos",
        "events_url": "https://api.github.com/users/hartzell/events{/privacy}",
        "received_events_url": "https://api.github.com/users/hartzell/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 73908754,
            "node_id": "MDU6TGFiZWw3MzkwODc1NA==",
            "url": "https://api.github.com/repos/spack/spack/labels/bug",
            "name": "bug",
            "color": "fc2929",
            "default": true,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 14,
    "created_at": "2016-10-20T00:17:09Z",
    "updated_at": "2017-01-04T16:42:47Z",
    "closed_at": "2017-01-04T16:42:47Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "I believe that I've installed lmod recently, but when I just tried I hit this:\n\n```\n[hartzelg@rss-spack spack]$ spack -v  install lmod%gcc@5.4.0\n==> Installing lmod\n==> lua is already installed in /rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-5.3.2-wkvqiqfuvioalijgr7kbrufkg4xxqkvv\n==> tcl is already installed in /rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/tcl-8.6.5-jx7kopdjrbh4nvjz5bzvy3sltvcutsnf\n==> lua-luaposix is already installed in /rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-luaposix-33.4.0-2o4d5te2ozepcuiad7txpowbifry2rut\n==> Installing lua-luafilesystem\n==> lua is already installed in /rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-5.3.2-wkvqiqfuvioalijgr7kbrufkg4xxqkvv\n==> Already downloaded /rss/spack/var/spack/stage/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz/v_1_6_3.tar.gz\n==> Already staged lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz in /rss/spack/var/spack/stage/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz\n==> No patches needed for lua-luafilesystem\n==> Building lua-luafilesystem\n==> '/rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-5.3.2-wkvqiqfuvioalijgr7kbrufkg4xxqkvv/bin/luarocks' '--tree=/rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz' 'install' '/rss/spack/var/spack/stage/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz/luafilesystem-v_1_6_3/rockspecs/luafilesystem-1.6.3-1.rockspec'\nUsing /rss/spack/var/spack/stage/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz/luafilesystem-v_1_6_3/rockspecs/luafilesystem-1.6.3-1.rockspec... switching to 'build' mode\nCloning into 'luafilesystem'...\nerror: unable to find 0a82aae451c5c95ceacb5fcb235f4d1ea964f5f5\nfatal: object of unexpected type\nfatal: index-pack failed\n\nError: Failed cloning git repository.\n==> WRITE LOCK: /rss/spack/opt/spack/.spack-db/prefix_lock[814682083189999914:1] [Released]\n==> WRITE LOCK: /rss/spack/var/spack/stage/.lock[8328219156727360566:1] [Released]\n==> Error: Command exited with status 1:\n'/rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-5.3.2-wkvqiqfuvioalijgr7kbrufkg4xxqkvv/bin/luarocks' '--tree=/rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz' 'install' '/rss/spack/var/spack/stage/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz/luafilesystem-v_1_6_3/rockspecs/luafilesystem-1.6.3-1.rockspec'\n\nSee build log for details:\n  /tmp/hartzelg/spack-stage/spack-stage-P6RM_H/luafilesystem-v_1_6_3/spack-build.out\n\n/rss/spack/var/spack/repos/builtin/packages/lua-luafilesystem/package.py:51, in install:\n     45       def install(self, spec, prefix):\n     46           rockspec_fmt = join_path(self.stage.path,\n     47                                    'luafilesystem-v_{version.underscored}',\n     48                                    'rockspecs',\n     49                                    'luafilesystem-{version.dotted}-1.rockspec')\n     50           luarocks('--tree=' + prefix, 'install',\n  >> 51                    rockspec_fmt.format(version=self.spec.version))\n==> Error: Installation process had nonzero exit code : 256\n```\n\nHere's spack-build.out:\n\n```\n[hartzelg@rss-spack spack]$ cat /tmp/hartzelg/spack-stage/spack-stage-P6RM_H/luafilesystem-v_1_6_3/spack-build.out\n==> '/rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-5.3.2-wkvqiqfuvioalijgr7kbrufkg4xxqkvv/bin/luarocks' '--tree=/rss/spack/opt/spack/linux-centos7-x86_64/gcc-5.4.0/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz' 'install' '/rss/spack/var/spack/stage/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz/luafilesystem-v_1_6_3/rockspecs/luafilesystem-1.6.3-1.rockspec'\nUsing /rss/spack/var/spack/stage/lua-luafilesystem-1_6_3-c2okue422sjfik3xncvoq3wu3plugekz/luafilesystem-v_1_6_3/rockspecs/luafilesystem-1.6.3-1.rockspec... switching to 'build' mode\nCloning into 'luafilesystem'...\nerror: unable to find 0a82aae451c5c95ceacb5fcb235f4d1ea964f5f5\nfatal: object of unexpected type\nfatal: index-pack failed\n\nError: Failed cloning git repository.\n```\n\nI can't quite figure out what's being cloned to generate the failure.  _luafilesystem-1.6.3-1.rockspec_ refers to `git://github.com/keplerproject/luafilesystem`, which I can clone successfully: \n\n```\n[hartzelg@rss-spack spack]$ git clone git://github.com/keplerproject/luafilesystem\nCloning into 'luafilesystem'...\nremote: Counting objects: 1554, done.\nremote: Total 1554 (delta 0), reused 0 (delta 0), pack-reused 1553\nReceiving objects: 100% (1554/1554), 312.75 KiB | 0 bytes/s, done.\nResolving deltas: 100% (698/698), done.\n```\n\nand when I do it has a very different number of objects than whatever's imploding.\n\nAny suggestions before I go spelunking?\n",
    "performed_via_github_app": null
}