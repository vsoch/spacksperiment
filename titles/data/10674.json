{
    "url": "https://api.github.com/repos/spack/spack/issues/10674",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/10674/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/10674/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/10674/events",
    "html_url": "https://github.com/spack/spack/issues/10674",
    "id": 413093890,
    "node_id": "MDU6SXNzdWU0MTMwOTM4OTA=",
    "number": 10674,
    "title": "Installation issue: mvapich2",
    "user": {
        "login": "jumpydiaz",
        "id": 6709390,
        "node_id": "MDQ6VXNlcjY3MDkzOTA=",
        "avatar_url": "https://avatars.githubusercontent.com/u/6709390?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jumpydiaz",
        "html_url": "https://github.com/jumpydiaz",
        "followers_url": "https://api.github.com/users/jumpydiaz/followers",
        "following_url": "https://api.github.com/users/jumpydiaz/following{/other_user}",
        "gists_url": "https://api.github.com/users/jumpydiaz/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jumpydiaz/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jumpydiaz/subscriptions",
        "organizations_url": "https://api.github.com/users/jumpydiaz/orgs",
        "repos_url": "https://api.github.com/users/jumpydiaz/repos",
        "events_url": "https://api.github.com/users/jumpydiaz/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jumpydiaz/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 446616547,
            "node_id": "MDU6TGFiZWw0NDY2MTY1NDc=",
            "url": "https://api.github.com/repos/spack/spack/labels/build-error",
            "name": "build-error",
            "color": "ff3300",
            "default": false,
            "description": null
        }
    ],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2019-02-21T19:47:37Z",
    "updated_at": "2019-03-07T18:10:05Z",
    "closed_at": null,
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "I'm attempting to install mvapich2 using gcc6.4 and another instance with gcc@8.2, with all of it's dependents being compiled with gcc4.8.5. I keep getting a 'cross compiling' error.\r\n---\r\n\r\n### Steps to reproduce the issue\r\n\r\n```console\r\ncalled from script\r\nspack install mvapich2@2.3%gcc@6.4.0~alloca ch3_rank_bits=32 +cuda~debug fabrics=psm file_systems=auto process_managers=auto +regcache threads=multiple arch=linux-centos7-x86_64 \\\r\n    ^bison@3.0.5%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n        ^diffutils@3.7%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n        ^help2man@1.47.4%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n            ^gettext@0.19.8.1%gcc@4.8.5+bzip2+curses+git~libunistring+libxml2 patches=9acdb4e73f67c241b5ef32505c9ddf7cf6884ca8ea661692f21dca28483b04b8 +tar+xz arch=linux-centos7-x86_64 \\\r\n                ^bzip2@1.0.6%gcc@4.8.5+shared arch=linux-centos7-x86_64 \\\r\n                ^libxml2@2.9.8%gcc@4.8.5~python arch=linux-centos7-x86_64 \\\r\n                    ^libiconv@1.15%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n                    ^pkgconf@0.27.1%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n                    ^xz@5.2.4%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n                    ^zlib@1.2.7%gcc@4.8.5+optimize+pic+shared arch=linux-centos7-x86_64 \\\r\n                ^ncurses@6.1%gcc@4.8.5~symlinks~termlib arch=linux-centos7-x86_64 \\\r\n                ^tar@1.26%gcc@4.8.5 patches=08921fcbd732050c74ddf1de7d8ad95ffdbc09f8b4342456fa2f6a0dd02a957c,5c314db58d005043bf407abaf25eb9823b9032a22fd12a0b142d4bf548130fa4,d428578be7fb99b831eb61e53b8d88a859afe08b479a21238180899707d79ce4 arch=linux-centos7-x86_64 \\\r\n            ^perl@5.16.3%gcc@4.8.5+cpanm patches=0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac +shared+threads arch=linux-centos7-x86_64 \\\r\n        ^m4@1.4.16%gcc@4.8.5 patches=c0a408fbffb7255fcc75e26bd8edab116fc81d216bfd18b473668b7739a4158e +sigsegv arch=linux-centos7-x86_64 \\\r\n    ^cuda@10.0.130%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n    ^findutils@4.6.0%gcc@4.8.5 patches=84b916c0bf8c51b7e7b28417692f0ad3e7030d1f3c248ba77c42ede5c1c5d11e,bd9e4e5cc280f9753ae14956c4e4aa17fe7a210f55dd6c84aa60b12d106d47a2 arch=linux-centos7-x86_64 \\\r\n        ^autoconf@2.69%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n        ^automake@1.13.4%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n        ^libtool@2.4.2%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n        ^texinfo@6.5%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n    ^libpciaccess@0.13.5%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n        ^util-macros@1.19.1%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n    ^psm@3.3%gcc@4.8.5 arch=linux-centos7-x86_64 \\\r\n        ^libuuid@1.0.3%gcc@4.8.5 arch=linux-centos7-x86_64 # Fill in the exact spec you are using\r\n```\r\n... # and the relevant part of the error message\r\n\r\n\r\n3 errors found in build log:\r\n     935    checking whether make supports nested variables... yes\r\n     936    checking whether to enable maintainer-specific portions of Makefiles... yes\r\n     937    checking for style of include used by make... GNU\r\n     938    checking whether the C compiler works... yes\r\n     939    checking for C compiler default output file name... a.out\r\n     940    checking for suffix of executables...\r\n  * 941    checking whether we are cross compiling... configure: error: in `/tmp/root/spack-stage/spack-stage-3WAodj/mvapich2-2.3/src/mpi/romio':\r\n  * 942    configure: error: cannot run C compiled programs.\r\n     943    If you meant to cross compile, use `--host'.\r\n     944    See `config.log' for more details\r\n  * 945    configure: error: src/mpi/romio configure failed\r\n\r\n### Platform and user environment\r\n\r\n\r\n```commandline\r\n$ uname -a \r\nLinux omitted 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux\r\n$ lsb_release -d\r\nDescription:    CentOS Linux release 7.6.1810 (Core) \r\n``` \r\n\r\n\r\n- `packages.yaml`\r\n- `compilers.yaml`\r\n````\r\ncompilers:\r\n- compiler:\r\n    environment: {}\r\n    extra_rpaths: []\r\n    flags: {}\r\n    modules: []\r\n    operating_system: centos7\r\n    paths:\r\n      cc: /usr/bin/gcc\r\n      cxx: /usr/bin/g++\r\n      f77: /usr/bin/gfortran\r\n      fc: /usr/bin/gfortran\r\n    spec: gcc@4.8.5\r\n    target: x86_64\r\n- compiler:\r\n    environment: {}\r\n    extra_rpaths: []\r\n    flags: {}\r\n    modules: []\r\n    operating_system: centos7\r\n    paths:\r\n      cc: /apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-6.4.0-3zna454grl6qrwxti6q4hsvfxedwllcl/bin/gcc\r\n      cxx: /apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-6.4.0-3zna454grl6qrwxti6q4hsvfxedwllcl/bin/g++\r\n      f77: /apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-6.4.0-3zna454grl6qrwxti6q4hsvfxedwllcl/bin/gfortran\r\n      fc: /apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/gcc-6.4.0-3zna454grl6qrwxti6q4hsvfxedwllcl/bin/gfortran\r\n    spec: gcc@6.4.0\r\n    target: x86_64`\r\n````\r\n\r\nto the issue\r\n\r\n### Additional information\r\n\r\n```console\r\n$ spack spec --install-status [above]\r\n```\r\n```\r\nConcretized\r\n--------------------------------\r\n -   mvapich2@2.3%gcc@6.4.0~alloca ch3_rank_bits=32 +cuda~debug fabrics=psm file_systems=auto process_managers=auto +regcache threads=multiple arch=linux-centos7-x86_64 \r\n[+]      ^bison@3.0.5%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]          ^diffutils@3.7%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]          ^help2man@1.47.4%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]              ^gettext@0.19.8.1%gcc@4.8.5+bzip2+curses+git~libunistring+libxml2 patches=9acdb4e73f67c241b5ef32505c9ddf7cf6884ca8ea661692f21dca28483b04b8 +tar+xz arch=linux-centos7-x86_64 \r\n[+]                  ^bzip2@1.0.6%gcc@4.8.5+shared arch=linux-centos7-x86_64 \r\n[+]                  ^libxml2@2.9.8%gcc@4.8.5~python arch=linux-centos7-x86_64 \r\n[+]                      ^libiconv@1.15%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]                      ^pkgconf@0.27.1%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]                      ^xz@5.2.4%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]                      ^zlib@1.2.7%gcc@4.8.5+optimize+pic+shared arch=linux-centos7-x86_64 \r\n[+]                  ^ncurses@6.1%gcc@4.8.5~symlinks~termlib arch=linux-centos7-x86_64 \r\n[+]                  ^tar@1.26%gcc@4.8.5 patches=08921fcbd732050c74ddf1de7d8ad95ffdbc09f8b4342456fa2f6a0dd02a957c,5c314db58d005043bf407abaf25eb9823b9032a22fd12a0b142d4bf548130fa4,d428578be7fb99b831eb61e53b8d88a859afe08b479a21238180899707d79ce4 arch=linux-centos7-x86_64 \r\n[+]              ^perl@5.16.3%gcc@4.8.5+cpanm patches=0eac10ed90aeb0459ad8851f88081d439a4e41978e586ec743069e8b059370ac +shared+threads arch=linux-centos7-x86_64 \r\n[+]          ^m4@1.4.16%gcc@4.8.5 patches=c0a408fbffb7255fcc75e26bd8edab116fc81d216bfd18b473668b7739a4158e +sigsegv arch=linux-centos7-x86_64 \r\n[+]      ^cuda@10.0.130%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]      ^findutils@4.6.0%gcc@4.8.5 patches=84b916c0bf8c51b7e7b28417692f0ad3e7030d1f3c248ba77c42ede5c1c5d11e,bd9e4e5cc280f9753ae14956c4e4aa17fe7a210f55dd6c84aa60b12d106d47a2 arch=linux-centos7-x86_64 \r\n[+]          ^autoconf@2.69%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]          ^automake@1.13.4%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]          ^libtool@2.4.2%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]          ^texinfo@6.5%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]      ^libpciaccess@0.13.5%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]          ^util-macros@1.19.1%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]      ^psm@3.3%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n[+]          ^libuuid@1.0.3%gcc@4.8.5 arch=linux-centos7-x86_64 \r\n...\r\n\r\n```\r\nto show people whether Spack installed a faulty software or if it was not able to\r\nbuild it at all. \r\n\r\nIf your build didn't make it past the configure stage, Spack as also commands to parse \r\nlogs and report error and warning messages:\r\n```console\r\n$ spack log-parse --show=errors,warnings buildlog\r\n```\r\n```\r\nspack log-parse --show=errors,warnings /apps/spack/var/spack/stage/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt/mvapich2-2.3/spack-build.out\r\n3 errors\r\n1 warnings\r\n     630    checking for max C struct floating point alignment... sixteen\r\n     631    checking for max C struct alignment of structs with doubles... eight\r\n     632    checking for max C struct floating point alignment with long doubles... sixteen\r\n  >> 633    configure: WARNING: Structures containing long doubles may be aligned differently from structures with floats or longs.  MVAPICH2 does not handle this case automatically and you should avoid assumed extents for structures containing float types.\r\n     634    checking if alignment of structs with doubles is based on position... no\r\n     635    checking if alignment of structs with long long ints is based on position... no\r\n     636    checking if double alignment breaks rules, find actual alignment... no\r\n\r\n     ...\r\n\r\n     938    checking whether the C compiler works... yes\r\n     939    checking for C compiler default output file name... a.out\r\n     940    checking for suffix of executables...\r\n  >> 941    checking whether we are cross compiling... configure: error: in `/tmp/root/spack-stage/spack-stage-NdXpGg/mvapich2-2.3/src/mpi/romio':\r\n  >> 942    configure: error: cannot run C compiled programs.\r\n     943    If you meant to cross compile, use `--host'.\r\n     944    See `config.log' for more details\r\n  >> 945    configure: error: src/mpi/romio configure failed\r\n```\r\n\r\nRebuilding the package with the following options:\r\n```console\r\n$ spack -d install -j 1 <above spec>\r\n...\r\n```\r\n```\r\n==> [2019-02-21-20:00:41.074013] Installing mvapich2\r\n==> [2019-02-21-20:00:41.074131] Searching for binary cache of mvapich2\r\n==> [2019-02-21-20:00:41.074427] Reading config file /apps/spack/etc/spack/mirrors.yaml\r\n==> [2019-02-21-20:00:41.076184] Finding buildcaches in /apps/spack-mirror/build_cache\r\n==> [2019-02-21-20:00:41.079571] No binary for mvapich2 found: installing from source\r\n==> [2019-02-21-20:00:41.221030] No libraries found for psm\r\n==> [2019-02-21-20:00:41.656132] Warning: A dependency has updated CPATH, this may lead pkg-config to assume that the package is part of the system includes and omit it when invoked with '--cflags'.\r\n==> [2019-02-21-20:00:41.737930] Using cached archive: /apps/spack/var/spack/cache/mvapich2/mvapich2-2.3.tar.gz\r\n==> [2019-02-21-20:00:41.800909] Staging archive: /apps/spack/var/spack/stage/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt/mvapich2-2.3.tar.gz\r\n==> [2019-02-21-20:00:41.802290] '/bin/tar' '-xf' '/apps/spack/var/spack/stage/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt/mvapich2-2.3.tar.gz'\r\n==> [2019-02-21-20:00:43.405720] Created stage in /apps/spack/var/spack/stage/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt\r\n==> [2019-02-21-20:00:43.406692] No patches needed for mvapich2\r\n==> [2019-02-21-20:00:43.406824] Building mvapich2 [AutotoolsPackage]\r\n==> [2019-02-21-20:00:43.407118] WRITE LOCK: /apps/spack/var/spack/stage/.lock[6847860753799464130:1] [Acquiring]\r\n==> [2019-02-21-20:00:43.407521] WRITE LOCK: /apps/spack/var/spack/stage/.lock[6847860753799464130:1] [Acquired]\r\n==> [2019-02-21-20:00:43.408205] WRITE LOCK: /apps/spack/opt/spack/.spack-db/prefix_lock[2974365570231540283:1] [Acquiring]\r\n==> [2019-02-21-20:00:43.408428] WRITE LOCK: /apps/spack/opt/spack/.spack-db/prefix_lock[2974365570231540283:1] [Acquired]\r\n==> [2019-02-21-20:00:43.413118] Executing phase: 'autoreconf'\r\n==> [2019-02-21-20:00:43.419966] Executing phase: 'configure'\r\n==> [2019-02-21-20:02:01.617879] WRITE LOCK: /apps/spack/opt/spack/.spack-db/prefix_lock[2974365570231540283:1] [Released]\r\n==> [2019-02-21-20:02:01.619183] WRITE LOCK: /apps/spack/var/spack/stage/.lock[6847860753799464130:1] [Released]\r\n==> [2019-02-21-20:02:01.630982] Error: ProcessError: Command exited with status 1:\r\n    '/apps/spack/var/spack/stage/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt/mvapich2-2.3/configure' '--prefix=/apps/spack/opt/spack/linux-centos7-x86_64/gcc-6.4.0/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt' '--enable-shared' '--enable-romio' '--disable-silent-rules' '--disable-new-dtags' '--enable-fortran=all' '--enable-threads=multiple' '--with-ch3-rank-bits=32' '--disable-alloca' '--enable-fast=all' '--enable-cuda' '--with-cuda=/apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/cuda-10.0.130-kqvlz4iqfrzow5vznahf4cted6fpxm3w' '--enable-registration-cache' '--with-device=ch3:psm' '--with-psm=/apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/psm-3.3-3n4557pruwwynqxsqexewb6qw6bsgex3'\r\n\r\n3 errors found in build log:\r\n     935    checking whether make supports nested variables... yes\r\n     936    checking whether to enable maintainer-specific portions of Makefiles... yes\r\n     937    checking for style of include used by make... GNU\r\n     938    checking whether the C compiler works... yes\r\n     939    checking for C compiler default output file name... a.out\r\n     940    checking for suffix of executables...\r\n  >> 941    checking whether we are cross compiling... configure: error: in `/tmp/root/spack-stage/spack-stage-d6z5R6/mvapich2-2.3/src/mpi/romio':\r\n  >> 942    configure: error: cannot run C compiled programs.\r\n     943    If you meant to cross compile, use `--host'.\r\n     944    See `config.log' for more details\r\n  >> 945    configure: error: src/mpi/romio configure failed\r\n\r\nSee build log for details:\r\n  /apps/spack/var/spack/stage/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt/mvapich2-2.3/spack-build.out\r\nTraceback (most recent call last):\r\n  File \"/apps/spack/lib/spack/spack/build_environment.py\", line 761, in child_process\r\n    return_value = function()\r\n  File \"/apps/spack/lib/spack/spack/package.py\", line 1497, in build_process\r\n    phase(self.spec, self.prefix)\r\n  File \"/apps/spack/lib/spack/spack/package.py\", line 101, in phase_wrapper\r\n    phase(spec, prefix)\r\n  File \"/apps/spack/lib/spack/spack/build_systems/autotools.py\", line 256, in configure\r\n    inspect.getmodule(self).configure(*options)\r\n  File \"/apps/spack/lib/spack/spack/util/executable.py\", line 188, in __call__\r\n    proc.returncode, long_msg)\r\nProcessError: Command exited with status 1:\r\n    '/apps/spack/var/spack/stage/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt/mvapich2-2.3/configure' '--prefix=/apps/spack/opt/spack/linux-centos7-x86_64/gcc-6.4.0/mvapich2-2.3-kkhcg5c3tm2honmvg3kd7cp6i6hlixtt' '--enable-shared' '--enable-romio' '--disable-silent-rules' '--disable-new-dtags' '--enable-fortran=all' '--enable-threads=multiple' '--with-ch3-rank-bits=32' '--disable-alloca' '--enable-fast=all' '--enable-cuda' '--with-cuda=/apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/cuda-10.0.130-kqvlz4iqfrzow5vznahf4cted6fpxm3w' '--enable-registration-cache' '--with-device=ch3:psm' '--with-psm=/apps/spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/psm-3.3-3n4557pruwwynqxsqexewb6qw6bsgex3'\r\n```",
    "performed_via_github_app": null
}