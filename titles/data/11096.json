{
    "url": "https://api.github.com/repos/spack/spack/issues/11096",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/11096/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/11096/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/11096/events",
    "html_url": "https://github.com/spack/spack/pull/11096",
    "id": 428496519,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MjY2ODQ3MzQ1",
    "number": 11096,
    "title": "Add v 4.0.1, fix compatibility problem",
    "user": {
        "login": "floquet",
        "id": 13126143,
        "node_id": "MDQ6VXNlcjEzMTI2MTQz",
        "avatar_url": "https://avatars.githubusercontent.com/u/13126143?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/floquet",
        "html_url": "https://github.com/floquet",
        "followers_url": "https://api.github.com/users/floquet/followers",
        "following_url": "https://api.github.com/users/floquet/following{/other_user}",
        "gists_url": "https://api.github.com/users/floquet/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/floquet/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/floquet/subscriptions",
        "organizations_url": "https://api.github.com/users/floquet/orgs",
        "repos_url": "https://api.github.com/users/floquet/repos",
        "events_url": "https://api.github.com/users/floquet/events{/privacy}",
        "received_events_url": "https://api.github.com/users/floquet/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 459210887,
            "node_id": "MDU6TGFiZWw0NTkyMTA4ODc=",
            "url": "https://api.github.com/repos/spack/spack/labels/mpi",
            "name": "mpi",
            "color": "006b75",
            "default": false,
            "description": null
        },
        {
            "id": 446616788,
            "node_id": "MDU6TGFiZWw0NDY2MTY3ODg=",
            "url": "https://api.github.com/repos/spack/spack/labels/new-version",
            "name": "new-version",
            "color": "0e8a16",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2019-04-02T23:51:51Z",
    "updated_at": "2019-04-08T03:23:38Z",
    "closed_at": "2019-04-07T14:26:56Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "pull_request": {
        "url": "https://api.github.com/repos/spack/spack/pulls/11096",
        "html_url": "https://github.com/spack/spack/pull/11096",
        "diff_url": "https://github.com/spack/spack/pull/11096.diff",
        "patch_url": "https://github.com/spack/spack/pull/11096.patch"
    },
    "body": "2019-04-02\r\n\r\n# Backwards compatibility\r\n@davydden\r\nturn on the deprecated functions by default - see https://github.com/open-mpi/ompi/issues/6114#issuecomment-446279495\r\n```\r\n    def configure_args(self):\r\n    ...\r\n        if spec.satisfies('@4.0:'):\r\n            config_args.append('--enable-mpi1-compatibility')\r\n```\r\n\r\n# Maintain preferred version 3.1.3\r\n\r\n@davydden:\r\n```\r\nNetlib-scalapack-2.0.2 does not like the new version, which is not a surprise as it was released in 2012.\r\nBut the problem is that it's a default provider for ScaLAPACK. Keep 3.1.3 as preferred.\r\n```\r\n# open-mpi.org\r\ndownload:   https://www.open-mpi.org/software/ompi/v4.0/\r\nchange log: https://raw.githubusercontent.com/open-mpi/ompi/v4.0.x/NEWS\r\n\r\n4.0.1 -- 26 March, 2019\r\n--------------------\r\n- Update embedded PMIx to 3.1.2.\r\n- Fix an issue with Vader (shared-memory) transport on OS-X. Thanks\r\n  to Daniel Vollmer for reporting.\r\n- Fix a problem with the usNIC BTL Makefile.  Thanks to George Marselis\r\n  for reporting.\r\n- Fix an issue when using --enable-visibility configure option\r\n  and older versions of hwloc.  Thanks to Ben Menadue for reporting\r\n  and providing a fix.\r\n- Fix an issue with MPI_WIN_CREATE_DYNAMIC and MPI_GET from self.\r\n  thanks to Bart Janssens for reporting.\r\n- Fix an issue of excessive compiler warning messages from mpi.h\r\n  when using newer C++ compilers.  Thanks to @Shadow-fax for\r\n  reporting.\r\n- Fix a problem when building Open MPI using clang 5.0.\r\n- Fix a problem with MPI_WIN_CREATE when using UCX.  Thanks\r\n  to Adam Simpson for reporting.\r\n- Fix a memory leak encountered for certain MPI datatype\r\n  destructor operations.  Thanks to Axel Huebl for reporting.\r\n- Fix several problems with MPI RMA accumulate operations.\r\n  Thanks to Jeff Hammond for reporting.\r\n- Fix possible race condition in closing some file descriptors\r\n  during job launch using mpirun.  Thanks to Jason Williams\r\n  for reporting and providing a fix.\r\n- Fix a problem in OMPIO for large individual write operations.\r\n  Thanks to Axel Huebl for reporting.\r\n- Fix a problem with parsing of map-by ppr options to mpirun.\r\n  Thanks to David Rich for reporting.\r\n- Fix a problem observed when using the mpool hugepage component.  Thanks\r\n  to Hunter Easterday for reporting and fixing.\r\n- Fix valgrind warning generated when invoking certain MPI Fortran\r\n  data type creation functions.  Thanks to @rtoijala for reporting.\r\n- Fix a problem when trying to build with a PMIX 3.1 or newer\r\n  release.  Thanks to Alastair McKinstry for reporting.\r\n- Fix a problem encountered with building MPI F08 module files.\r\n  Thanks to Igor Andriyash and Axel Huebl for reporting.\r\n- Fix two memory leaks encountered for certain MPI-RMA usage patterns.\r\n  Thanks to Joseph Schuchart for reporting and fixing.\r\n- Fix a problem with the ORTE rmaps_base_oversubscribe MCA paramater.\r\n  Thanks to @iassiour for reporting.\r\n- Fix a problem with UCX PML default error handler for MPI communicators.\r\n  Thanks to Marcin Krotkiewski for reporting.\r\n- Fix various issues with OMPIO uncovered by the testmpio test suite.\r\n\r\n\r\n# Verification\r\n\r\n## Verification builds (LANL Darwin)\r\n\r\n```\r\n$ spack install openmpi @ 4.0.1 % gcc @ 4.8.5 arch=linux-centos7-x86_64\r\n[+] /scratch/users/dantopa/new-spack/pr-openmpi-4.0.1.spack/opt/spack/linux-centos7-x86_64/gcc-4.8.5/openmpi-4.0.1-rldccbaweier2wesl7x4fmj7qqpfsojp\r\n```\r\n\r\n```\r\n$ spack install openmpi @ 4.0.1 % gcc @ 4.8.5 arch=linux-rhel7-aarch64\r\n[+] /scratch/users/dantopa/new-spack/libraries/darwin-arm.libhio/opt/spack/linux-rhel7-aarch64/gcc-4.8.5/openmpi-4.0.1-hto7x2hrsz6rtcod4vnjvmdyhcmbpikt\r\n```\r\n\r\n```\r\n$ spack install openmpi @ 4.0.1 % gcc @ 4.8.5 arch=linux-rhel7-ppc64le\r\n[+] /scratch/users/dantopa/new-spack/pr-openmpi-4.0.1.spack/opt/spack/linux-rhel7-ppc64le/gcc-4.8.5/openmpi-4.0.1-tkze2gfc7cpy4qye5tu4qvuq6vx6uopj\r\n```\r\n## Dependencies\r\n```\r\ndantopa@cn2023:pr-openmpi-4.0.1.spack $ date\r\nTue Apr  2 16:33:10 MDT 2019\r\n\r\ndantopa@cn2023:pr-openmpi-4.0.1.spack $ pwd\r\n/scratch/users/dantopa/new-spack/pr-openmpi-4.0.1.spack\r\n\r\ndantopa@cn2023:pr-openmpi-4.0.1.spack $ spack find -ldf openmpi@4.0.1\r\n==> 3 installed packages\r\n-- linux-centos7-x86_64 / gcc@4.8.5 -----------------------------\r\nrldccba    openmpi@4.0.1%gcc\r\nbkkhvej        ^hwloc@1.11.11%gcc\r\n5chyfxo            ^libpciaccess@0.13.5%gcc\r\nbcnjbc3            ^libxml2@2.9.8%gcc\r\ntt2hkol            ^numactl@2.0.12%gcc\r\n64vg6e4        ^zlib@1.2.11%gcc\r\n\r\n\r\n-- linux-rhel7-aarch64 / gcc@4.8.5 ------------------------------\r\nhto7x2h    openmpi@4.0.1%gcc\r\n7gqvelc        ^hwloc@1.11.11%gcc\r\n6a4he35            ^libpciaccess@0.13.5%gcc\r\n6a5uzd6            ^libxml2@2.9.8%gcc\r\nm5neuus            ^numactl@2.0.12%gcc\r\n67s2oqn        ^zlib@1.2.11%gcc\r\n\r\n\r\n-- linux-rhel7-ppc64le / gcc@4.8.5 ------------------------------\r\ntkze2gf    openmpi@4.0.1%gcc\r\nr6cylpu        ^hwloc@1.11.11%gcc\r\nuzm3xdv            ^libpciaccess@0.13.5%gcc\r\ntrik6hj            ^libxml2@2.9.8%gcc\r\npmgndwh            ^numactl@2.0.12%gcc\r\n4v3ticy        ^zlib@1.2.11%gcc\r\n```\r\n## Hardware specification\r\n\r\n`sinfo -h -N -o %n/%f/%z/%m/%R`\r\n\r\n<table>\r\n   <tr>\r\n    <td> </td>\r\n    <td>general</td>\r\n    <td>ARM</td>\r\n    <td>Power9</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Node</td>\r\n    <td>cn138</td>\r\n    <td>cn821</td>\r\n    <td>cn2032</td>\r\n  </tr>\r\n  <tr>\r\n    <td>RAM</td>\r\n    <td>125 GB</td>\r\n    <td>255 GB </td>\r\n    <td>318 GB</td>\r\n  </tr>\r\n  <tr>\r\n    <td>CPU Vendor</td>\r\n    <td>intel</td>\r\n    <td>cavium </td>\r\n    <td>ibm</td>\r\n  </tr>\r\n  <tr>\r\n    <td>CPU Family</td>\r\n    <td>haswell</td>\r\n    <td>arm</td>\r\n    <td>ppc</td>\r\n  </tr>\r\n  <tr>\r\n    <td>CPU Model</td>\r\n    <td>E5-2660_v3</td>\r\n    <td>ThunderX2-B0</td>\r\n    <td>Power9</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Base Clock</td>\r\n    <td>2.60 GHz</td>\r\n    <td>2.2 GHz </td>\r\n    <td>3.8 GHz</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Sockets</td>\r\n    <td>2</td>\r\n    <td>2</td>\r\n    <td>2</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Cores/socket</td>\r\n    <td>10</td>\r\n    <td>32</td>\r\n    <td>20</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Total cores</td>\r\n    <td>20</td>\r\n    <td>64</td>\r\n    <td>40</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Threads/core</td>\r\n    <td>2</td>\r\n    <td>4</td>\r\n    <td>4</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Total threads</td>\r\n    <td>20</td>\r\n    <td>256</td>\r\n    <td>160</td>\r\n  </tr>\r\n  <tr>\r\n    <td>HW Multithreading</td>\r\n    <td>yes</td>\r\n    <td>yes</td>\r\n    <td>yes</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Infiniband</td>\r\n    <td>fdr</td>\r\n    <td>edr</td>\r\n    <td>edr</td>\r\n  </tr>\r\n  <tr>\r\n    <td>NUMA Domains</td>\r\n    <td>2</td>\r\n    <td>2</td>\r\n    <td>6</td>\r\n  </tr>\r\n  <tr>\r\n    <td>Ethernet</td>\r\n    <td>10 Gb</td>\r\n    <td>1 Gb</td>\r\n    <td>1 Gb</td>\r\n  </tr>\r\n  <tr>\r\n    <td>GPU Count</td>\r\n    <td>1</td>\r\n    <td>0</td>\r\n    <td>4</td>\r\n  </tr>\r\n  <tr>\r\n    <td>GPU Vendor</td>\r\n    <td>nvidia</td>\r\n    <td>-</td>\r\n    <td>nvidia</td>\r\n  </tr>\r\n  <tr>\r\n    <td>GPU Model</td>\r\n    <td>Tesla_K40m</td>\r\n    <td>-</td>\r\n    <td>Tesla_V100-SXM2-16GB</td>\r\n  </tr>\r\n  <tr>\r\n    <td>SSD</td>\r\n    <td>yes</td>\r\n    <td>yes</td>\r\n    <td>no</td>\r\n  </tr>\r\n\r\nSigned-off-by: Daniel Topa <dantopa@lanl.gov>",
    "performed_via_github_app": null
}