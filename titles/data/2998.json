{
    "url": "https://api.github.com/repos/spack/spack/issues/2998",
    "repository_url": "https://api.github.com/repos/spack/spack",
    "labels_url": "https://api.github.com/repos/spack/spack/issues/2998/labels{/name}",
    "comments_url": "https://api.github.com/repos/spack/spack/issues/2998/comments",
    "events_url": "https://api.github.com/repos/spack/spack/issues/2998/events",
    "html_url": "https://github.com/spack/spack/issues/2998",
    "id": 204742258,
    "node_id": "MDU6SXNzdWUyMDQ3NDIyNTg=",
    "number": 2998,
    "title": "Can't install r-devtools, someone needs python but doesn't depends_on() it.",
    "user": {
        "login": "hartzell",
        "id": 312978,
        "node_id": "MDQ6VXNlcjMxMjk3OA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/312978?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hartzell",
        "html_url": "https://github.com/hartzell",
        "followers_url": "https://api.github.com/users/hartzell/followers",
        "following_url": "https://api.github.com/users/hartzell/following{/other_user}",
        "gists_url": "https://api.github.com/users/hartzell/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/hartzell/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hartzell/subscriptions",
        "organizations_url": "https://api.github.com/users/hartzell/orgs",
        "repos_url": "https://api.github.com/users/hartzell/repos",
        "events_url": "https://api.github.com/users/hartzell/events{/privacy}",
        "received_events_url": "https://api.github.com/users/hartzell/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 16,
    "created_at": "2017-02-01T23:54:39Z",
    "updated_at": "2017-02-03T00:01:07Z",
    "closed_at": "2017-02-03T00:01:07Z",
    "author_association": "CONTRIBUTOR",
    "active_lock_reason": null,
    "body": "\r\nI'm seeing a failure when I try to install `r-devtools`.  I can paper over it by adding a `depends_on('python')` to r-withr, but I think I'm just hiding the actual problem.\r\n\r\nHere's the error I see.\r\n\r\n```\r\n[hartzelg@rpbuchop001 spack-20170131]$ spack install r-devtools@1.11.1^r+X ^pango+X ^zlib@1.2.8\r\n==> Installing r-devtools\r\n==> Installing r-withr\r\n==> r is already installed in /isilon/Analysis/scratch/hartzelg/spack/spack-20170131/opt/spack/linux-centos7-x86_64/gcc-5.4.0/r-3.3.2-3torgnnwmt4cgvudum7a5voqfahrrfx5\r\n==> Error: RuntimeError: Cannot locate python executable\r\n/isilon/Analysis/scratch/hartzelg/spack/spack-20170131/var/spack/repos/builtin/packages/python/package.py:358, in setup_dependent_environment:\r\n     338      def setup_dependent_environment(self, spack_env, run_env, extension_spec):\r\n     339          \"\"\"Set PYTHONPATH to include site-packages dir for the\r\n     340          extension and any other python extensions it depends on.\"\"\"\r\n     341          # The python executable for version 3 may be python3 or python\r\n     342          # See https://github.com/LLNL/spack/pull/2173#issuecomment-257170199\r\n     343          pythonex = 'python{0}'.format('3' if self.spec.satisfies('@3') else '')\r\n     344          if os.path.isdir(self.prefix.bin):\r\n     345              base = self.prefix.bin\r\n     346          else:\r\n     347              base = self.prefix\r\n     348          if not os.path.isfile(os.path.join(base, pythonex)):\r\n     349              if self.spec.satisfies('@3'):\r\n     350                  python = Executable(os.path.join(base, 'python'))\r\n     351                  version = python('-c', 'import sys; print(sys.version)',\r\n     352                                   output=str)\r\n     353                  if version.startswith('3'):\r\n     354                      pythonex = 'python'\r\n     355                  else:\r\n     356                      raise RuntimeError('Cannot locate python executable')\r\n     357              else:\r\n  >> 358                  raise RuntimeError('Cannot locate python executable')\r\n     359          python = Executable(os.path.join(base, pythonex))\r\n     360          prefix = python('-c', 'import sys; print(sys.prefix)', output=str)\r\n     361          spack_env.set('PYTHONHOME', prefix.strip('\\n'))\r\n     362\r\n     363          python_paths = []\r\n     364          for d in extension_spec.traverse(\r\n     365                  deptype=('build', 'run'), deptype_query='run'):\r\n```\r\n\r\nWhen I run `spack install -v r-devtools@1.11.1^r+X ^pango+X ^zlib@1.2.8` I get this concretized spec.  The only reference I see to python comes from `libxcb`, for which python is a build dependency.\r\n\r\n```\r\n--------------------------------                                                                                                                                                 [4/1852]\r\nr-devtools@1.11.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n    ^r@3.3.2%gcc@5.4.0+X~external-lapack arch=linux-centos7-x86_64\r\n        ^bzip2@1.0.6%gcc@5.4.0+shared arch=linux-centos7-x86_64\r\n        ^cairo@1.14.8%gcc@5.4.0+X arch=linux-centos7-x86_64\r\n            ^fontconfig@2.11.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^font-util@1.3.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^pkg-config@0.29.1%gcc@5.4.0+internal_glib arch=linux-centos7-x86_64\r\n                    ^util-macros@1.19.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^freetype@2.7%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^libpng@1.6.27%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                        ^zlib@1.2.8%gcc@5.4.0+pic+shared arch=linux-centos7-x86_64\r\n                ^libxml2@2.9.4%gcc@5.4.0~python arch=linux-centos7-x86_64\r\n                    ^xz@5.2.3%gcc@5.4.0 arch=linux-centos7-x86_64\r\n            ^glib@2.49.4%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^autoconf@2.69%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^m4@1.4.18%gcc@5.4.0+sigsegv arch=linux-centos7-x86_64\r\n                        ^libsigsegv@2.10%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^automake@1.15%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^gettext@0.19.8.1%gcc@5.4.0+bzip2+curses+git~libunistring+libxml2+tar+xz arch=linux-centos7-x86_64\r\n                    ^ncurses@6.0%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^tar@1.29%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^libffi@3.2.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^libtool@2.4.6%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^pcre@8.39%gcc@5.4.0+utf arch=linux-centos7-x86_64\r\n            ^libx11@1.6.3%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^inputproto@2.3.2%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^kbproto@1.0.7%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^libxcb@1.12%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^libpthread-stubs@0.3%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^libxau@1.0.8%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                        ^xproto@7.0.29%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^libxdmcp@1.1.2%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^python@2.7.13%gcc@5.4.0~tk~ucs4 arch=linux-centos7-x86_64\r\n                        ^openssl@1.1.0d%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                            ^perl@5.24.0%gcc@5.4.0+cpanm arch=linux-centos7-x86_64\r\n                        ^readline@6.3%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                        ^sqlite@3.8.5%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                    ^xcb-proto@1.12%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^xextproto@7.3.0%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^xtrans@1.3.5%gcc@5.4.0 arch=linux-centos7-x86_64\r\n            ^libxext@1.3.3%gcc@5.4.0 arch=linux-centos7-x86_64\r\n            ^libxrender@0.9.9%gcc@5.4.0 arch=linux-centos7-x86_64\r\n                ^renderproto@0.11.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n            ^pixman@0.34.0%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^curl@7.52.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^icu4c@57.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^jdk@8u92-linux-x64%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^jpeg@9b%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^libtiff@4.0.6%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^libxt@1.1.5%gcc@5.4.0 arch=linux-centos7-x86_64\r\n            ^libice@1.0.9%gcc@5.4.0 arch=linux-centos7-x86_64\r\n            ^libsm@1.2.2%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^pango@1.40.3%gcc@5.4.0+X arch=linux-centos7-x86_64\r\n            ^harfbuzz@0.9.37%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^tcl@8.6.5%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^tk@8.6.5%gcc@5.4.0+X arch=linux-centos7-x86_64\r\n    ^r-digest@0.6.12%gcc@5.4.0 arch=linux-centos7-x86_64\r\n    ^r-git2r@0.18.0%gcc@5.4.0 arch=linux-centos7-x86_64\r\n    ^r-httr@1.2.1%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^r-curl@2.3%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^r-jsonlite@1.2%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^r-mime@0.5%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^r-openssl@0.9.6%gcc@5.4.0 arch=linux-centos7-x86_64\r\n        ^r-r6@2.2.0%gcc@5.4.0 arch=linux-centos7-x86_64\r\n    ^r-memoise@1.0.0%gcc@5.4.0 arch=linux-centos7-x86_64\r\n    ^r-rstudioapi@0.6%gcc@5.4.0 arch=linux-centos7-x86_64\r\n    ^r-whisker@0.3-2%gcc@5.4.0 arch=linux-centos7-x86_64\r\n    ^r-withr@1.0.2%gcc@5.4.0 arch=linux-centos7-x86_64\r\n```\r\n\r\nI'd appreciate any hints about how to run this down a bit further.",
    "performed_via_github_app": null
}